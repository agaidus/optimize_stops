
## Introduction

### Traveling Salesman Problem
The traveling salesman problem is a classic optimization problem that seeks to find the most efficient route that connects a given set of points. I recently discovered a set of services built by the open-source mapping company, Mapzen, that make this complex problem easy to approximate for relatively small numbers of stops. Given a set of coordinates, the Mapzen [optimize route](https://mapzen.com/documentation/mobility/optimized/api-reference/) service uses road network data to produce a time-distance matrix betweent these points, and then calculates the route that minimizes the total travel time. This can be done for one of three modes of transportaion - pedestrian, bicycle, and car. They have a great [example](https://mapzen.com/blog/optimized-route/) with a cool map where they determine the optimal route to visit burrito 'dispensaries' in San Franscico.

I use this root optimization tool in conjunction Mapzen's [Search](https://mapzen.com/documentation/search/) Service, which uses open source data to geocode addresses, landmarks, and businesses. Using these two services together is really handy, because it allows the user to specify locations without knowing their lat / long coordinates.

### Extension to the TSP
The Mapzen optimize route service takes a set of points and finds the optimal route that a person should take to visit all of these points. However, what if we have multiple "salesmen"? How should the stops be split up between people and in what order should each person visit their stops?

The idea for this was spurred by a project I'm involved with at work, in which we are sending out multiple research assistants to conduct surveys at a dozen or so different sites in Oakland. In this case, it doesn't matter if one person conducts more surveys than other or who goes to which site - the goal is just to minimize the total time to get them all done. 

Perhaps a more interesting and relevant application (for me!), is the optimization of Sunday morning errands between my girlfriend, Celeste, and I. Say we're both starting and ending at our apartment in the Inner Richmond, SF and have 6 different places that we need to stop at. How should Celeste and I split up these errands so that we're done as quickly as possible? 

In the post below, I write a set of functions in Python that wrap these two Mapzen services to help me answer these questions. Additionally, I will use the Python package ```folium``` to create leaflet.js slippy maps to display the results of this optimzation problem. Folium has a number of built-in tilesets from OpenStreetMap, MapQuest, MapBox, and makes it really easy to build web maps in Python. Let's get started!


```python
import requests
import pandas as pd
import itertools
import shapely
from shapely.geometry import Point
import geopandas as gpd
import json
import numpy as np
import folium
from numpy.random import RandomState, uniform
import time
import sys

%matplotlib inline
search_key = 'search-WWoh7Na'
matrix_key = 'matrix-gjM8nT3'
```

## Geocoding Locations with Mapzen's Search Tool
I first write a function that wraps Mapzen's Search tool in order to geocode (obtain the lat / long coordinates for) an address, landmark, or business. The function returns a dictionary containg the raw result output from Mapzen (includes stuff such as data source, geocoding confidence, neighborhood data, etc), as well as the crucial piece of information for me - a formatted set of xy coordinates. By default I return only 1 result (the top result), but if I were to use this tool for a different context, I would perhaps be interested in returning a set of results. Below I use this function to geocode two famous San Francisco landmarks - the Transamerica Pyramid and Sutro Tower.


```python
def geocode_address_venue(text, key = search_key,params = None): #allow for additional Mapzen search parameters
    search_parameters = {'api_key': key,'text': text,'size': 1,'layers': 'address,venue'}
    if params:
        search_parameters.update(params)
    url = 'http://search.mapzen.com/v1/search'
    r = requests.get(url, params = search_parameters)
    data = r.json()
    return {'raw': data,'coords': tuple(data['features'][0]['geometry']['coordinates'])}
```


```python
transamerica = geocode_address_venue('Transamerica Pyramid, San Francisco, CA')['coords']
sutro = geocode_address_venue('Sutro Tower, San Francisco, CA')['coords']
print transamerica
print sutro
```

    (-122.40303, 37.79465)
    (-122.45285, 37.755246)
    

## Displaying Points on Leaflet Maps
Now let's put these points on a map. I write a plotting function below that takes a list of coordinates and displays them on a Leaflet map. By default I use the Stamen Watercolor tiles because I think they look really cool, but if something like OpenStreetMap is more useful, that can also be specfied. The full set of available tile layers can be found [here](https://github.com/python-visualization/folium). The function also takes an optional set of colors and point labels, a zoom-level, and a center location. My function calculates default values if not specified. 

The function is written in a way that it accepts either a list of point coordinates, or a list of lists of point coordinates. If the latter is specified, each sublist is treated as a group of coordinates and will be symbolized in the same color. The function was ultimately written this way to make it easy to distinguish locations that each "salesman" will visit in the optimization problem coming later. Additionally, I allow for the specification of polyline coordinates, which will ultimately be used to plot an optimized route between the points.

Below I map my two previously geocoded San Francisco landmarks along with the straight line that connects them, on Stamen Toner tiles. Note that on the 'live' map if you click on the points you will see that they are labeled appropriately.


```python
def plot_stops(point_coords, zoom_level = 15,tiles = 'Stamen Watercolor', point_colors = None, 
               labels = None, center_location = None, line_coords = None, line_colors = None):
   
    #if not a list of lists, make it one, which then allows the function to handle either
    point_coords = [[x] for x in point_coords] if all([type(x) is not list for x in point_coords]) else point_coords
    if labels:
        labels = [[x] for x in labels] if all([type(x) is not list for x in labels]) else labels
    if line_coords:
        line_coords = [line_coords] if all([type(t) is tuple for t in line_coords]) else line_coords
    
    if line_colors:
        line_colors = [line_colors] if type(line_colors) is not list else line_colors

    #get all points as the flattened list to calculate the center
    all_points = [item for sublist in point_coords for item in sublist]
    #calculate start location as the mean x and mean y of all input points
    if center_location:
        center_location = [center_location[1],center_location[0]]
    else:
        center_location = np.array(all_points).mean(0).tolist()[::-1]
    
    #create a leaflet map, specifying center location, zoom level, and tiles
    map_1 = folium.Map(location = center_location,zoom_start = zoom_level,tiles = tiles)
    
    #specify a set of default colors
    color_options = ['black', 'blue', 'red', 'green', 'purple', 'orange', 'pink', 'white']
    
    #if no point colors specified use the default
    point_colors = point_colors if point_colors else color_options[:len(point_coords)]
    
    #if plotting lines as well, get line colors, otherwise use default
    if line_coords:
        line_colors = line_colors if line_colors else color_options[1:][:len(line_coords)]

    #loop through each point or grouping of points
    for c, point_coords in enumerate(point_coords):
        point_color = point_colors[c] #get color from color list

        if labels: sublabel_list = labels[c] #get labels from label list
        for i, stop_coord in enumerate(point_coords): 
            label = sublabel_list[i] if labels else None
            #Add point to map at specified coordinate 
            folium.Marker([stop_coord[1], stop_coord[0]], popup = label, #need to reverse long/lat to lat/long
                           icon = folium.Icon(color = point_color)).add_to(map_1)
    
    #if plotting lines, loop through each set of lines and plot
    if line_coords:
        for i, pline in enumerate(line_coords):
            line_color = line_colors[i]
            folium.PolyLine([(y,x) for (x,y) in pline], color = line_color).add_to(map_1) #need to reverse long/lat to lat/long
    return map_1
```


```python
sf_landmarks = plot_stops([transamerica, sutro], labels = ['Transamerica Pyramid','Sutro Tower'], 
            zoom_level = 13, tiles = 'Stamen Toner', point_colors = ['red','blue'],
            line_coords = [transamerica, sutro], line_colors = 'purple')
sf_landmarks
```




<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe src="data:text/html;base64,CiAgICAgICAgPCFET0NUWVBFIGh0bWw+CiAgICAgICAgPGhlYWQ+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCIgLz4KICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0LzAuNy4zL2xlYWZsZXQuanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMS9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9qcy9ib290c3RyYXAubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5taW4uanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xlYWZsZXQubWFya2VyY2x1c3Rlci8wLjQuMC9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXItc3JjLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvbGVhZmxldC5tYXJrZXJjbHVzdGVyLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC8wLjcuMy9sZWFmbGV0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMS4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvTWFya2VyQ2x1c3Rlci5EZWZhdWx0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC5tYXJrZXJjbHVzdGVyLzAuNC4wL01hcmtlckNsdXN0ZXIuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPgoKICAgICAgICAgICAgaHRtbCwgYm9keSB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjbWFwIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOjA7CiAgICAgICAgICAgICAgICBib3R0b206MDsKICAgICAgICAgICAgICAgIHJpZ2h0OjA7CiAgICAgICAgICAgICAgICBsZWZ0OjA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvc3R5bGU+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPiAjbWFwX2I5ZjY0OGFlODMxMzRhODFiNzM2Yjk4MzE0YzRiMzMxIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uIDogcmVsYXRpdmU7CiAgICAgICAgICAgICAgICB3aWR0aCA6IDEwMC4wJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwLjAlOwogICAgICAgICAgICAgICAgbGVmdDogMC4wJTsKICAgICAgICAgICAgICAgIHRvcDogMC4wJTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L2hlYWQ+CiAgICAgICAgPGJvZHk+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF9iOWY2NDhhZTgzMTM0YTgxYjczNmI5ODMxNGM0YjMzMSIgPjwvZGl2PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvYm9keT4KICAgICAgICA8c2NyaXB0PgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgc291dGhXZXN0ID0gTC5sYXRMbmcoLTkwLCAtMTgwKTsKICAgICAgICAgICAgdmFyIG5vcnRoRWFzdCA9IEwubGF0TG5nKDkwLCAxODApOwogICAgICAgICAgICB2YXIgYm91bmRzID0gTC5sYXRMbmdCb3VuZHMoc291dGhXZXN0LCBub3J0aEVhc3QpOwoKICAgICAgICAgICAgdmFyIG1hcF9iOWY2NDhhZTgzMTM0YTgxYjczNmI5ODMxNGM0YjMzMSA9IEwubWFwKCdtYXBfYjlmNjQ4YWU4MzEzNGE4MWI3MzZiOTgzMTRjNGIzMzEnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6WzM3Ljc3NDk0OCwtMTIyLjQyNzk0XSwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHpvb206IDEzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbWF4Qm91bmRzOiBib3VuZHMsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBsYXllcnM6IFtdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY3JzOiBMLkNSUy5FUFNHMzg1NwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciB0aWxlX2xheWVyXzQ5NWVkODQ4MWMxMzQzZDdhMzFmMjM0ZWQ5ZGZjMjQxID0gTC50aWxlTGF5ZXIoCiAgICAgICAgICAgICAgICAnaHR0cHM6Ly9zdGFtZW4tdGlsZXMte3N9LmEuc3NsLmZhc3RseS5uZXQvdG9uZXIve3p9L3t4fS97eX0ucG5nJywKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBtYXhab29tOiAxOCwKICAgICAgICAgICAgICAgICAgICBtaW5ab29tOiAxLAogICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0aW9uOiAnTWFwIHRpbGVzIGJ5IDxhIGhyZWY9Imh0dHA6Ly9zdGFtZW4uY29tIj5TdGFtZW4gRGVzaWduPC9hPiwgdW5kZXIgPGEgaHJlZj0iaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvMy4wIj5DQyBCWSAzLjA8L2E+LiBEYXRhIGJ5IDxhIGhyZWY9Imh0dHA6Ly9vcGVuc3RyZWV0bWFwLm9yZyI+T3BlblN0cmVldE1hcDwvYT4sIHVuZGVyIDxhIGhyZWY9Imh0dHA6Ly93d3cub3BlbnN0cmVldG1hcC5vcmcvY29weXJpZ2h0Ij5PRGJMPC9hPi4nLAogICAgICAgICAgICAgICAgICAgIGRldGVjdFJldGluYTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9iOWY2NDhhZTgzMTM0YTgxYjczNmI5ODMxNGM0YjMzMSk7CgogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfZmNjOTJkZDhhMzVlNDYyNjk3MWUwZDNkZGZjZWUyNWEgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43OTQ2NSwtMTIyLjQwMzAzXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfYjlmNjQ4YWU4MzEzNGE4MWI3MzZiOTgzMTRjNGIzMzEpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fNTJiNjRmYmQ1Y2E3NDdmNDg5ZDEwMDYwODRjMmMzMWUgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9mY2M5MmRkOGEzNWU0NjI2OTcxZTBkM2RkZmNlZTI1YS5zZXRJY29uKGljb25fNTJiNjRmYmQ1Y2E3NDdmNDg5ZDEwMDYwODRjMmMzMWUpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kM2IyZDZlNGEwZDM0ZmQyODk2YjliNzkzMWM2ZWRlOCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF82Mzk0Zjc2YTY0Y2E0ZDU1OWNlYTMzNmE4MzljMTVkYSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNjM5NGY3NmE2NGNhNGQ1NTljZWEzMzZhODM5YzE1ZGEiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIFRyYW5zYW1lcmljYSBQeXJhbWlkPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2QzYjJkNmU0YTBkMzRmZDI4OTZiOWI3OTMxYzZlZGU4LnNldENvbnRlbnQoaHRtbF82Mzk0Zjc2YTY0Y2E0ZDU1OWNlYTMzNmE4MzljMTVkYSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2ZjYzkyZGQ4YTM1ZTQ2MjY5NzFlMGQzZGRmY2VlMjVhLmJpbmRQb3B1cChwb3B1cF9kM2IyZDZlNGEwZDM0ZmQyODk2YjliNzkzMWM2ZWRlOCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzYzOTM1OTU3MjkwYjRmM2M5NGE1ZDg5NTAzMzE1MDllID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzU1MjQ2LC0xMjIuNDUyODVdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF9iOWY2NDhhZTgzMTM0YTgxYjczNmI5ODMxNGM0YjMzMSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8xY2M1ZTMxYjkyYWE0NGE0YWM3ZDQxYmQ5NTcwOTJmNyA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl82MzkzNTk1NzI5MGI0ZjNjOTRhNWQ4OTUwMzMxNTA5ZS5zZXRJY29uKGljb25fMWNjNWUzMWI5MmFhNDRhNGFjN2Q0MWJkOTU3MDkyZjcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mMGU2OTFlODljMDA0OGZmYmEzYjgwZWU4YWUzYjhjOCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF84YTgwNTQ5ZTgwYmY0YTc2OWEyMDFkMjA2MjUyMThmZSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfOGE4MDU0OWU4MGJmNGE3NjlhMjAxZDIwNjI1MjE4ZmUiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIFN1dHJvIFRvd2VyPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2YwZTY5MWU4OWMwMDQ4ZmZiYTNiODBlZThhZTNiOGM4LnNldENvbnRlbnQoaHRtbF84YTgwNTQ5ZTgwYmY0YTc2OWEyMDFkMjA2MjUyMThmZSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzYzOTM1OTU3MjkwYjRmM2M5NGE1ZDg5NTAzMzE1MDllLmJpbmRQb3B1cChwb3B1cF9mMGU2OTFlODljMDA0OGZmYmEzYjgwZWU4YWUzYjhjOCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgcG9seV9saW5lXzVlNmQ2YjlhYzM4NDQxNDk5ODJmZTcxMDc1NDJjNzgyID0gTC5wb2x5bGluZSgKICAgICAgICAgICAgICAgICAgICBbWzM3Ljc5NDY1LCAtMTIyLjQwMzAzXSwgWzM3Ljc1NTI0NiwgLTEyMi40NTI4NV1dLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdwdXJwbGUnLAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFwX2I5ZjY0OGFlODMxMzRhODFiNzM2Yjk4MzE0YzRiMzMxLmFkZExheWVyKHBvbHlfbGluZV81ZTZkNmI5YWMzODQ0MTQ5OTgyZmU3MTA3NTQyYzc4Mik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvc2NyaXB0PgogICAgICAgIA==" style="position:absolute;width:100%;height:100%;left:0;top:0;"></iframe></div></div>



I also demonstrate how a list of list of points can be passed to my plotting function, resulting in each set of points getting symbolized in a different color. I write a function that generates random points within a polygon, and use that to generate 6 lists of 5 points located in San Francisco (boundaries read in from a geosjon). I plot them below. Here the point are labeled by there group number (1-6) and their point number within their group (1-5).


```python
def gen_random_points(poly, n, random_seed = None):
    xmin, ymin, xmax, ymax = poly.bounds
    Points = []
    i = 0
    while len(Points) <= n:
        if random_seed:
            x, y = RandomState(random_seed + i).uniform(xmin, xmax), RandomState(random_seed + i + 1).uniform(ymin, ymax)
        else:
            x, y = uniform(xmin, xmax),uniform(ymin, ymax)
        if Point(x, y).within(poly):
            Points.append((x, y))
        i += 1
    return Points
```


```python
SF = gpd.read_file('SF.geojson').iloc[0]['geometry']
rand_points = [gen_random_points(SF, n = 5) for t in range(6)]
labels = [[str((t, i)) for i, x in enumerate(l, 1)] for t, l in enumerate(rand_points, 1)]

sf_rand_points = plot_stops(rand_points, zoom_level = 12, tiles = 'Stamen Toner', labels = labels)
sf_rand_points
```




<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe src="data:text/html;base64,CiAgICAgICAgPCFET0NUWVBFIGh0bWw+CiAgICAgICAgPGhlYWQ+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCIgLz4KICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0LzAuNy4zL2xlYWZsZXQuanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMS9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9qcy9ib290c3RyYXAubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5taW4uanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xlYWZsZXQubWFya2VyY2x1c3Rlci8wLjQuMC9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXItc3JjLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvbGVhZmxldC5tYXJrZXJjbHVzdGVyLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC8wLjcuMy9sZWFmbGV0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMS4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvTWFya2VyQ2x1c3Rlci5EZWZhdWx0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC5tYXJrZXJjbHVzdGVyLzAuNC4wL01hcmtlckNsdXN0ZXIuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPgoKICAgICAgICAgICAgaHRtbCwgYm9keSB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjbWFwIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOjA7CiAgICAgICAgICAgICAgICBib3R0b206MDsKICAgICAgICAgICAgICAgIHJpZ2h0OjA7CiAgICAgICAgICAgICAgICBsZWZ0OjA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvc3R5bGU+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPiAjbWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3IHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uIDogcmVsYXRpdmU7CiAgICAgICAgICAgICAgICB3aWR0aCA6IDEwMC4wJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwLjAlOwogICAgICAgICAgICAgICAgbGVmdDogMC4wJTsKICAgICAgICAgICAgICAgIHRvcDogMC4wJTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L2hlYWQ+CiAgICAgICAgPGJvZHk+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyIgPjwvZGl2PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvYm9keT4KICAgICAgICA8c2NyaXB0PgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgc291dGhXZXN0ID0gTC5sYXRMbmcoLTkwLCAtMTgwKTsKICAgICAgICAgICAgdmFyIG5vcnRoRWFzdCA9IEwubGF0TG5nKDkwLCAxODApOwogICAgICAgICAgICB2YXIgYm91bmRzID0gTC5sYXRMbmdCb3VuZHMoc291dGhXZXN0LCBub3J0aEVhc3QpOwoKICAgICAgICAgICAgdmFyIG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyA9IEwubWFwKCdtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6WzM3Ljc2MDQyNTI5NzEsLTEyMi40MzQ5NzYzMDVdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnM6IEwuQ1JTLkVQU0czODU3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHRpbGVfbGF5ZXJfZTBmOWJkZTU2YTliNDAzNzhlNjVjMGM4MjdkMjBhMjUgPSBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICdodHRwczovL3N0YW1lbi10aWxlcy17c30uYS5zc2wuZmFzdGx5Lm5ldC90b25lci97en0ve3h9L3t5fS5wbmcnLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIG1heFpvb206IDE4LAogICAgICAgICAgICAgICAgICAgIG1pblpvb206IDEsCiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRpb246ICdNYXAgdGlsZXMgYnkgPGEgaHJlZj0iaHR0cDovL3N0YW1lbi5jb20iPlN0YW1lbiBEZXNpZ248L2E+LCB1bmRlciA8YSBocmVmPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS8zLjAiPkNDIEJZIDMuMDwvYT4uIERhdGEgYnkgPGEgaHJlZj0iaHR0cDovL29wZW5zdHJlZXRtYXAub3JnIj5PcGVuU3RyZWV0TWFwPC9hPiwgdW5kZXIgPGEgaHJlZj0iaHR0cDovL3d3dy5vcGVuc3RyZWV0bWFwLm9yZy9jb3B5cmlnaHQiPk9EYkw8L2E+LicsCiAgICAgICAgICAgICAgICAgICAgZGV0ZWN0UmV0aW5hOiBmYWxzZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl9lOGRhZGYyN2E5Mzg0ZTQ0ODlmMjgxYzU3MDEyNzQ5MSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc5NjcwMzk0MzgsLTEyMi40MDY5NDE0MDddLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9hNTQ1NDA0M2MwZDQ0YWVmODBmMmVhZDg3YTU1N2MwZCA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmxhY2snLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfZThkYWRmMjdhOTM4NGU0NDg5ZjI4MWM1NzAxMjc0OTEuc2V0SWNvbihpY29uX2E1NDU0MDQzYzBkNDRhZWY4MGYyZWFkODdhNTU3YzBkKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZDQ4NWRlZmRiZjFlNGJmMGE4MDdmYzYzZTllNmY3ODUgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNjRkYjU1MTIxMTBiNDU2ZGI0Y2IwOTA3YTg4OTY5MzAgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzY0ZGI1NTEyMTEwYjQ1NmRiNGNiMDkwN2E4ODk2OTMwIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoMSwgMSk8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZDQ4NWRlZmRiZjFlNGJmMGE4MDdmYzYzZTllNmY3ODUuc2V0Q29udGVudChodG1sXzY0ZGI1NTEyMTEwYjQ1NmRiNGNiMDkwN2E4ODk2OTMwKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfZThkYWRmMjdhOTM4NGU0NDg5ZjI4MWM1NzAxMjc0OTEuYmluZFBvcHVwKHBvcHVwX2Q0ODVkZWZkYmYxZTRiZjBhODA3ZmM2M2U5ZTZmNzg1KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfOTlhYzc5YTlmMjBmNDkyZjg0N2IwOWViZDI5MzkwYzkgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NjE1MDk0NTc1LC0xMjIuNDE1NzM5NTg1XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fZmNhNjRhZGQ0ZmEwNGRhZWJhYTNmNTJiOTExNjJhNzggPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2JsYWNrJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzk5YWM3OWE5ZjIwZjQ5MmY4NDdiMDllYmQyOTM5MGM5LnNldEljb24oaWNvbl9mY2E2NGFkZDRmYTA0ZGFlYmFhM2Y1MmI5MTE2MmE3OCk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2RhNTQ1NjdmMzdlMTRjMTFhODMxODk5NTYyMTA1MjczID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzA5Yjg1Njg4MjNlMzRkOTBhMjA2MDZkMjVkOGFjYjk0ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF8wOWI4NTY4ODIzZTM0ZDkwYTIwNjA2ZDI1ZDhhY2I5NCIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDEsIDIpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2RhNTQ1NjdmMzdlMTRjMTFhODMxODk5NTYyMTA1MjczLnNldENvbnRlbnQoaHRtbF8wOWI4NTY4ODIzZTM0ZDkwYTIwNjA2ZDI1ZDhhY2I5NCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzk5YWM3OWE5ZjIwZjQ5MmY4NDdiMDllYmQyOTM5MGM5LmJpbmRQb3B1cChwb3B1cF9kYTU0NTY3ZjM3ZTE0YzExYTgzMTg5OTU2MjEwNTI3Myk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2I3YzM0YzUwMTUxZjQ0MGQ5N2Q0OTFlNjgxYjM1MDIwID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzI0MDI5MTM5MSwtMTIyLjQ5NDc2MjAyOV0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzYwYmNmYzA2MTYxZDQ4OGI4YmJlMGM4NzM5M2FkM2YzID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibGFjaycsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9iN2MzNGM1MDE1MWY0NDBkOTdkNDkxZTY4MWIzNTAyMC5zZXRJY29uKGljb25fNjBiY2ZjMDYxNjFkNDg4YjhiYmUwYzg3MzkzYWQzZjMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF82YzYwNDVhMzAzMDA0YzVmODViOTMyMmIwNjY2YWIzZSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF82ZDNmMjg4YTU1Y2M0YWUyOTMwNTg4MGEyYmQyOGZhNSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNmQzZjI4OGE1NWNjNGFlMjkzMDU4ODBhMmJkMjhmYTUiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICgxLCAzKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF82YzYwNDVhMzAzMDA0YzVmODViOTMyMmIwNjY2YWIzZS5zZXRDb250ZW50KGh0bWxfNmQzZjI4OGE1NWNjNGFlMjkzMDU4ODBhMmJkMjhmYTUpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9iN2MzNGM1MDE1MWY0NDBkOTdkNDkxZTY4MWIzNTAyMC5iaW5kUG9wdXAocG9wdXBfNmM2MDQ1YTMwMzAwNGM1Zjg1YjkzMjJiMDY2NmFiM2UpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl9lODIzYzYwZWE0YWI0NTllOWNmZTU3NTJkZDBiMzY0ZCA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc5NTExNTAwNzUsLTEyMi40NzAxNjQ4ODVdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8zOGZkYjFjMjEzOTM0YjUwOGE5N2MzOGQ4Y2IyNWY1ZiA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmxhY2snLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfZTgyM2M2MGVhNGFiNDU5ZTljZmU1NzUyZGQwYjM2NGQuc2V0SWNvbihpY29uXzM4ZmRiMWMyMTM5MzRiNTA4YTk3YzM4ZDhjYjI1ZjVmKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTg3YjhlZTJhMmRiNGI0ZmFjYTgwOGU1NmY3MDM1MDcgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfOGFkZjI1MDRiMmIyNDExOWEzYzVjM2NlMjFjMzhjZDIgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzhhZGYyNTA0YjJiMjQxMTlhM2M1YzNjZTIxYzM4Y2QyIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoMSwgNCk8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNTg3YjhlZTJhMmRiNGI0ZmFjYTgwOGU1NmY3MDM1MDcuc2V0Q29udGVudChodG1sXzhhZGYyNTA0YjJiMjQxMTlhM2M1YzNjZTIxYzM4Y2QyKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfZTgyM2M2MGVhNGFiNDU5ZTljZmU1NzUyZGQwYjM2NGQuYmluZFBvcHVwKHBvcHVwXzU4N2I4ZWUyYTJkYjRiNGZhY2E4MDhlNTZmNzAzNTA3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfYjM3MjgxOTZjZDhmNDAwMGExMzJjY2Y3MjA4M2RlMGYgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43MjUzNzg1Nzc0LC0xMjIuMzYxMzQyNzY4XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fYzdhNjUwNDQ3ZDAxNGJkMDhkM2I2Y2ZlNTFmZWYyZDEgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2JsYWNrJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2IzNzI4MTk2Y2Q4ZjQwMDBhMTMyY2NmNzIwODNkZTBmLnNldEljb24oaWNvbl9jN2E2NTA0NDdkMDE0YmQwOGQzYjZjZmU1MWZlZjJkMSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2Y5M2NiY2QwODgyNTRlNjVhZjRkNWM1MDZmYzE3YWJhID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzdlNGYyOWZmYWNkYTRkNTE5ZGE1ZWMwNjNkZGQzN2ViID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF83ZTRmMjlmZmFjZGE0ZDUxOWRhNWVjMDYzZGRkMzdlYiIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDEsIDUpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Y5M2NiY2QwODgyNTRlNjVhZjRkNWM1MDZmYzE3YWJhLnNldENvbnRlbnQoaHRtbF83ZTRmMjlmZmFjZGE0ZDUxOWRhNWVjMDYzZGRkMzdlYik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2IzNzI4MTk2Y2Q4ZjQwMDBhMTMyY2NmNzIwODNkZTBmLmJpbmRQb3B1cChwb3B1cF9mOTNjYmNkMDg4MjU0ZTY1YWY0ZDVjNTA2ZmMxN2FiYSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzNkNzhjMGYzODlhNDQwMThiYzEzOTMwM2M5MmE2Y2I5ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzEyNjg0NTgwMiwtMTIyLjQ1MjIxODI4NF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2YzMGU3MWEzZDNmNzRkZDM5NzZiYjJjMDA4MTFmOGYzID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibGFjaycsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8zZDc4YzBmMzg5YTQ0MDE4YmMxMzkzMDNjOTJhNmNiOS5zZXRJY29uKGljb25fZjMwZTcxYTNkM2Y3NGRkMzk3NmJiMmMwMDgxMWY4ZjMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wMDNhOTJiMWU2YzU0NmRlOTNkYzUyZDg2NjBhOGFmNCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF83OTM1Y2MwMDEyMjg0YWFjYTQ0OTNkODA0MmU2ZWM4NyA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNzkzNWNjMDAxMjI4NGFhY2E0NDkzZDgwNDJlNmVjODciICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICgxLCA2KTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8wMDNhOTJiMWU2YzU0NmRlOTNkYzUyZDg2NjBhOGFmNC5zZXRDb250ZW50KGh0bWxfNzkzNWNjMDAxMjI4NGFhY2E0NDkzZDgwNDJlNmVjODcpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl8zZDc4YzBmMzg5YTQ0MDE4YmMxMzkzMDNjOTJhNmNiOS5iaW5kUG9wdXAocG9wdXBfMDAzYTkyYjFlNmM1NDZkZTkzZGM1MmQ4NjYwYThhZjQpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl8yYTNmMjI4MzI4Y2U0NTUzYTk5ZTQ0Y2Y4NTc2NGZkNyA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjczNTYwODI2MTEsLTEyMi40NTEzNzk1MzVdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9kOTQyZDg4OTY4NzQ0YjQ3YWQyN2ZmZGQwOTBmMjYyOSA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8yYTNmMjI4MzI4Y2U0NTUzYTk5ZTQ0Y2Y4NTc2NGZkNy5zZXRJY29uKGljb25fZDk0MmQ4ODk2ODc0NGI0N2FkMjdmZmRkMDkwZjI2MjkpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9jNGMxMTBkOGEwMTg0MGRhYjYxYTQ2MzFkYWQxYjY2ZCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9hZmRjNzliMDBhNjM0NzA4OTBjODlmYjZlYzQ1NmFhMiA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfYWZkYzc5YjAwYTYzNDcwODkwYzg5ZmI2ZWM0NTZhYTIiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICgyLCAxKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9jNGMxMTBkOGEwMTg0MGRhYjYxYTQ2MzFkYWQxYjY2ZC5zZXRDb250ZW50KGh0bWxfYWZkYzc5YjAwYTYzNDcwODkwYzg5ZmI2ZWM0NTZhYTIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl8yYTNmMjI4MzI4Y2U0NTUzYTk5ZTQ0Y2Y4NTc2NGZkNy5iaW5kUG9wdXAocG9wdXBfYzRjMTEwZDhhMDE4NDBkYWI2MWE0NjMxZGFkMWI2NmQpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl83ODZkM2E0NTI5NmI0ZDFmOWQxYTVmZTUwYzc3MzFhYSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc4MTU1ODY2NDIsLTEyMi40MzIwNzcyNTRdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9kMGFjMGRjYjI1MmY0YmRjOWNmOGVhMjliZjFhNjY4ZiA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl83ODZkM2E0NTI5NmI0ZDFmOWQxYTVmZTUwYzc3MzFhYS5zZXRJY29uKGljb25fZDBhYzBkY2IyNTJmNGJkYzljZjhlYTI5YmYxYTY2OGYpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9lYjhkMmI4NTFmOTc0YWViYjE4N2Q3YzlhOTJkNGY0MSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8zZDJkMDRmMTMyZjQ0ODI5YTE1ZDUyYmQ3N2U1MGI4YiA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfM2QyZDA0ZjEzMmY0NDgyOWExNWQ1MmJkNzdlNTBiOGIiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICgyLCAyKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9lYjhkMmI4NTFmOTc0YWViYjE4N2Q3YzlhOTJkNGY0MS5zZXRDb250ZW50KGh0bWxfM2QyZDA0ZjEzMmY0NDgyOWExNWQ1MmJkNzdlNTBiOGIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl83ODZkM2E0NTI5NmI0ZDFmOWQxYTVmZTUwYzc3MzFhYS5iaW5kUG9wdXAocG9wdXBfZWI4ZDJiODUxZjk3NGFlYmIxODdkN2M5YTkyZDRmNDEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl80MWNhNTEwOWJiZWI0YmVjODdlNzIwNGE4MWNmOTRmNSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjcyMTAzNDA2MDIsLTEyMi40MDAxMTU5MV0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzA0OTVhMzhlZTY3MjRhMDQ5Mjg5OTcwMDlkZWVjYzFiID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzQxY2E1MTA5YmJlYjRiZWM4N2U3MjA0YTgxY2Y5NGY1LnNldEljb24oaWNvbl8wNDk1YTM4ZWU2NzI0YTA0OTI4OTk3MDA5ZGVlY2MxYik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2QzYjhiNDM3ZTljYjRlYWFiMzFiNjQ3NjhiMTZjZTUxID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2M1NDQwM2YzNWQ2ZTQ4Y2Q4YzJhM2QwMmNiN2QxZDJjID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9jNTQ0MDNmMzVkNmU0OGNkOGMyYTNkMDJjYjdkMWQyYyIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDIsIDMpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2QzYjhiNDM3ZTljYjRlYWFiMzFiNjQ3NjhiMTZjZTUxLnNldENvbnRlbnQoaHRtbF9jNTQ0MDNmMzVkNmU0OGNkOGMyYTNkMDJjYjdkMWQyYyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzQxY2E1MTA5YmJlYjRiZWM4N2U3MjA0YTgxY2Y5NGY1LmJpbmRQb3B1cChwb3B1cF9kM2I4YjQzN2U5Y2I0ZWFhYjMxYjY0NzY4YjE2Y2U1MSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2UzMGRmOTM1Yzg1MzRhYTRiNWUzMWVkYzM4NmIxMjZiID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzkwNTQyMjk3NSwtMTIyLjM5NzEzNzA4M10sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzQ2N2ZmYjdkZDQ0YzQ3YjU4MzlkYmEwMjRjYjJlNzU1ID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2UzMGRmOTM1Yzg1MzRhYTRiNWUzMWVkYzM4NmIxMjZiLnNldEljb24oaWNvbl80NjdmZmI3ZGQ0NGM0N2I1ODM5ZGJhMDI0Y2IyZTc1NSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzI4MDNjOWM0ODI1MjQ0NjU4NDg2MWY5YmI3M2U2ODIyID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzMxNzVkYzVmYTg5MjQxYjM4Mzc4MTAxNDEwMGJiNGE3ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF8zMTc1ZGM1ZmE4OTI0MWIzODM3ODEwMTQxMDBiYjRhNyIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDIsIDQpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzI4MDNjOWM0ODI1MjQ0NjU4NDg2MWY5YmI3M2U2ODIyLnNldENvbnRlbnQoaHRtbF8zMTc1ZGM1ZmE4OTI0MWIzODM3ODEwMTQxMDBiYjRhNyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2UzMGRmOTM1Yzg1MzRhYTRiNWUzMWVkYzM4NmIxMjZiLmJpbmRQb3B1cChwb3B1cF8yODAzYzljNDgyNTI0NDY1ODQ4NjFmOWJiNzNlNjgyMik7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzRkNjQ4ZTBhNzMwNTQ5NTE5M2ZlNWE4YTIyNTllMGZlID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzMzODU0ODE0MywtMTIyLjQ2NTYxMjgzN10sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzJhMGMyNGRkNWQxMzRmNDc4NmNlYzI3MzA4NGE3ZDBhID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzRkNjQ4ZTBhNzMwNTQ5NTE5M2ZlNWE4YTIyNTllMGZlLnNldEljb24oaWNvbl8yYTBjMjRkZDVkMTM0ZjQ3ODZjZWMyNzMwODRhN2QwYSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzEwOTQ0ZDQ2MDM0OTQzNjJiYWIwMWI4ZTI0NTMwZDk5ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2JlYWM2ODQ5MDBlZDQ1MWVhMjc4YzUzZjMyYzIwMzAyID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9iZWFjNjg0OTAwZWQ0NTFlYTI3OGM1M2YzMmMyMDMwMiIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDIsIDUpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzEwOTQ0ZDQ2MDM0OTQzNjJiYWIwMWI4ZTI0NTMwZDk5LnNldENvbnRlbnQoaHRtbF9iZWFjNjg0OTAwZWQ0NTFlYTI3OGM1M2YzMmMyMDMwMik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzRkNjQ4ZTBhNzMwNTQ5NTE5M2ZlNWE4YTIyNTllMGZlLmJpbmRQb3B1cChwb3B1cF8xMDk0NGQ0NjAzNDk0MzYyYmFiMDFiOGUyNDUzMGQ5OSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzA0NGUwY2E5MGFjYTRiNDE4YTdhZDY2OGE1NTk3YWIzID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzg0NDAxNTU3OCwtMTIyLjQ4NTg0MTE3OF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzQ5YjdkZDM3OGZmZDRlM2U5ODM3NjdjODRmNDEzMTIzID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzA0NGUwY2E5MGFjYTRiNDE4YTdhZDY2OGE1NTk3YWIzLnNldEljb24oaWNvbl80OWI3ZGQzNzhmZmQ0ZTNlOTgzNzY3Yzg0ZjQxMzEyMyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzI2YTRkOGUyMDA3NDRjYzM4ODBhY2UxNzVlOWI0ZTMzID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzRhOWVhM2YzMTY3MTQ1MGY5NDgzZjg1YzMxODQ4MzVhID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF80YTllYTNmMzE2NzE0NTBmOTQ4M2Y4NWMzMTg0ODM1YSIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDIsIDYpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzI2YTRkOGUyMDA3NDRjYzM4ODBhY2UxNzVlOWI0ZTMzLnNldENvbnRlbnQoaHRtbF80YTllYTNmMzE2NzE0NTBmOTQ4M2Y4NWMzMTg0ODM1YSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzA0NGUwY2E5MGFjYTRiNDE4YTdhZDY2OGE1NTk3YWIzLmJpbmRQb3B1cChwb3B1cF8yNmE0ZDhlMjAwNzQ0Y2MzODgwYWNlMTc1ZTliNGUzMyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2VlODEzNmM0NWZiMzRlYjg5MDUzMmUzOWQ2MDkxYWRjID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzgwOTczOTMxNCwtMTIyLjQ1NTYzMzU5XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fMzgyMzRhZjU5M2NmNDY2ODliMmVlOTVhZWZlOTVhMGEgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9lZTgxMzZjNDVmYjM0ZWI4OTA1MzJlMzlkNjA5MWFkYy5zZXRJY29uKGljb25fMzgyMzRhZjU5M2NmNDY2ODliMmVlOTVhZWZlOTVhMGEpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mM2QyMDllYWUyNDM0NDk2YWVlYzY5NWIzNDBiZDcwZiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9iNzA5OGVhMjc1MTU0ZjYxOTVmYTc3ZWU5Zjg3OTNmOCA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfYjcwOThlYTI3NTE1NGY2MTk1ZmE3N2VlOWY4NzkzZjgiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICgzLCAxKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9mM2QyMDllYWUyNDM0NDk2YWVlYzY5NWIzNDBiZDcwZi5zZXRDb250ZW50KGh0bWxfYjcwOThlYTI3NTE1NGY2MTk1ZmE3N2VlOWY4NzkzZjgpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9lZTgxMzZjNDVmYjM0ZWI4OTA1MzJlMzlkNjA5MWFkYy5iaW5kUG9wdXAocG9wdXBfZjNkMjA5ZWFlMjQzNDQ5NmFlZWM2OTViMzQwYmQ3MGYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl9kZWUwNGQzNjIxODI0OTdhYTMyNjFjYjVjNjQ1YTYyYiA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjczOTQyNDIyOTYsLTEyMi40MzExMzg0OThdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8wYzE2YjdiNzFmOTg0YTA2ODY0NDdlOTYxYzQ3YzJmNyA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncmVkJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2RlZTA0ZDM2MjE4MjQ5N2FhMzI2MWNiNWM2NDVhNjJiLnNldEljb24oaWNvbl8wYzE2YjdiNzFmOTg0YTA2ODY0NDdlOTYxYzQ3YzJmNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2M1MjRhMDc3NTcxNzQ3YTJhNWNlNWEwNDVmOGY3NzY2ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2ZiM2ZmYmYxZDdkNzQwZjg5MGY0NmNmNjE2ZjJhMWFhID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9mYjNmZmJmMWQ3ZDc0MGY4OTBmNDZjZjYxNmYyYTFhYSIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDMsIDIpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2M1MjRhMDc3NTcxNzQ3YTJhNWNlNWEwNDVmOGY3NzY2LnNldENvbnRlbnQoaHRtbF9mYjNmZmJmMWQ3ZDc0MGY4OTBmNDZjZjYxNmYyYTFhYSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2RlZTA0ZDM2MjE4MjQ5N2FhMzI2MWNiNWM2NDVhNjJiLmJpbmRQb3B1cChwb3B1cF9jNTI0YTA3NzU3MTc0N2EyYTVjZTVhMDQ1ZjhmNzc2Nik7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzMyNzU2MWZhMDRiMjQzODY4ZmFmZDVhNzI1N2EzNmY1ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzI5MTUyNDE1NCwtMTIyLjQ2MTUzMjg4NF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzAyYTA3Mjc2YWRhNDQ0NzI5NWFiZTk0YTViODQ2YWE1ID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfMzI3NTYxZmEwNGIyNDM4NjhmYWZkNWE3MjU3YTM2ZjUuc2V0SWNvbihpY29uXzAyYTA3Mjc2YWRhNDQ0NzI5NWFiZTk0YTViODQ2YWE1KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZWJmYjY2YWZjYmUzNGMwYmI1ZjdjNDFjZGQ3ZDVhZWYgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNzY3ZDU4MmY1ZmE4NGFjM2EzZGEyODVmZTdlM2YzNTUgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzc2N2Q1ODJmNWZhODRhYzNhM2RhMjg1ZmU3ZTNmMzU1IiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoMywgMyk8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZWJmYjY2YWZjYmUzNGMwYmI1ZjdjNDFjZGQ3ZDVhZWYuc2V0Q29udGVudChodG1sXzc2N2Q1ODJmNWZhODRhYzNhM2RhMjg1ZmU3ZTNmMzU1KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfMzI3NTYxZmEwNGIyNDM4NjhmYWZkNWE3MjU3YTM2ZjUuYmluZFBvcHVwKHBvcHVwX2ViZmI2NmFmY2JlMzRjMGJiNWY3YzQxY2RkN2Q1YWVmKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfNzJmYmM1ZTM4MDVlNDA0Yjg0YWM1NzA0YjYxNzlmMDMgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy44MDQ1ODc4NjgxLC0xMjIuNDE0NDM0Mjg4XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fZTNjOWMyMWFkODJjNDcwNDgyNWEwMTA0M2MxNGY2YjYgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl83MmZiYzVlMzgwNWU0MDRiODRhYzU3MDRiNjE3OWYwMy5zZXRJY29uKGljb25fZTNjOWMyMWFkODJjNDcwNDgyNWEwMTA0M2MxNGY2YjYpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF80ZWZkY2NiZTNiNzI0MDllYTQxZGZhMTFhNjIxZWIyZSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF82NWIxZWFkZjU0OTE0ZWRjOTZlYjA1OTlmNzUyNDc3NyA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNjViMWVhZGY1NDkxNGVkYzk2ZWIwNTk5Zjc1MjQ3NzciICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICgzLCA0KTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF80ZWZkY2NiZTNiNzI0MDllYTQxZGZhMTFhNjIxZWIyZS5zZXRDb250ZW50KGh0bWxfNjViMWVhZGY1NDkxNGVkYzk2ZWIwNTk5Zjc1MjQ3NzcpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl83MmZiYzVlMzgwNWU0MDRiODRhYzU3MDRiNjE3OWYwMy5iaW5kUG9wdXAocG9wdXBfNGVmZGNjYmUzYjcyNDA5ZWE0MWRmYTExYTYyMWViMmUpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl9kOWM5MWNjYjAyZGU0MWRjYTkxYWU4ZmQ1YWQ2MDE5MSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjczMjk5OTUzOTgsLTEyMi40NDU4OTQ5OTNdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl84ZWYyN2ZkNDI4MzA0Nzc1YmVjNDExNTFjMmIyYWJiNyA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncmVkJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2Q5YzkxY2NiMDJkZTQxZGNhOTFhZThmZDVhZDYwMTkxLnNldEljb24oaWNvbl84ZWYyN2ZkNDI4MzA0Nzc1YmVjNDExNTFjMmIyYWJiNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2MzMTc1ZThiYTIyYzQyZjJhMjJhZjE4NWJjNjE2MmI4ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2JlNDg2ZDRkYThkNjQ4OTRiZmVmYzRiMDM5ZTQ0M2Q1ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9iZTQ4NmQ0ZGE4ZDY0ODk0YmZlZmM0YjAzOWU0NDNkNSIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDMsIDUpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2MzMTc1ZThiYTIyYzQyZjJhMjJhZjE4NWJjNjE2MmI4LnNldENvbnRlbnQoaHRtbF9iZTQ4NmQ0ZGE4ZDY0ODk0YmZlZmM0YjAzOWU0NDNkNSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2Q5YzkxY2NiMDJkZTQxZGNhOTFhZThmZDVhZDYwMTkxLmJpbmRQb3B1cChwb3B1cF9jMzE3NWU4YmEyMmM0MmYyYTIyYWYxODViYzYxNjJiOCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2QyMzJjYmY1N2E3YzQ3OTU4OTI1MjY4ZGYxOGY5N2ZkID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzE2Nzk2NDU1OCwtMTIyLjQ1MjI0NDYyM10sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzRjOTE1YTQ2YTc3YjRhZjBiMmNhZjk1NWI2MjM2NDQ5ID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfZDIzMmNiZjU3YTdjNDc5NTg5MjUyNjhkZjE4Zjk3ZmQuc2V0SWNvbihpY29uXzRjOTE1YTQ2YTc3YjRhZjBiMmNhZjk1NWI2MjM2NDQ5KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYjA2NDMyNTNkNmQyNDZlMWE3ZmQ0MTBiMDQwN2Q0ZjEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYTEyNjFiOGMyMmUzNGU0MGI3MWJmNzkwZWI1NDJmMjYgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sX2ExMjYxYjhjMjJlMzRlNDBiNzFiZjc5MGViNTQyZjI2IiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoMywgNik8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYjA2NDMyNTNkNmQyNDZlMWE3ZmQ0MTBiMDQwN2Q0ZjEuc2V0Q29udGVudChodG1sX2ExMjYxYjhjMjJlMzRlNDBiNzFiZjc5MGViNTQyZjI2KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfZDIzMmNiZjU3YTdjNDc5NTg5MjUyNjhkZjE4Zjk3ZmQuYmluZFBvcHVwKHBvcHVwX2IwNjQzMjUzZDZkMjQ2ZTFhN2ZkNDEwYjA0MDdkNGYxKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfNTdkYTZmOTFhZWVmNDAwNGI3NzJmZDRkMjVhOTJlZmMgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NjAzMjMzOTE2LC0xMjIuNDYyMTEzODU4XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fZjUzMGUzOTJiYWFmNGJmNGJiMDVhNjIxMzcyZmMxOGMgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2dyZWVuJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzU3ZGE2ZjkxYWVlZjQwMDRiNzcyZmQ0ZDI1YTkyZWZjLnNldEljb24oaWNvbl9mNTMwZTM5MmJhYWY0YmY0YmIwNWE2MjEzNzJmYzE4Yyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzViNDIzNDc3NzdlYTQ3YTQ4YmQ5YmI1YmZlNWVjNjg0ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzc5YzgzYWUwODNmMTQ1ZmZiOWIzZjllMTgwZmU4Zjg2ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF83OWM4M2FlMDgzZjE0NWZmYjliM2Y5ZTE4MGZlOGY4NiIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDQsIDEpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzViNDIzNDc3NzdlYTQ3YTQ4YmQ5YmI1YmZlNWVjNjg0LnNldENvbnRlbnQoaHRtbF83OWM4M2FlMDgzZjE0NWZmYjliM2Y5ZTE4MGZlOGY4Nik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzU3ZGE2ZjkxYWVlZjQwMDRiNzcyZmQ0ZDI1YTkyZWZjLmJpbmRQb3B1cChwb3B1cF81YjQyMzQ3Nzc3ZWE0N2E0OGJkOWJiNWJmZTVlYzY4NCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzZmOThlOWIyNTg3YzRkZDM5ZTNhNzE1NWQwNTVjNjk0ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzU4OTIzNjEzOSwtMTIyLjQyOTI4Nzg5NV0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2FlYjU2NDkwM2I0NTRkYzk4M2I3N2ViMjA0NzFjZGEzID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdncmVlbicsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl82Zjk4ZTliMjU4N2M0ZGQzOWUzYTcxNTVkMDU1YzY5NC5zZXRJY29uKGljb25fYWViNTY0OTAzYjQ1NGRjOTgzYjc3ZWIyMDQ3MWNkYTMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9hNmMyMDdiYmJkODA0NGZjYjEwYWI3OTMyNTQ1YWRjMSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yMTNjMDVmNDhiMTI0YzAzYjI1MmIwYzMzMDljYTdiYSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfMjEzYzA1ZjQ4YjEyNGMwM2IyNTJiMGMzMzA5Y2E3YmEiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg0LCAyKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9hNmMyMDdiYmJkODA0NGZjYjEwYWI3OTMyNTQ1YWRjMS5zZXRDb250ZW50KGh0bWxfMjEzYzA1ZjQ4YjEyNGMwM2IyNTJiMGMzMzA5Y2E3YmEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl82Zjk4ZTliMjU4N2M0ZGQzOWUzYTcxNTVkMDU1YzY5NC5iaW5kUG9wdXAocG9wdXBfYTZjMjA3YmJiZDgwNDRmY2IxMGFiNzkzMjU0NWFkYzEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl80YTdhM2NkM2NkNzU0OTJiYjViMDMyOGMwNmJkNDc3OSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc4NjUxNzQ5ODUsLTEyMi40MjM0NDU5MTJdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9hODVkY2E4Nzc4NmM0YTU5YTEwYWEzYjhlM2ZjMjAxNSA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnZ3JlZW4nLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfNGE3YTNjZDNjZDc1NDkyYmI1YjAzMjhjMDZiZDQ3Nzkuc2V0SWNvbihpY29uX2E4NWRjYTg3Nzg2YzRhNTlhMTBhYTNiOGUzZmMyMDE1KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZmNhZmFkZDdjN2QwNDBiMThjMGNlODlhNDgzZGQwMjQgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZjRhNGNkODgxOGQ1NDYwNmI5MzYzM2FhZWQ3OGU0OTAgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sX2Y0YTRjZDg4MThkNTQ2MDZiOTM2MzNhYWVkNzhlNDkwIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoNCwgMyk8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZmNhZmFkZDdjN2QwNDBiMThjMGNlODlhNDgzZGQwMjQuc2V0Q29udGVudChodG1sX2Y0YTRjZDg4MThkNTQ2MDZiOTM2MzNhYWVkNzhlNDkwKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNGE3YTNjZDNjZDc1NDkyYmI1YjAzMjhjMDZiZDQ3NzkuYmluZFBvcHVwKHBvcHVwX2ZjYWZhZGQ3YzdkMDQwYjE4YzBjZTg5YTQ4M2RkMDI0KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfYWFjNGNjNjYyMTNiNDU4OGJmZGMwMDFjMmY4YjM1NjAgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODkxMTYzMTExLC0xMjIuNDQ2MTM0MjgxXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fOWJmZDY4NjBjNTQwNDhmYzg1MTI3MzI0ZWU3MWE1ZGEgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2dyZWVuJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2FhYzRjYzY2MjEzYjQ1ODhiZmRjMDAxYzJmOGIzNTYwLnNldEljb24oaWNvbl85YmZkNjg2MGM1NDA0OGZjODUxMjczMjRlZTcxYTVkYSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzUyYWI1NjY1NmYxNDQyNGM5MDIxMmM2MWVjMzNkOGUxID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzY1OTIwZWJkNGQ5NjRmNDNhNTQ2MTFlMzNhOTRkZGM3ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF82NTkyMGViZDRkOTY0ZjQzYTU0NjExZTMzYTk0ZGRjNyIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDQsIDQpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzUyYWI1NjY1NmYxNDQyNGM5MDIxMmM2MWVjMzNkOGUxLnNldENvbnRlbnQoaHRtbF82NTkyMGViZDRkOTY0ZjQzYTU0NjExZTMzYTk0ZGRjNyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2FhYzRjYzY2MjEzYjQ1ODhiZmRjMDAxYzJmOGIzNTYwLmJpbmRQb3B1cChwb3B1cF81MmFiNTY2NTZmMTQ0MjRjOTAyMTJjNjFlYzMzZDhlMSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzI4YjQyMGViZTA5ZTQzOTg5ZGJmNTY5YjY1NDIwYmM5ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzc5NzA0OTk3MSwtMTIyLjQwNzkxNjIzN10sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzFlNDk2MDhmZThhNjQ3MjU5ZWQ3MDFmZTY2OTJiY2NhID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdncmVlbicsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8yOGI0MjBlYmUwOWU0Mzk4OWRiZjU2OWI2NTQyMGJjOS5zZXRJY29uKGljb25fMWU0OTYwOGZlOGE2NDcyNTllZDcwMWZlNjY5MmJjY2EpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8xYzhlYTg0MDhmYjA0NTFiYTZhM2QxMDk4NjExMjllMCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8zZDJhYjU4M2JjNmI0YWY4ODgyMDQ3MTE1NTRhY2U3OCA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfM2QyYWI1ODNiYzZiNGFmODg4MjA0NzExNTU0YWNlNzgiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg0LCA1KTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8xYzhlYTg0MDhmYjA0NTFiYTZhM2QxMDk4NjExMjllMC5zZXRDb250ZW50KGh0bWxfM2QyYWI1ODNiYzZiNGFmODg4MjA0NzExNTU0YWNlNzgpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl8yOGI0MjBlYmUwOWU0Mzk4OWRiZjU2OWI2NTQyMGJjOS5iaW5kUG9wdXAocG9wdXBfMWM4ZWE4NDA4ZmIwNDUxYmE2YTNkMTA5ODYxMTI5ZTApOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl82N2MwZDMyOGE4Zjg0OGE4ODAyMjViZWVhZDQ0ZjdlMSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc4MDg4NTQwMTIsLTEyMi40MjAzMTA2NzVdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9kODA3M2I3OTg2ODc0NzAxYWQ0YzgxYjUzZTIxNzk4MiA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnZ3JlZW4nLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfNjdjMGQzMjhhOGY4NDhhODgwMjI1YmVlYWQ0NGY3ZTEuc2V0SWNvbihpY29uX2Q4MDczYjc5ODY4NzQ3MDFhZDRjODFiNTNlMjE3OTgyKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfYTAxYjc4ZGVlZjUzNDU0Mjk2NzdhZDYwZDA0OTY3NmUgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYzNkZjM5NzRkOWExNDBiOTk2NWU1N2UxMmZhYTJiZDggPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sX2MzZGYzOTc0ZDlhMTQwYjk5NjVlNTdlMTJmYWEyYmQ4IiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoNCwgNik8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfYTAxYjc4ZGVlZjUzNDU0Mjk2NzdhZDYwZDA0OTY3NmUuc2V0Q29udGVudChodG1sX2MzZGYzOTc0ZDlhMTQwYjk5NjVlNTdlMTJmYWEyYmQ4KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNjdjMGQzMjhhOGY4NDhhODgwMjI1YmVlYWQ0NGY3ZTEuYmluZFBvcHVwKHBvcHVwX2EwMWI3OGRlZWY1MzQ1NDI5Njc3YWQ2MGQwNDk2NzZlKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfZGEwMzYxY2Q4OTRiNGJjNGJmZjBhN2NmNjhmMTQwZTcgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NjMxNjg5MzA2LC0xMjIuNDQ5MTY3Nzg5XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fM2JmZDQxZjhmZjU3NDY0Nzk5MzQxMjFmNWNjMDliN2MgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3B1cnBsZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9kYTAzNjFjZDg5NGI0YmM0YmZmMGE3Y2Y2OGYxNDBlNy5zZXRJY29uKGljb25fM2JmZDQxZjhmZjU3NDY0Nzk5MzQxMjFmNWNjMDliN2MpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wYjFhNjgyNGJmZDU0NTk5YmZmZjA3MWI0ZWJiYzAyOSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9kNTZmNzA0Yzg3YWI0ZjhiYmYxMWU1MTAzMzc4YzVlZSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfZDU2ZjcwNGM4N2FiNGY4YmJmMTFlNTEwMzM3OGM1ZWUiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg1LCAxKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8wYjFhNjgyNGJmZDU0NTk5YmZmZjA3MWI0ZWJiYzAyOS5zZXRDb250ZW50KGh0bWxfZDU2ZjcwNGM4N2FiNGY4YmJmMTFlNTEwMzM3OGM1ZWUpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9kYTAzNjFjZDg5NGI0YmM0YmZmMGE3Y2Y2OGYxNDBlNy5iaW5kUG9wdXAocG9wdXBfMGIxYTY4MjRiZmQ1NDU5OWJmZmYwNzFiNGViYmMwMjkpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl85ODg1YWJkYzVjMTM0MzYzYmViMjM2YTg2MmJjZTQ0OSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjcyNDM5NTMzMTEsLTEyMi4zODMyMTM0NDNdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9mM2I2ZGRhNTYwOTM0Mjk2YmMwMTM4MjI3NzhlNTU1YiA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncHVycGxlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzk4ODVhYmRjNWMxMzQzNjNiZWIyMzZhODYyYmNlNDQ5LnNldEljb24oaWNvbl9mM2I2ZGRhNTYwOTM0Mjk2YmMwMTM4MjI3NzhlNTU1Yik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzU0MmI0ZTE3ZjE5NTRhMzJiNzVhNWE4ZDBmMTE2NDhmID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzBlMjUwZmE1MTM2ZjQxYmJhOWM4YmU3Y2YzMDE0YTZlID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF8wZTI1MGZhNTEzNmY0MWJiYTljOGJlN2NmMzAxNGE2ZSIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDUsIDIpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzU0MmI0ZTE3ZjE5NTRhMzJiNzVhNWE4ZDBmMTE2NDhmLnNldENvbnRlbnQoaHRtbF8wZTI1MGZhNTEzNmY0MWJiYTljOGJlN2NmMzAxNGE2ZSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzk4ODVhYmRjNWMxMzQzNjNiZWIyMzZhODYyYmNlNDQ5LmJpbmRQb3B1cChwb3B1cF81NDJiNGUxN2YxOTU0YTMyYjc1YTVhOGQwZjExNjQ4Zik7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzQ5NmM5NTc2YTdkOTQ2NjRhMzJlMWZhZTE0OGQxNGQ4ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzI0MTY0MjgxOCwtMTIyLjM3NDgzNDYzNF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzJjZGQ2MDdlYTQwMDQ0OGY4YjUxYTk3NTMwZjRjNWQxID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdwdXJwbGUnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfNDk2Yzk1NzZhN2Q5NDY2NGEzMmUxZmFlMTQ4ZDE0ZDguc2V0SWNvbihpY29uXzJjZGQ2MDdlYTQwMDQ0OGY4YjUxYTk3NTMwZjRjNWQxKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNmVhYTA2MmEyZDczNGNlMDhjZTIxOTQ3OTgwNmYzM2IgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNWU1ZGQ5YzZkNWFjNGY4OTg3ZmY5Y2JjOTU2ZDQzNTggPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzVlNWRkOWM2ZDVhYzRmODk4N2ZmOWNiYzk1NmQ0MzU4IiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoNSwgMyk8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNmVhYTA2MmEyZDczNGNlMDhjZTIxOTQ3OTgwNmYzM2Iuc2V0Q29udGVudChodG1sXzVlNWRkOWM2ZDVhYzRmODk4N2ZmOWNiYzk1NmQ0MzU4KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNDk2Yzk1NzZhN2Q5NDY2NGEzMmUxZmFlMTQ4ZDE0ZDguYmluZFBvcHVwKHBvcHVwXzZlYWEwNjJhMmQ3MzRjZTA4Y2UyMTk0Nzk4MDZmMzNiKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfNGQ1ZmJjMDU4MjkzNGMwNjg3YzRkOGZjY2NiYWJiMjggPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43Nzg2ODEzNDU5LC0xMjIuNDk5MDMxNjM5XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fZDdkNTNhNjU4MDEyNDQ4YmJmMjQ5ZGZiMTc5OTVjNDEgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3B1cnBsZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl80ZDVmYmMwNTgyOTM0YzA2ODdjNGQ4ZmNjY2JhYmIyOC5zZXRJY29uKGljb25fZDdkNTNhNjU4MDEyNDQ4YmJmMjQ5ZGZiMTc5OTVjNDEpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9lNjBiMjNlOGMzNjg0N2Q1ODc0ODViNjlmOTc5ZjZhZiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF85MWIxMWM1M2E3ZjA0NWFlOTVjMjYyYjJmNzAxZmZlYSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfOTFiMTFjNTNhN2YwNDVhZTk1YzI2MmIyZjcwMWZmZWEiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg1LCA0KTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9lNjBiMjNlOGMzNjg0N2Q1ODc0ODViNjlmOTc5ZjZhZi5zZXRDb250ZW50KGh0bWxfOTFiMTFjNTNhN2YwNDVhZTk1YzI2MmIyZjcwMWZmZWEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl80ZDVmYmMwNTgyOTM0YzA2ODdjNGQ4ZmNjY2JhYmIyOC5iaW5kUG9wdXAocG9wdXBfZTYwYjIzZThjMzY4NDdkNTg3NDg1YjY5Zjk3OWY2YWYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl82YmNiZWE3NzEwNWU0MWQzOGYxNDlmMjZiNzVkMDI4MyA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjczOTEyOTM4MjMsLTEyMi4zNzgwMTIyMjZdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl85ZmZjY2NjMmFhNzM0YjRjOWU2ZDE2MTNkYmE4YThlOCA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncHVycGxlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzZiY2JlYTc3MTA1ZTQxZDM4ZjE0OWYyNmI3NWQwMjgzLnNldEljb24oaWNvbl85ZmZjY2NjMmFhNzM0YjRjOWU2ZDE2MTNkYmE4YThlOCk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzFmYmY2ZDA1ZmMyOTRlMTA4YjRjODNlM2E4ZmMzYjk5ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2FmZDczY2EwZmUwZjQ4MTNiNDA3NGM5OTk0NTBjNmVmID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9hZmQ3M2NhMGZlMGY0ODEzYjQwNzRjOTk5NDUwYzZlZiIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDUsIDUpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzFmYmY2ZDA1ZmMyOTRlMTA4YjRjODNlM2E4ZmMzYjk5LnNldENvbnRlbnQoaHRtbF9hZmQ3M2NhMGZlMGY0ODEzYjQwNzRjOTk5NDUwYzZlZik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzZiY2JlYTc3MTA1ZTQxZDM4ZjE0OWYyNmI3NWQwMjgzLmJpbmRQb3B1cChwb3B1cF8xZmJmNmQwNWZjMjk0ZTEwOGI0YzgzZTNhOGZjM2I5OSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2EzMjc0ZDQ3MjgyMTQ4NTE5YTNhZTI3OTRiYTAxNTE1ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzY1MzEwMTY4LC0xMjIuNDgxMDk4NDE2XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fMjM0NGUyNWM1MDM0NDNmZmE2ZmZkNGFhN2ExZWMyZWMgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3B1cnBsZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9hMzI3NGQ0NzI4MjE0ODUxOWEzYWUyNzk0YmEwMTUxNS5zZXRJY29uKGljb25fMjM0NGUyNWM1MDM0NDNmZmE2ZmZkNGFhN2ExZWMyZWMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8zOTc1ZmExODhmYzM0Yjg3YjU4NmRmYTM4MmU5NTQzMiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF82ZWU3NjA1OTRhMDE0ZmU0OTFlYjc4Mjk1NWVjYmNlZCA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNmVlNzYwNTk0YTAxNGZlNDkxZWI3ODI5NTVlY2JjZWQiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg1LCA2KTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8zOTc1ZmExODhmYzM0Yjg3YjU4NmRmYTM4MmU5NTQzMi5zZXRDb250ZW50KGh0bWxfNmVlNzYwNTk0YTAxNGZlNDkxZWI3ODI5NTVlY2JjZWQpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9hMzI3NGQ0NzI4MjE0ODUxOWEzYWUyNzk0YmEwMTUxNS5iaW5kUG9wdXAocG9wdXBfMzk3NWZhMTg4ZmMzNGI4N2I1ODZkZmEzODJlOTU0MzIpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl8wNjQxNDZhYjJlYmM0NWUzYjM2YTFlOTc3NzUwZGEwZSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3LjczNTkwOTU4MjUsLTEyMi40ODcyMTU2MTZdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8wYzgwMTg3ZGRiMWE0M2UyOTRkMjNmZTA2ZGM1MmVkMiA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnb3JhbmdlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzA2NDE0NmFiMmViYzQ1ZTNiMzZhMWU5Nzc3NTBkYTBlLnNldEljb24oaWNvbl8wYzgwMTg3ZGRiMWE0M2UyOTRkMjNmZTA2ZGM1MmVkMik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2IyZjEzYWYwY2M3NDQyYWI5YzQ2ZDlmMWY0YjNlNTlmID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzMwNTNjZGU3ZjFiMDQwMzFiN2FkYjRiMTcyMTMxZWU0ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF8zMDUzY2RlN2YxYjA0MDMxYjdhZGI0YjE3MjEzMWVlNCIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDYsIDEpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2IyZjEzYWYwY2M3NDQyYWI5YzQ2ZDlmMWY0YjNlNTlmLnNldENvbnRlbnQoaHRtbF8zMDUzY2RlN2YxYjA0MDMxYjdhZGI0YjE3MjEzMWVlNCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzA2NDE0NmFiMmViYzQ1ZTNiMzZhMWU5Nzc3NTBkYTBlLmJpbmRQb3B1cChwb3B1cF9iMmYxM2FmMGNjNzQ0MmFiOWM0NmQ5ZjFmNGIzZTU5Zik7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2IxYTUzOTZmODcyZDRjYzE5YzBjMmNkZmFjMTI1NjA0ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzY1MjI2MDMxLC0xMjIuNDAxMjM3NDMzXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fMTUwZjg3ZDk3ZDU4NGU0MmIwODkwMmQ0NGM1ZjM2NjIgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ29yYW5nZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9iMWE1Mzk2Zjg3MmQ0Y2MxOWMwYzJjZGZhYzEyNTYwNC5zZXRJY29uKGljb25fMTUwZjg3ZDk3ZDU4NGU0MmIwODkwMmQ0NGM1ZjM2NjIpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9kN2FjODc2MzZlMDg0NTYxYjgwZGQ5OTUzYTViOGU0MSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9jODlhYTk0MmE5YmI0NTI2OWZiMzUwMDMyMzllOTc2ZSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfYzg5YWE5NDJhOWJiNDUyNjlmYjM1MDAzMjM5ZTk3NmUiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg2LCAyKTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9kN2FjODc2MzZlMDg0NTYxYjgwZGQ5OTUzYTViOGU0MS5zZXRDb250ZW50KGh0bWxfYzg5YWE5NDJhOWJiNDUyNjlmYjM1MDAzMjM5ZTk3NmUpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9iMWE1Mzk2Zjg3MmQ0Y2MxOWMwYzJjZGZhYzEyNTYwNC5iaW5kUG9wdXAocG9wdXBfZDdhYzg3NjM2ZTA4NDU2MWI4MGRkOTk1M2E1YjhlNDEpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl8yNmQ2YzA1MTA3ZGU0OTg3ODYxZDc3YmM5NTEyOTliMSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc5OTA5NDEzMjIsLTEyMi40MDQxMTU2ODFdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9mYjJiZjRhOWI0M2Y0MzM2YTJlZGYzMTI2ZWM0M2NlNCA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnb3JhbmdlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzI2ZDZjMDUxMDdkZTQ5ODc4NjFkNzdiYzk1MTI5OWIxLnNldEljb24oaWNvbl9mYjJiZjRhOWI0M2Y0MzM2YTJlZGYzMTI2ZWM0M2NlNCk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzEwNDMzNmMyODIxMjQ1YmNiYjUzMzgxNjAyYjYzM2E5ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2JhZjljY2ZjOWE2ODQ1NTI5NWYxOWRmNjUwZDQ2ZmQyID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9iYWY5Y2NmYzlhNjg0NTUyOTVmMTlkZjY1MGQ0NmZkMiIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDYsIDMpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzEwNDMzNmMyODIxMjQ1YmNiYjUzMzgxNjAyYjYzM2E5LnNldENvbnRlbnQoaHRtbF9iYWY5Y2NmYzlhNjg0NTUyOTVmMTlkZjY1MGQ0NmZkMik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzI2ZDZjMDUxMDdkZTQ5ODc4NjFkNzdiYzk1MTI5OWIxLmJpbmRQb3B1cChwb3B1cF8xMDQzMzZjMjgyMTI0NWJjYmI1MzM4MTYwMmI2MzNhOSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2NjODA5ODAzOGQzNzQyMTNiZjNlMWQ2NmExZTRmOWJjID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzk0OTAyNjQzNCwtMTIyLjQyMDk2NjY5Nl0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzhhNzI3NTI0NDZiOTQ2Mzk4YzMyYzExMTRiMTZkZWE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzIxZjQwZGMyY2E2NTQyOGZiOWY5OGYwYmI5ZmUwZjE3ID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdvcmFuZ2UnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfY2M4MDk4MDM4ZDM3NDIxM2JmM2UxZDY2YTFlNGY5YmMuc2V0SWNvbihpY29uXzIxZjQwZGMyY2E2NTQyOGZiOWY5OGYwYmI5ZmUwZjE3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfZDEyOWJiZjA4ZTExNDFkNWFmYzc1N2I0Y2YxNzhjYTEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfYmI4ZjZjNTg3MzAwNGNiNjg1MDQ3ZWU0ZjM3MDIyMGUgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sX2JiOGY2YzU4NzMwMDRjYjY4NTA0N2VlNGYzNzAyMjBlIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAoNiwgNCk8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZDEyOWJiZjA4ZTExNDFkNWFmYzc1N2I0Y2YxNzhjYTEuc2V0Q29udGVudChodG1sX2JiOGY2YzU4NzMwMDRjYjY4NTA0N2VlNGYzNzAyMjBlKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfY2M4MDk4MDM4ZDM3NDIxM2JmM2UxZDY2YTFlNGY5YmMuYmluZFBvcHVwKHBvcHVwX2QxMjliYmYwOGUxMTQxZDVhZmM3NTdiNGNmMTc4Y2ExKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfMTYxMTI5N2QzZGM1NDNjOWJmOTRhMjM1MjI0NThjNDggPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NjQwNjk5ODI2LC0xMjIuNDg0NTA4OTE3XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfOGE3Mjc1MjQ0NmI5NDYzOThjMzJjMTExNGIxNmRlYTcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fMTlmNDVhMzU1NmNhNGY3ZWFjMjNhMjJhOWY5MzVjNDggPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ29yYW5nZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8xNjExMjk3ZDNkYzU0M2M5YmY5NGEyMzUyMjQ1OGM0OC5zZXRJY29uKGljb25fMTlmNDVhMzU1NmNhNGY3ZWFjMjNhMjJhOWY5MzVjNDgpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF8wZDYzYjljOWI2YWQ0YTJlOTljNjEzZjgxYmZjMGMxNSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF84ZDA3ZWFkMGVkY2I0YzY2OWY2MzNkNGM5ZDE0OTVmYiA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfOGQwN2VhZDBlZGNiNGM2NjlmNjMzZDRjOWQxNDk1ZmIiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgICg2LCA1KTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF8wZDYzYjljOWI2YWQ0YTJlOTljNjEzZjgxYmZjMGMxNS5zZXRDb250ZW50KGh0bWxfOGQwN2VhZDBlZGNiNGM2NjlmNjMzZDRjOWQxNDk1ZmIpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl8xNjExMjk3ZDNkYzU0M2M5YmY5NGEyMzUyMjQ1OGM0OC5iaW5kUG9wdXAocG9wdXBfMGQ2M2I5YzliNmFkNGEyZTk5YzYxM2Y4MWJmYzBjMTUpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl9iYTY4MDVhNjE1ODc0Y2Y1YmFkZTM1YWVhZDQ0MmJkNSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc5OTQzMjg2ODksLTEyMi40MTIzMjQwMThdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF84YTcyNzUyNDQ2Yjk0NjM5OGMzMmMxMTE0YjE2ZGVhNyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl82NTkwNTYxYjk5ZTQ0MTFlOWRhM2Q1ZjM1Y2MzYTdkOSA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnb3JhbmdlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2JhNjgwNWE2MTU4NzRjZjViYWRlMzVhZWFkNDQyYmQ1LnNldEljb24oaWNvbl82NTkwNTYxYjk5ZTQ0MTFlOWRhM2Q1ZjM1Y2MzYTdkOSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2QzOWZmNTM2NGU3ODQ1YzFiMmJmZDE4NWE0NTVmNzdkID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2IwMDE1ZDQ0NTViYzRkZGU4MjkzZjg1MDVjMmI2N2VkID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9iMDAxNWQ0NDU1YmM0ZGRlODI5M2Y4NTA1YzJiNjdlZCIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgKDYsIDYpPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2QzOWZmNTM2NGU3ODQ1YzFiMmJmZDE4NWE0NTVmNzdkLnNldENvbnRlbnQoaHRtbF9iMDAxNWQ0NDU1YmM0ZGRlODI5M2Y4NTA1YzJiNjdlZCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2JhNjgwNWE2MTU4NzRjZjViYWRlMzVhZWFkNDQyYmQ1LmJpbmRQb3B1cChwb3B1cF9kMzlmZjUzNjRlNzg0NWMxYjJiZmQxODVhNDU1Zjc3ZCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L3NjcmlwdD4KICAgICAgICA=" style="position:absolute;width:100%;height:100%;left:0;top:0;"></iframe></div></div>



## Determining Stop Order using Mapzen's Optimize Route Service 
Now that I have tools to geocode and visualize points, I'm ready write a function that uses the optimize route tool to determine the an optimal order in which one person should visit a set of points. Later on, I will build off of this function to optimize stops for multiple people, but this is an initial building-block.

My function is written in a way that the start and end location are assumed to be the same, although this could easily be tweaked. The function takes a "home" location, a set of stops, and calculates the quickest route to go from home, to each of these stops, and back. It returns a dictionary of the raw output, as well as the pieces of information that are most relevant for my purposes - trip length, trip distance, optimized stop order, stop coordinates, and route coordinates.

Note that Mapzen uses the [Google Maps encoded polyline format](https://developers.google.com/maps/documentation/utilities/polylinealgorithm) to store a series of latitude, longitude coordinates as a single string (this is done to reduce the size of the route). However, for my purposes, I need the string decoded into a list of lat/long coordinates. Mapzen provides [code](https://mapzen.com/documentation/mobility/decoding/) that can be used to decode the string, which I use below.

My function then wraps the geocoding function I wrote above, so that the user can specify any combination of addresses, venues, and coordinates (if coordinates are specified they are not passed to the geocoding function).  It defaults to pedestrian mode of transportation, but can also optimize driving and biking routes.

I also allow the user to specify a set of stop labels, which will be returned as the ordered list of stops. Otherwise, the function defaults to the raw input that was passed to the function.


```python
#Decoding function used to extract lat/long coordinates from google maps encoded polylines
#https://mapzen.com/documentation/mobility/decoding/

#six degrees of precision in valhalla
inv = 1.0 / 1e6;
#decode an encoded string
def decode(encoded):
    decoded = []
    previous = [0,0]
    i = 0
    #for each byte
    while i < len(encoded):
        #for each coord (lat, lon)
        ll = [0, 0]
        for j in [0, 1]:
            shift = 0
            byte = 0x20
            #keep decoding bytes until you have this coord
            while byte >=  0x20:
                byte = ord(encoded[i]) - 63
                i +=  1
                ll[j] |=  (byte & 0x1f) << shift
                shift +=  5
            #get the final value adding the previous offset and remember it for the next
            ll[j] = previous[j] + (~(ll[j] >> 1) if ll[j] & 1 else (ll[j] >> 1))
            previous[j] = ll[j]
            #scale by the precision and chop off long coords also flip the positions so
            #its the far more standard lon,lat instead of lat,lon
        decoded.append([float('%.6f' % (ll[1] * inv)), float('%.6f' % (ll[0] * inv))])
    #hand back the list of coordinates
    return decoded
```


```python
def optimize_stops(home, stops, costing = 'pedestrian', api_key = matrix_key, home_label = 'Home',
                  stop_labels = None):
    
    #geocode home and stops if not a coordinate
    home = home if type(home) is tuple else geocode_address_venue(home)
    stops = [geocode_address_venue(stop)['coords'] if type(stop) is not tuple else stop for stop in stops]
    
    #full set of points are list of points that start and end with the home location
    points = [home] + stops + [home]
    
    #define point labels
    names = [home_label] + (stop_labels if stop_labels else stops) + [home_label]
    
    #set up parameters to pass to mapzen function
    js = {'locations':[{'lon': point[0], 'lat': point[1]} for point in points], 'costing': costing}
    params = {'json': json.dumps(js), 'api_key': api_key}
    url = 'https://matrix.mapzen.com/optimized_route'
    r = requests.get(url, params = params)
    raw = r.json()
    
    #get the coordinates of the stops in their new optimized order
    locs = raw['trip']['locations']
    new_point_order = [(locs[loc]['lon'], locs[loc]['lat']) for loc in range(len(locs))]
    
    #the new points returned from the mapzen tool need to be matched up to my original set of points passed
    #to the function, so that the point name order can be determined. The mapzen points are not exactly the same 
    #values as the original points passed (they are probably located to the nearest street or something). 
    #Therefore, I link the new points and the original points by rounding the coordinates to account for 
    #differences in input and output. This is then used to calculate the order of the point names
    new_point_order_rounded = [(round(x, 3), round(y, 3)) for (x, y) in new_point_order]
    original_points_rounded = [(round(x, 3), round(y, 3)) for (x, y) in points]
    point_order = [original_points_rounded.index(x) for x in new_point_order_rounded]
    name_order = [names[i] for i in point_order]
    
    #Extract the path shape for each of the legs, decode them, and then combine into one polyline
    raw_path = [raw['trip']['legs'][x]['shape'] for x in range(len(raw['trip']['legs']))]
    decode_paths = [tuple(item) for sublist in [decode(z) for z in raw_path] for item in sublist]
    
    #return a dictionary that contains raw mapzen output, trip time, trip distance, new ordered points, 
    #new ordered point names, and a decoded path
    return {'raw': raw, 
    'time': raw['trip']['summary']['time']/60,
    'length': raw['trip']['summary']['length'], 
    'points': new_point_order,
    'order': name_order,
    'line': decode_paths}
```

Below, I set up the parameters that I will pass to the optimize route function. I specify a list of 6 stops in my neighborhood that Celeste and I will need to visit as part of our Sunday morning errands (note that I use a combination of business names, addresses, and coordinates). I also specify the set of names that correspond to these stops, that will be used just to make the labeling easier. As much as I wish it were the case, our Sunday errands generally do not involve ice cream, pizza, bagels, and art museums. Nonetheless, for this example I've included my favorite desinations of these types as stops that we need to make.

Lastly, I specify our approximate home coordinates that we will be routing to and from.


```python
stops = ['Toy Boat Dessert Cafe, San Francisco, CA',
       'Pizzetta 211, San Francisco, CA', 
       'Arguello Super Market, San Francisco, CA',
       '4700 Geary Blvd, San Francisco, CA',
       (-122.465613, 37.770016),
       '3519 California St, San Francisco, CA 94118']

stop_labels = ['Toy Boat',
             'Pizzetta',
             'Arguello Market',
             'Lamps Plus',
             'de Young Museum',
             "Noah's Bagels"]

home = (-122.464186, 37.779111)
```

I then apply this function to my set of stops and return the optimized stop order, the route time, and the route distance. I first optimize the route as a pedestrian and then as a bicyclist. As you can see, the stop order is slightly different for these two modes of transit, likely keeping the bike route on roads / paths that are better for biking.


```python
walk_opt = optimize_stops(home, stops, stop_labels = stop_labels)
print walk_opt['order']
print str(walk_opt['time']) + ' minutes'
print str(walk_opt['length']) + ' km'
```

    ['Home', 'de Young Museum', 'Arguello Market', "Noah's Bagels", 'Toy Boat', 'Pizzetta', 'Lamps Plus', 'Home']
    113 minutes
    9.357 km
    


```python
bike_opt = optimize_stops(home, stops, stop_labels = stop_labels,costing = 'bicycle')
print bike_opt['order']
print str(bike_opt['time']) + ' minutes'
print str(bike_opt['length']) + ' km'
```

    ['Home', 'Pizzetta', 'Lamps Plus', 'Toy Boat', "Noah's Bagels", 'Arguello Market', 'de Young Museum', 'Home']
    29 minutes
    11.08 km
    

## Determining Stops and Order with Multiple People

Now that I have a working function that wraps Mapzen's optimize route service, I am ready to extend it work with multiple people. The general approach is to first find the unique combinations that a list of stops can be split among a given number of people, and then determine in which of these combinations minimizes the maximum time of any 1 person. 

### Unique ways that stops can be split
I use a function adapted from [here](http://stackoverflow.com/a/39199937/3776938) to find the unique ways in that a list of N elements can be partitioned into K groups. This function is written so that the order of groups or of elements within a group does not matter. By this I mean that ```[['A','B'],['C','D']]``` is considered identical to ```[['C','D'],['A','B']]``` as well as to ```[['B','A'],['C','D']]```.


```python
def sorted_k_partitions(seq, k):
    n = len(seq)
    working_partition = []

    def generate_partitions(i):
        if i >=  n:
            yield list(map(tuple, working_partition))
        else:
            if n - i > k - len(working_partition):
                for part in working_partition:
                    part.append(seq[i])
                    for bar in generate_partitions(i + 1):
                        yield bar
                    part.pop()

            if len(working_partition) < k:
                working_partition.append([seq[i]])
                for bar in generate_partitions(i + 1):
                    yield bar
                working_partition.pop()

    result = generate_partitions(0)

    # Sort the parts in each partition in shortlex order and then by the length of each part, 
    #and then lexicographically
    result = [sorted(ps, key = lambda p: (len(p), p)) for ps in result]
    result = sorted(result, key = lambda ps: (map(len, ps), ps))
    return result
```

I demonstrate an application of the function below, showing the 7 unique ways that 4 stops can be split among 3 people. Obviously if I were to split these 4 stops among 4 people or among 1 person, there is only 1 possible solution for each case (as shown below). 


```python
for c in sorted_k_partitions(['A', 'B', 'C', 'D'], 2):
    print c
```

    [('A',), ('B', 'C', 'D')]
    [('B',), ('A', 'C', 'D')]
    [('C',), ('A', 'B', 'D')]
    [('D',), ('A', 'B', 'C')]
    [('A', 'B'), ('C', 'D')]
    [('A', 'C'), ('B', 'D')]
    [('A', 'D'), ('B', 'C')]
    


```python
for c in sorted_k_partitions(['A', 'B', 'C', 'D'], 4):
    print c
```

    [('A',), ('B',), ('C',), ('D',)]
    


```python
for c in sorted_k_partitions(['A', 'B', 'C', 'D'], 1):
    print c
```

    [('A', 'B', 'C', 'D')]
    

### Optimizing Stops Among K People
I then write a function that wraps my single-person route optimization function. The function applies the original function to each unique way that the stops can be partitioned, and determines the the partition that minimizes the maximum time of the travelers. The input is identical to the original function except for the ```num_travelers``` parameter. If ```num_travelers``` is set to 1, the result will be identical between the two functions.

The output too is nearly identical to the previous function - a dictionary containing stop order, stop points, and trip time. However, now the function returns a list of these values, where the length of the list is equal to the number of travelers.


```python
def optimize_stops_mult(home, stops, num_travelers, costing = 'pedestrian', api_key = matrix_key, home_label = 'Home',
                  stop_labels = None):
    #get all possible options in which the stops can be broken up between the specified number of travelers
    options = sorted_k_partitions(stops, num_travelers)
    #create lists to store sublists of the time, name order, and point order for each option and traveler
    all_times = []
    all_orders = []
    all_points = []
    all_lines = []
    for option in options: #loop through each possible way to split the stops
        #create lists to store the time, name order, and point order for each traveler
        option_times = [] 
        option_orders = []
        option_points = []
        option_lines = []
        #calculate the optimal stop order for each traveler with each set of stop options
        #using the previously defined function
        #append relevant information to lists
        for traveler in option:
            sub_labels = [stop_labels[stops.index(x)] for x in traveler] if stop_labels else None

            result = optimize_stops(home = home, stops = list(traveler), costing = costing, api_key = api_key,
                                  home_label = home_label, stop_labels = sub_labels)
            option_times.append(result['time'])
            option_orders.append(result['order'])
            option_points.append(result['points'])
            option_lines.append(result['line'])

        all_times.append(option_times)
        all_orders.append(option_orders)
        all_points.append(option_points)
        all_lines.append(option_lines)

    #get the index of the option that minimizes the max of any time that a traveler takes
    minloc = np.argmin([max(time) for time in all_times])
    
    #return a dictionary of the stop order, points, and time for the optimized options
    opt_order = [x[1: -1] for x in all_orders[minloc]]
    opt_times = all_times[minloc]
    opt_points = [x[1: -1] for x in all_points[minloc]]
    home_point = [x[0] for x in all_points[minloc]][0]
    polylines = all_lines[minloc]
    return {'order': opt_order, 'time': opt_times, 'points': opt_points, 'home_point': home_point, 'lines':polylines}

```

I use the same set of 6 stops in the Inner Richmond, but now specify that there will be two travelers. I extract the ordered set of stops for each of the two travelers, the time (in minutes) that each person's trip will take, and then plot the stops as well as the routes on a map.

As you can see, when I extract the stop order from the dictionary I get a list of two ordered sublists. This indicates that the first person should go to Pizzetta and Lamps Plus and the second person should go to Toy Boat, Noah's Bagels, Arguello, Market, and the de Young Museum (in that order). It may seem unfair that one person has to do 4 stops and the other only 2, but as you can see on the map, Pizzetta is much further away from home than the others. The person that makes the two stop trip will spend 53 minutes and the person that makes the four stop trip will spend 68 minutes. 68 minutes is the minimum amount of time that the person with the longer trip takes in any combination ways that these can be partitioned. 

In the map, the home location is shown in black, and each person's stops are shown in a different color. Stops are labeled with the stop name as well as the stop number (showing the order that the stops should be visited by each person).


```python
opt_2_people = optimize_stops_mult(home, stops, num_travelers = 2, stop_labels = stop_labels)
```


```python
for i in opt_2_people['order']:
    print i
```

    ['Pizzetta', 'Lamps Plus']
    ['Toy Boat', "Noah's Bagels", 'Arguello Market', 'de Young Museum']
    


```python
opt_2_people['time']

```




    [53, 68]




```python
points = [[opt_2_people['home_point']]] + opt_2_people['points']
labels = [['Home']] + [[' - '.join((str(i), x)) for i, x in enumerate(l, 1)] for l in opt_2_people['order']]


m1 = plot_stops(points, zoom_level = 14, tiles = 'Stamen Watercolor', labels = labels, line_coords = opt_2_people['lines'])
m1
```




<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe src="data:text/html;base64,CiAgICAgICAgPCFET0NUWVBFIGh0bWw+CiAgICAgICAgPGhlYWQ+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCIgLz4KICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0LzAuNy4zL2xlYWZsZXQuanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMS9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9qcy9ib290c3RyYXAubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5taW4uanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xlYWZsZXQubWFya2VyY2x1c3Rlci8wLjQuMC9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXItc3JjLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvbGVhZmxldC5tYXJrZXJjbHVzdGVyLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC8wLjcuMy9sZWFmbGV0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMS4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvTWFya2VyQ2x1c3Rlci5EZWZhdWx0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC5tYXJrZXJjbHVzdGVyLzAuNC4wL01hcmtlckNsdXN0ZXIuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPgoKICAgICAgICAgICAgaHRtbCwgYm9keSB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjbWFwIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOjA7CiAgICAgICAgICAgICAgICBib3R0b206MDsKICAgICAgICAgICAgICAgIHJpZ2h0OjA7CiAgICAgICAgICAgICAgICBsZWZ0OjA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvc3R5bGU+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPiAjbWFwXzZkNzZlZGM2NjFlNzRmZTVhM2RkMWFlYTUxNTA2NWZhIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uIDogcmVsYXRpdmU7CiAgICAgICAgICAgICAgICB3aWR0aCA6IDEwMC4wJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwLjAlOwogICAgICAgICAgICAgICAgbGVmdDogMC4wJTsKICAgICAgICAgICAgICAgIHRvcDogMC4wJTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L2hlYWQ+CiAgICAgICAgPGJvZHk+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF82ZDc2ZWRjNjYxZTc0ZmU1YTNkZDFhZWE1MTUwNjVmYSIgPjwvZGl2PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvYm9keT4KICAgICAgICA8c2NyaXB0PgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgc291dGhXZXN0ID0gTC5sYXRMbmcoLTkwLCAtMTgwKTsKICAgICAgICAgICAgdmFyIG5vcnRoRWFzdCA9IEwubGF0TG5nKDkwLCAxODApOwogICAgICAgICAgICB2YXIgYm91bmRzID0gTC5sYXRMbmdCb3VuZHMoc291dGhXZXN0LCBub3J0aEVhc3QpOwoKICAgICAgICAgICAgdmFyIG1hcF82ZDc2ZWRjNjYxZTc0ZmU1YTNkZDFhZWE1MTUwNjVmYSA9IEwubWFwKCdtYXBfNmQ3NmVkYzY2MWU3NGZlNWEzZGQxYWVhNTE1MDY1ZmEnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6WzM3Ljc3OTc5MDcxNDMsLTEyMi40NjUyMDY3MTRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnM6IEwuQ1JTLkVQU0czODU3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHRpbGVfbGF5ZXJfOGFhMThhMjkxMzRiNDViNmI3ZGFmYzBkMzBiODE2ZjkgPSBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICdodHRwczovL3N0YW1lbi10aWxlcy17c30uYS5zc2wuZmFzdGx5Lm5ldC93YXRlcmNvbG9yL3t6fS97eH0ve3l9LmpwZycsCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogMTgsCiAgICAgICAgICAgICAgICAgICAgbWluWm9vbTogMSwKICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogJ01hcCB0aWxlcyBieSA8YSBocmVmPSJodHRwOi8vc3RhbWVuLmNvbSI+U3RhbWVuIERlc2lnbjwvYT4sIHVuZGVyIDxhIGhyZWY9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzMuMCI+Q0MgQlkgMy4wPC9hPi4gRGF0YSBieSA8YSBocmVmPSJodHRwOi8vb3BlbnN0cmVldG1hcC5vcmciPk9wZW5TdHJlZXRNYXA8L2E+LCB1bmRlciA8YSBocmVmPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8zLjAiPkNDIEJZIFNBPC9hPi4nLAogICAgICAgICAgICAgICAgICAgIGRldGVjdFJldGluYTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF82ZDc2ZWRjNjYxZTc0ZmU1YTNkZDFhZWE1MTUwNjVmYSk7CgogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfNzEzODcwNTAxOTA0NGU3N2I2MjE0MDg3ZmU3ZWE3M2EgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NzkxMSwtMTIyLjQ2NDE4OF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzZkNzZlZGM2NjFlNzRmZTVhM2RkMWFlYTUxNTA2NWZhKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzY1NmUwN2FmNzU0ZjQ1OGM4ZjI2OGQzNjE3MjkyM2MwID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibGFjaycsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl83MTM4NzA1MDE5MDQ0ZTc3YjYyMTQwODdmZTdlYTczYS5zZXRJY29uKGljb25fNjU2ZTA3YWY3NTRmNDU4YzhmMjY4ZDM2MTcyOTIzYzApOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85ZWNlYTQzY2M1YjA0MGQ3OWIwYTRlZjZhMGY4MmVjZCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9kZTRlYTgyMmI3MGM0NDQ3YmU2ODZiN2E3MWFmMWEwNyA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfZGU0ZWE4MjJiNzBjNDQ0N2JlNjg2YjdhNzFhZjFhMDciICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIEhvbWU8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfOWVjZWE0M2NjNWIwNDBkNzliMGE0ZWY2YTBmODJlY2Quc2V0Q29udGVudChodG1sX2RlNGVhODIyYjcwYzQ0NDdiZTY4NmI3YTcxYWYxYTA3KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNzEzODcwNTAxOTA0NGU3N2I2MjE0MDg3ZmU3ZWE3M2EuYmluZFBvcHVwKHBvcHVwXzllY2VhNDNjYzViMDQwZDc5YjBhNGVmNmEwZjgyZWNkKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfMGFjNTEyOWUzN2ZiNDhjNjk2ZmViMjE2ZTk2ZTE2ZWYgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODM3MDcsLTEyMi40ODMwMDJdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF82ZDc2ZWRjNjYxZTc0ZmU1YTNkZDFhZWE1MTUwNjVmYSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8yYzYwYTQyYjI3OWE0Nzc1YThjNmY5ZmE3YjliMmNhZSA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8wYWM1MTI5ZTM3ZmI0OGM2OTZmZWIyMTZlOTZlMTZlZi5zZXRJY29uKGljb25fMmM2MGE0MmIyNzlhNDc3NWE4YzZmOWZhN2I5YjJjYWUpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9lMzRiYjgxNmQ0YTc0OWI2ODRkYzM0MGYzZTEwMWUzNCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8zOTdhYTU0NzA3YzI0MjI4OGJiN2Q0ZWNjMmRhNWE5OSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfMzk3YWE1NDcwN2MyNDIyODhiYjdkNGVjYzJkYTVhOTkiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDEgLSBQaXp6ZXR0YTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9lMzRiYjgxNmQ0YTc0OWI2ODRkYzM0MGYzZTEwMWUzNC5zZXRDb250ZW50KGh0bWxfMzk3YWE1NDcwN2MyNDIyODhiYjdkNGVjYzJkYTVhOTkpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl8wYWM1MTI5ZTM3ZmI0OGM2OTZmZWIyMTZlOTZlMTZlZi5iaW5kUG9wdXAocG9wdXBfZTM0YmI4MTZkNGE3NDliNjg0ZGMzNDBmM2UxMDFlMzQpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl83ODIyMmNmM2E0MWE0ZGZmOGFhYWViYWEzZjUxOTQyNSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc4MTEzMiwtMTIyLjQ2OTk1NV0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzZkNzZlZGM2NjFlNzRmZTVhM2RkMWFlYTUxNTA2NWZhKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uXzdhZmUzYjIyZDhmYzRmNGNhNzYxNzQzNmYzMGM5NDhiID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzc4MjIyY2YzYTQxYTRkZmY4YWFhZWJhYTNmNTE5NDI1LnNldEljb24oaWNvbl83YWZlM2IyMmQ4ZmM0ZjRjYTc2MTc0MzZmMzBjOTQ4Yik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzI4NDdhZGM2NTBiOTQ3NjhiM2FiNjY3YmNjYjIxZGM3ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2E2MjhkNDNmYjEwMzRlMDBiM2RkNWE1MGFlNmQ1MjRmID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9hNjI4ZDQzZmIxMDM0ZTAwYjNkZDVhNTBhZTZkNTI0ZiIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgMiAtIExhbXBzIFBsdXM8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMjg0N2FkYzY1MGI5NDc2OGIzYWI2NjdiY2NiMjFkYzcuc2V0Q29udGVudChodG1sX2E2MjhkNDNmYjEwMzRlMDBiM2RkNWE1MGFlNmQ1MjRmKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNzgyMjJjZjNhNDFhNGRmZjhhYWFlYmFhM2Y1MTk0MjUuYmluZFBvcHVwKHBvcHVwXzI4NDdhZGM2NTBiOTQ3NjhiM2FiNjY3YmNjYjIxZGM3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfY2MwZDJiZWViNzBjNDUwZmJjYmQ2ZTExY2VkNzE0N2EgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODI3ODQsLTEyMi40NjM1MDldLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF82ZDc2ZWRjNjYxZTc0ZmU1YTNkZDFhZWE1MTUwNjVmYSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8yYjY2ZTg3ODZjMTY0ZGY3YWVlMTNlODMyZGY4ODQzMyA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncmVkJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2NjMGQyYmVlYjcwYzQ1MGZiY2JkNmUxMWNlZDcxNDdhLnNldEljb24oaWNvbl8yYjY2ZTg3ODZjMTY0ZGY3YWVlMTNlODMyZGY4ODQzMyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2EzNjgxNTE3NDIwZDRlZDNhZWI3NjNhZTY1ODYzMGMyID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzhjMGU5Y2ZlZDBkNzQyODFiYjRiNjZmMDU4MGJiYjZjID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF84YzBlOWNmZWQwZDc0MjgxYmI0YjY2ZjA1ODBiYmI2YyIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgMSAtIFRveSBCb2F0PC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2EzNjgxNTE3NDIwZDRlZDNhZWI3NjNhZTY1ODYzMGMyLnNldENvbnRlbnQoaHRtbF84YzBlOWNmZWQwZDc0MjgxYmI0YjY2ZjA1ODBiYmI2Yyk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2NjMGQyYmVlYjcwYzQ1MGZiY2JkNmUxMWNlZDcxNDdhLmJpbmRQb3B1cChwb3B1cF9hMzY4MTUxNzQyMGQ0ZWQzYWViNzYzYWU2NTg2MzBjMik7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzUyZjkxOGFiNDk5MTRjNDNhOTI2NTI5ZWVlZDEyYjNmID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzg2MjA1LC0xMjIuNDUxODQzXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfNmQ3NmVkYzY2MWU3NGZlNWEzZGQxYWVhNTE1MDY1ZmEpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fZDczY2NmNTI1MDczNDM1NjlhZmJiNTg3OWY1YTIxZGUgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl81MmY5MThhYjQ5OTE0YzQzYTkyNjUyOWVlZWQxMmIzZi5zZXRJY29uKGljb25fZDczY2NmNTI1MDczNDM1NjlhZmJiNTg3OWY1YTIxZGUpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9hYTVmMTc5ODZmYTA0NzEzOGU1M2Q2OGNjNTdmZjczMyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF84YjAyNWJhZGU2MTI0ZTMyYTE0YWRmYzAzN2ZjMTI4MCA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfOGIwMjViYWRlNjEyNGUzMmExNGFkZmMwMzdmYzEyODAiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDIgLSBOb2FoJiMzOTtzIEJhZ2VsczwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF9hYTVmMTc5ODZmYTA0NzEzOGU1M2Q2OGNjNTdmZjczMy5zZXRDb250ZW50KGh0bWxfOGIwMjViYWRlNjEyNGUzMmExNGFkZmMwMzdmYzEyODApOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl81MmY5MThhYjQ5OTE0YzQzYTkyNjUyOWVlZWQxMmIzZi5iaW5kUG9wdXAocG9wdXBfYWE1ZjE3OTg2ZmEwNDcxMzhlNTNkNjhjYzU3ZmY3MzMpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl9hMzk5NDE4ZjkyMzI0MzI2OTEwMDkyMThiZTc4MmE0OCA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc3NTU4MSwtMTIyLjQ1ODMzNl0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzZkNzZlZGM2NjFlNzRmZTVhM2RkMWFlYTUxNTA2NWZhKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2Q3NTg1ZDhmNTE0MDQ2YTM5NjdhMTA2NmQxZDI1NDliID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfYTM5OTQxOGY5MjMyNDMyNjkxMDA5MjE4YmU3ODJhNDguc2V0SWNvbihpY29uX2Q3NTg1ZDhmNTE0MDQ2YTM5NjdhMTA2NmQxZDI1NDliKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNmI0ZDk5NjA3MTZhNGZiYTgyNzY3ZjMxNjM5NDgzMWEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNmFhYzBhYjlhNTlmNGE1ZWJjNzJkNmI0NDc1M2VjZDIgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzZhYWMwYWI5YTU5ZjRhNWViYzcyZDZiNDQ3NTNlY2QyIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAzIC0gQXJndWVsbG8gTWFya2V0PC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzZiNGQ5OTYwNzE2YTRmYmE4Mjc2N2YzMTYzOTQ4MzFhLnNldENvbnRlbnQoaHRtbF82YWFjMGFiOWE1OWY0YTVlYmM3MmQ2YjQ0NzUzZWNkMik7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2EzOTk0MThmOTIzMjQzMjY5MTAwOTIxOGJlNzgyYTQ4LmJpbmRQb3B1cChwb3B1cF82YjRkOTk2MDcxNmE0ZmJhODI3NjdmMzE2Mzk0ODMxYSk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzM4NmNkMTU0ZDk3ZTQyZjdhMjc1YzE3OWNkMzcyNmZlID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzcwMDE2LC0xMjIuNDY1NjE0XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfNmQ3NmVkYzY2MWU3NGZlNWEzZGQxYWVhNTE1MDY1ZmEpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fMGM5MDc5MGZiZWI1NGM3Nzg0NTgzZWM1YzBiZDY4ZDAgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8zODZjZDE1NGQ5N2U0MmY3YTI3NWMxNzljZDM3MjZmZS5zZXRJY29uKGljb25fMGM5MDc5MGZiZWI1NGM3Nzg0NTgzZWM1YzBiZDY4ZDApOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF82ZGYwOTU3OGY0NmY0ZTYzYjFlZjJkNTIwMzRmOGFlMiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9kNTcyZTU4NjEzOTY0NTNlYmM1NDc4ZDQ0YjEwNjIyZSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfZDU3MmU1ODYxMzk2NDUzZWJjNTQ3OGQ0NGIxMDYyMmUiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDQgLSBkZSBZb3VuZyBNdXNldW08L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNmRmMDk1NzhmNDZmNGU2M2IxZWYyZDUyMDM0ZjhhZTIuc2V0Q29udGVudChodG1sX2Q1NzJlNTg2MTM5NjQ1M2ViYzU0NzhkNDRiMTA2MjJlKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfMzg2Y2QxNTRkOTdlNDJmN2EyNzVjMTc5Y2QzNzI2ZmUuYmluZFBvcHVwKHBvcHVwXzZkZjA5NTc4ZjQ2ZjRlNjNiMWVmMmQ1MjAzNGY4YWUyKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBwb2x5X2xpbmVfYTUwMTNhZDRlNzM4NDUyMTlkZDIyOTQ3ZDVhN2UzNzcgPSBMLnBvbHlsaW5lKAogICAgICAgICAgICAgICAgICAgIFtbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF0sIFszNy43ODA1MjksIC0xMjIuNDY0MjY0XSwgWzM3Ljc4MDk2NywgLTEyMi40NjQyOTVdLCBbMzcuNzgwOTE4LCAtMTIyLjQ2NTM2M10sIFszNy43ODA5MDIsIC0xMjIuNDY1NzE0XSwgWzM3Ljc4MDg2OCwgLTEyMi40NjY0MzldLCBbMzcuNzgwODUzLCAtMTIyLjQ2Njc5XSwgWzM3Ljc4MDgyMiwgLTEyMi40Njc1MDddLCBbMzcuNzgwNzczLCAtMTIyLjQ2ODU3NV0sIFszNy43ODA3MjMsIC0xMjIuNDY5NjUxXSwgWzM3Ljc4MDcwOCwgLTEyMi40NzAwMjVdLCBbMzcuNzgwNjczLCAtMTIyLjQ3MDcxOV0sIFszNy43ODA2NTgsIC0xMjIuNDcxMDkzXSwgWzM3Ljc4MDYyOCwgLTEyMi40NzE3OTVdLCBbMzcuNzgwNjE2LCAtMTIyLjQ3MTk4NV0sIFszNy43ODA2MDksIC0xMjIuNDcyMTc2XSwgWzM3Ljc4MDYwNSwgLTEyMi40NzIyNTJdLCBbMzcuNzgwNzI3LCAtMTIyLjQ3MjI2OF0sIFszNy43ODA3MTksIC0xMjIuNDcyNDA1XSwgWzM3Ljc4MDcxOSwgLTEyMi40NzI0ODldLCBbMzcuNzgwNywgLTEyMi40NzI4N10sIFszNy43ODA2NywgLTEyMi40NzM1MDRdLCBbMzcuNzgwNjUxLCAtMTIyLjQ3Mzk5Ml0sIFszNy43ODA1OTcsIC0xMjIuNDc1MTEzXSwgWzM3Ljc4MDU1MSwgLTEyMi40NzYxODldLCBbMzcuNzgwNTEzLCAtMTIyLjQ3NjkzN10sIFszNy43ODA1MDIsIC0xMjIuNDc3MjU3XSwgWzM3Ljc4MDQ2NywgLTEyMi40Nzc5NzRdLCBbMzcuNzgwNDUyLCAtMTIyLjQ3ODMzM10sIFszNy43ODA0MDMsIC0xMjIuNDc5NDAxXSwgWzM3Ljc4MDM1NywgLTEyMi40ODA0NzddLCBbMzcuNzgwMzI2LCAtMTIyLjQ4MTEzM10sIFszNy43ODAzMDcsIC0xMjIuNDgxNTQ1XSwgWzM3Ljc4MDI3NywgLTEyMi40ODIyMzldLCBbMzcuNzgwMjU4LCAtMTIyLjQ4MjYxM10sIFszNy43ODE3MzgsIC0xMjIuNDgyNzJdLCBbMzcuNzgyMTE5LCAtMTIyLjQ4Mjc1XSwgWzM3Ljc4MzcxOCwgLTEyMi40ODI5MDNdLCBbMzcuNzgzNzE4LCAtMTIyLjQ4MjkwM10sIFszNy43ODIxMTksIC0xMjIuNDgyNzVdLCBbMzcuNzgyMTY5LCAtMTIyLjQ4MTY3NV0sIFszNy43ODIyMTUsIC0xMjIuNDgwNjA3XSwgWzM3Ljc4MjI2NCwgLTEyMi40Nzk1MzFdLCBbMzcuNzgyMzE0LCAtMTIyLjQ3ODQ2M10sIFszNy43ODIzNjMsIC0xMjIuNDc3Mzk1XSwgWzM3Ljc4MjQwOSwgLTEyMi40NzYzMTldLCBbMzcuNzgyNDU5LCAtMTIyLjQ3NTI1MV0sIFszNy43ODI1MTIsIC0xMjIuNDc0MTI5XSwgWzM3Ljc4MjU2NiwgLTEyMi40NzMwMDhdLCBbMzcuNzgyNTg1LCAtMTIyLjQ3MjU0Ml0sIFszNy43ODI1OTIsIC0xMjIuNDcyMzk3XSwgWzM3Ljc4MjYwNCwgLTEyMi40NzIxXSwgWzM3Ljc4MjYxMSwgLTEyMi40NzE5MzJdLCBbMzcuNzgyNjYxLCAtMTIyLjQ3MDg2NF0sIFszNy43ODI3MDcsIC0xMjIuNDY5Nzg4XSwgWzM3Ljc4MjM4MiwgLTEyMi40Njk3NjVdLCBbMzcuNzgxMTUsIC0xMjIuNDY5NzA0XSwgWzM3Ljc4MTE1LCAtMTIyLjQ2OTcwNF0sIFszNy43ODA4NDUsIC0xMjIuNDY5NjU4XSwgWzM3Ljc4MDcyMywgLTEyMi40Njk2NTFdLCBbMzcuNzgwNzczLCAtMTIyLjQ2ODU3NV0sIFszNy43ODA4MjIsIC0xMjIuNDY3NTA3XSwgWzM3Ljc4MDg1MywgLTEyMi40NjY3OV0sIFszNy43ODA4NjgsIC0xMjIuNDY2NDM5XSwgWzM3Ljc4MDkwMiwgLTEyMi40NjU3MTRdLCBbMzcuNzgwOTE4LCAtMTIyLjQ2NTM2M10sIFszNy43ODA5NjcsIC0xMjIuNDY0Mjk1XSwgWzM3Ljc4MDUyOSwgLTEyMi40NjQyNjRdLCBbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF1dLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcF82ZDc2ZWRjNjYxZTc0ZmU1YTNkZDFhZWE1MTUwNjVmYS5hZGRMYXllcihwb2x5X2xpbmVfYTUwMTNhZDRlNzM4NDUyMTlkZDIyOTQ3ZDVhN2UzNzcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgcG9seV9saW5lXzdlNTJjZjNiOTY5NDRiYThiNjIyYTMzNTNmZTk0NDU5ID0gTC5wb2x5bGluZSgKICAgICAgICAgICAgICAgICAgICBbWzM3Ljc3OTEwNiwgLTEyMi40NjQxNThdLCBbMzcuNzgwNTI5LCAtMTIyLjQ2NDI2NF0sIFszNy43ODA5NjcsIC0xMjIuNDY0Mjk1XSwgWzM3Ljc4MTA4OSwgLTEyMi40NjQzMDNdLCBbMzcuNzgxMTM5LCAtMTIyLjQ2MzIzNF0sIFszNy43ODE1MzksIC0xMjIuNDYzMjY1XSwgWzM3Ljc4Mjc5MSwgLTEyMi40NjM0MDJdLCBbMzcuNzgyNzkxLCAtMTIyLjQ2MzQwMl0sIFszNy43ODMsIC0xMjIuNDYzMzcyXSwgWzM3Ljc4NDg2NiwgLTEyMi40NjM1MDFdLCBbMzcuNzg1MTM3LCAtMTIyLjQ2MzUyNF0sIFszNy43ODUyNzQsIC0xMjIuNDYyNDU2XSwgWzM3Ljc4NTQwOCwgLTEyMi40NjEzOTZdLCBbMzcuNzg1NTQ1LCAtMTIyLjQ2MDMyOF0sIFszNy43ODU2ODYsIC0xMjIuNDU5MjE0XSwgWzM3Ljc4NTgzMSwgLTEyMi40NTgwNjldLCBbMzcuNzg1OTcyLCAtMTIyLjQ1Njk3OF0sIFszNy43ODYwMDMsIC0xMjIuNDU2NzExXSwgWzM3Ljc4NjEwOSwgLTEyMi40NTU4ODddLCBbMzcuNzg2MjEyLCAtMTIyLjQ1NTA2M10sIFszNy43ODYyNTEsIC0xMjIuNDU0Nzg5XSwgWzM3Ljc4NjMxMiwgLTEyMi40NTQzXSwgWzM3Ljc4NjM4OCwgLTEyMi40NTM2OThdLCBbMzcuNzg2NDE4LCAtMTIyLjQ1MzQyM10sIFszNy43ODY0MywgLTEyMi40NTMzMjRdLCBbMzcuNzg2NjI0LCAtMTIyLjQ1MTc3NV0sIFszNy43ODY0NzYsIC0xMjIuNDUxNzQ1XSwgWzM3Ljc4NjIzOSwgLTEyMi40NTE2OTldLCBbMzcuNzg2MjM5LCAtMTIyLjQ1MTY5OV0sIFszNy43ODU5MzQsIC0xMjIuNDUxNjNdLCBbMzcuNzg1OTM0LCAtMTIyLjQ1MTYzOF0sIFszNy43ODU4NzcsIC0xMjIuNDUyMDhdLCBbMzcuNzg1NzcsIC0xMjIuNDUyOTJdLCBbMzcuNzg1NzI0LCAtMTIyLjQ1MzI3OF0sIFszNy43ODU3MTcsIC0xMjIuNDUzMzc3XSwgWzM3Ljc4NTcxMywgLTEyMi40NTM0MzFdLCBbMzcuNzg1NzA1LCAtMTIyLjQ1MzQ5OV0sIFszNy43ODU2OTQsIC0xMjIuNDUzNTZdLCBbMzcuNzg1NjgyLCAtMTIyLjQ1MzYxNF0sIFszNy43ODU2NTksIC0xMjIuNDUzNjZdLCBbMzcuNzg1NjMzLCAtMTIyLjQ1MzY5OF0sIFszNy43ODU1OTQsIC0xMjIuNDUzNzI4XSwgWzM3Ljc4NTU1NiwgLTEyMi40NTM3NTFdLCBbMzcuNzg1NTExLCAtMTIyLjQ1Mzc1OV0sIFszNy43ODU0NjUsIC0xMjIuNDUzNzU5XSwgWzM3Ljc4NTM1OCwgLTEyMi40NTM3NTldLCBbMzcuNzg1MjM2LCAtMTIyLjQ1Mzc1OV0sIFszNy43ODUxMDYsIC0xMjIuNDUzNzUxXSwgWzM3Ljc4NDk3NiwgLTEyMi40NTM3NTFdLCBbMzcuNzg0ODUxLCAtMTIyLjQ1Mzc0M10sIFszNy43ODQ3MzIsIC0xMjIuNDUzNzM2XSwgWzM3Ljc4NDYxNCwgLTEyMi40NTM3MjhdLCBbMzcuNzg0NDk2LCAtMTIyLjQ1MzcxM10sIFszNy43ODQzNzgsIC0xMjIuNDUzNjk4XSwgWzM3Ljc4NDI2NywgLTEyMi40NTM2ODJdLCBbMzcuNzg0MTY4LCAtMTIyLjQ1MzY2N10sIFszNy43ODQwNTcsIC0xMjIuNDUzNjUyXSwgWzM3Ljc4Mzk1NCwgLTEyMi40NTM2MzddLCBbMzcuNzgxNzg3LCAtMTIyLjQ1MzIwMl0sIFszNy43ODE2NjksIC0xMjIuNDUzMTc5XSwgWzM3Ljc4MDM2NCwgLTEyMi40NTI5Ml0sIFszNy43ODAyNDIsIC0xMjIuNDUzODk2XSwgWzM3Ljc4MDEyLCAtMTIyLjQ1NDgzNF0sIFszNy43ODAwOTcsIC0xMjIuNDU1MDE4XSwgWzM3Ljc4MDAzNiwgLTEyMi40NTU0OTFdLCBbMzcuNzgwMDI5LCAtMTIyLjQ1NTU1OV0sIFszNy43ODAwMTcsIC0xMjIuNDU1NjJdLCBbMzcuNzgwMDA2LCAtMTIyLjQ1NTY4MV0sIFszNy43Nzk5OTEsIC0xMjIuNDU1NzM1XSwgWzM3Ljc3OTk0NSwgLTEyMi40NTU4NTddLCBbMzcuNzc5ODk5LCAtMTIyLjQ1NTk4N10sIFszNy43Nzk4MDgsIC0xMjIuNDU2MjM4XSwgWzM3Ljc3OTcwOCwgLTEyMi40NTY1MTNdLCBbMzcuNzc5NjcsIC0xMjIuNDU2NjEyXSwgWzM3Ljc3OTY0NCwgLTEyMi40NTY2ODhdLCBbMzcuNzc5NjIxLCAtMTIyLjQ1Njc1N10sIFszNy43Nzk2MDUsIC0xMjIuNDU2ODMzXSwgWzM3Ljc3OTU5NCwgLTEyMi40NTY5MDJdLCBbMzcuNzc5NTc5LCAtMTIyLjQ1NzAwMV0sIFszNy43Nzk0NjgsIC0xMjIuNDU2OTc4XSwgWzM3Ljc3OTQwNywgLTEyMi40NTY5NzFdLCBbMzcuNzc5MzgsIC0xMjIuNDU2OTcxXSwgWzM3Ljc3OTM1LCAtMTIyLjQ1Njk3MV0sIFszNy43NzkzMTksIC0xMjIuNDU2OTc4XSwgWzM3Ljc3OTI5MywgLTEyMi40NTY5OTRdLCBbMzcuNzc5MjUxLCAtMTIyLjQ1NzAxNl0sIFszNy43NzkyMTYsIC0xMjIuNDU3MDU1XSwgWzM3Ljc3OTE3NCwgLTEyMi40NTcxXSwgWzM3Ljc3OTEzMiwgLTEyMi40NTcxNDZdLCBbMzcuNzc5MDk4LCAtMTIyLjQ1NzE5Ml0sIFszNy43NzkwNzEsIC0xMjIuNDU3MjNdLCBbMzcuNzc5MDU2LCAtMTIyLjQ1NzI2MV0sIFszNy43NzkwMzMsIC0xMjIuNDU3MzIyXSwgWzM3Ljc3OTAxNCwgLTEyMi40NTczNzVdLCBbMzcuNzc4OTQ1LCAtMTIyLjQ1NzkzMl0sIFszNy43Nzg5MzgsIC0xMjIuNDU3OTddLCBbMzcuNzc4OTMsIC0xMjIuNDU4MDA4XSwgWzM3Ljc3ODkxNSwgLTEyMi40NTgwNTRdLCBbMzcuNzc4ODkyLCAtMTIyLjQ1ODA5Ml0sIFszNy43Nzg4NzMsIC0xMjIuNDU4MTA3XSwgWzM3Ljc3ODg1LCAtMTIyLjQ1ODEyM10sIFszNy43Nzg4MjcsIC0xMjIuNDU4MTNdLCBbMzcuNzc4Nzk3LCAtMTIyLjQ1ODEyM10sIFszNy43Nzg3MjgsIC0xMjIuNDU4MTNdLCBbMzcuNzc4MDkxLCAtMTIyLjQ1ODAwMV0sIFszNy43NzgwMTEsIC0xMjIuNDU4NjU3XSwgWzM3Ljc3NzczNiwgLTEyMi40NTg2NDJdLCBbMzcuNzc3NTk1LCAtMTIyLjQ1ODYzNF0sIFszNy43NzcyODYsIC0xMjIuNDU4NjExXSwgWzM3Ljc3NzEyNiwgLTEyMi40NTg1OTZdLCBbMzcuNzc2ODQ0LCAtMTIyLjQ1ODU3M10sIFszNy43NzYxODcsIC0xMjIuNDU4NTI3XSwgWzM3Ljc3NjExOSwgLTEyMi40NTg1MjddLCBbMzcuNzc1NjE1LCAtMTIyLjQ1ODQ4OV0sIFszNy43NzU1NjksIC0xMjIuNDU4NTA0XSwgWzM3Ljc3NTU2OSwgLTEyMi40NTg1MDRdLCBbMzcuNzc1MjQ1LCAtMTIyLjQ1ODQ1OF0sIFszNy43NzQ5ODIsIC0xMjIuNDU4NDQzXSwgWzM3Ljc3NDcwMywgLTEyMi40NTg0Ml0sIFszNy43NzQ0MSwgLTEyMi40NTg0MDVdLCBbMzcuNzc0Mjk5LCAtMTIyLjQ1ODM5XSwgWzM3Ljc3NDI5OSwgLTEyMi40NTg0NThdLCBbMzcuNzc0Mjk5LCAtMTIyLjQ1ODUxMl0sIFszNy43NzQxMzksIC0xMjIuNDU4NDk3XSwgWzM3Ljc3NDAwMiwgLTEyMi40NTg1MjddLCBbMzcuNzczODQ1LCAtMTIyLjQ1ODYyNl0sIFszNy43NzM1NzEsIC0xMjIuNDU4ODkzXSwgWzM3Ljc3MzI3MywgLTEyMi40NTkxNTNdLCBbMzcuNzczMjA4LCAtMTIyLjQ1OTE0NV0sIFszNy43NzMxOTMsIC0xMjIuNDU5MjY3XSwgWzM3Ljc3MzE0NywgLTEyMi40NTk2MV0sIFszNy43NzMxMTcsIC0xMjIuNDU5ODI0XSwgWzM3Ljc3MzAzNiwgLTEyMi40NjAzOTZdLCBbMzcuNzczMDE0LCAtMTIyLjQ2MDUxMV0sIFszNy43NzI5ODcsIC0xMjIuNDYwNjE4XSwgWzM3Ljc3Mjk1MywgLTEyMi40NjA3MTddLCBbMzcuNzcyOTE4LCAtMTIyLjQ2MDc5M10sIFszNy43NzI4NzIsIC0xMjIuNDYwODc3XSwgWzM3Ljc3MjgxOSwgLTEyMi40NjA5NDZdLCBbMzcuNzcyNzY2LCAtMTIyLjQ2MDk5OV0sIFszNy43NzI3MiwgLTEyMi40NjEwMzddLCBbMzcuNzcyNjU5LCAtMTIyLjQ2MTA4M10sIFszNy43NzI3MDgsIC0xMjIuNDYxMTQ0XSwgWzM3Ljc3MjY1NSwgLTEyMi40NjExNzVdLCBbMzcuNzcyNTc5LCAtMTIyLjQ2MTIxM10sIFszNy43NzI1NDgsIC0xMjIuNDYxMjI4XSwgWzM3Ljc3MjM5NiwgLTEyMi40NjEzMjddLCBbMzcuNzcyMjc0LCAtMTIyLjQ2MTUxXSwgWzM3Ljc3MjE3OCwgLTEyMi40NjE3MTZdLCBbMzcuNzcyMDgzLCAtMTIyLjQ2MTkzXSwgWzM3Ljc3MTk2NSwgLTEyMi40NjIwOV0sIFszNy43NzE5MDMsIC0xMjIuNDYyMTQzXSwgWzM3Ljc3MTkxNSwgLTEyMi40NjIxODJdLCBbMzcuNzcxOTMsIC0xMjIuNDYyMjU4XSwgWzM3Ljc3MTg4NCwgLTEyMi40NjIyODFdLCBbMzcuNzcxODM5LCAtMTIyLjQ2MjMwNF0sIFszNy43NzE3ODUsIC0xMjIuNDYyMzE5XSwgWzM3Ljc3MTY4NiwgLTEyMi40NjIzNTddLCBbMzcuNzcxNzM5LCAtMTIyLjQ2MjUxXSwgWzM3Ljc3MTY1MiwgLTEyMi40NjI1NzFdLCBbMzcuNzcxNDgsIC0xMjIuNDYyNjU1XSwgWzM3Ljc3MTQ1NywgLTEyMi40NjI3XSwgWzM3Ljc3MTQ0MiwgLTEyMi40NjI4NTNdLCBbMzcuNzcxNDI3LCAtMTIyLjQ2MzA3NF0sIFszNy43NzEyODYsIC0xMjIuNDYzMTJdLCBbMzcuNzcxMjA5LCAtMTIyLjQ2MzI1XSwgWzM3Ljc3MTE3NSwgLTEyMi40NjM1MDldLCBbMzcuNzcxMTcxLCAtMTIyLjQ2MzczOF0sIFszNy43NzExNTYsIC0xMjIuNDYzOTU5XSwgWzM3Ljc3MTExNCwgLTEyMi40NjQxMjddLCBbMzcuNzcxMDE4LCAtMTIyLjQ2NDMxOF0sIFszNy43NzA5MzEsIC0xMjIuNDY0NTc3XSwgWzM3Ljc3MDYyNiwgLTEyMi40NjUwNV0sIFszNy43NzA0MjMsIC0xMjIuNDY1MTA0XSwgWzM3Ljc3MDE5OCwgLTEyMi40NjUyMDNdLCBbMzcuNzcwMTk4LCAtMTIyLjQ2NTIwM10sIFszNy43NzAxOTUsIC0xMjIuNDY1MThdLCBbMzcuNzcwNDIzLCAtMTIyLjQ2NTEwNF0sIFszNy43NzA2MjYsIC0xMjIuNDY1MDVdLCBbMzcuNzcwNzk3LCAtMTIyLjQ2NTEzNF0sIFszNy43NzA5NDYsIC0xMjIuNDY1MTk1XSwgWzM3Ljc3MTA2LCAtMTIyLjQ2NTE4OF0sIFszNy43NzEyMjQsIC0xMjIuNDY1MTg4XSwgWzM3Ljc3MTM2NiwgLTEyMi40NjUxOTVdLCBbMzcuNzcxNTc1LCAtMTIyLjQ2NTI2NF0sIFszNy43NzE3NjYsIC0xMjIuNDY1Mjc5XSwgWzM3Ljc3MTk2NSwgLTEyMi40NjUzMV0sIFszNy43NzIxMTMsIC0xMjIuNDY1MDY2XSwgWzM3Ljc3MjE1OSwgLTEyMi40NjQ5NzRdLCBbMzcuNzcyMTgyLCAtMTIyLjQ2NDgyOV0sIFszNy43NzIyNywgLTEyMi40NjQ3MTVdLCBbMzcuNzcyMzMxLCAtMTIyLjQ2NDY5OV0sIFszNy43NzIzODQsIC0xMjIuNDY0Njg0XSwgWzM3Ljc3MjQ2LCAtMTIyLjQ2NDY1NF0sIFszNy43NzI0MywgLTEyMi40NjQ1MjRdLCBbMzcuNzcyMzk5LCAtMTIyLjQ2NDQwMl0sIFszNy43NzIzNjUsIC0xMjIuNDY0MjcyXSwgWzM3Ljc3MjMwOCwgLTEyMi40NjQwNzRdLCBbMzcuNzcyMzY5LCAtMTIyLjQ2NDA0M10sIFszNy43NzI0MywgLTEyMi40NjQwMTNdLCBbMzcuNzcyNTI5LCAtMTIyLjQ2NDAyOF0sIFszNy43NzI2MDksIC0xMjIuNDYzOTk3XSwgWzM3Ljc3Mjg3MiwgLTEyMi40NjM4OThdLCBbMzcuNzcyOTMsIC0xMjIuNDYzODZdLCBbMzcuNzcyOTkxLCAtMTIyLjQ2MzgxNF0sIFszNy43NzMxMDUsIC0xMjIuNDYzNzQ2XSwgWzM3Ljc3MzE4OSwgLTEyMi40NjM3MzhdLCBbMzcuNzczMjgxLCAtMTIyLjQ2MzczOF0sIFszNy43NzM0MDYsIC0xMjIuNDYzNzY5XSwgWzM3Ljc3MzQxNCwgLTEyMi40NjM3MjNdLCBbMzcuNzczNDQ4LCAtMTIyLjQ2MzY2OV0sIFszNy43NzM0OSwgLTEyMi40NjM2NjldLCBbMzcuNzczNTM2LCAtMTIyLjQ2MzY2OV0sIFszNy43NzM2NTEsIC0xMjIuNDYzNjYyXSwgWzM3Ljc3MzYzNSwgLTEyMi40NjM3NjldLCBbMzcuNzc0MiwgLTEyMi40NjM4MDddLCBbMzcuNzc1MzcxLCAtMTIyLjQ2Mzg5MV0sIFszNy43NzU0NTksIC0xMjIuNDYzODk4XSwgWzM3Ljc3NzIzMywgLTEyMi40NjQwMjhdLCBbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF1dLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFwXzZkNzZlZGM2NjFlNzRmZTVhM2RkMWFlYTUxNTA2NWZhLmFkZExheWVyKHBvbHlfbGluZV83ZTUyY2YzYjk2OTQ0YmE4YjYyMmEzMzUzZmU5NDQ1OSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvc2NyaXB0PgogICAgICAgIA==" style="position:absolute;width:100%;height:100%;left:0;top:0;"></iframe></div></div>



I also run the function on the same set of stops, this time specifying bike transportation. As you can see the routes are slightly different, favoring roads that are better for biking. The times are also much shorter (12 and 18 minutes vs 53 and 68).


```python
opt_2_people_bike = optimize_stops_mult(home, stops, num_travelers = 2, stop_labels = stop_labels, costing = 'bicycle')
print opt_2_people_bike['time']
```

    [12, 18]
    


```python
points = [[opt_2_people_bike['home_point']]] + opt_2_people_bike['points']
labels = [['Home']]+[[' - '.join((str(i), x)) for i, x in enumerate(l, 1)] for l in opt_2_people_bike['order']]

m2 = plot_stops(points, zoom_level = 14, tiles = 'Stamen Watercolor', labels = labels, line_coords = opt_2_people_bike['lines'])
m2
```




<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe src="data:text/html;base64,CiAgICAgICAgPCFET0NUWVBFIGh0bWw+CiAgICAgICAgPGhlYWQ+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCIgLz4KICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0LzAuNy4zL2xlYWZsZXQuanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMS9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9qcy9ib290c3RyYXAubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5taW4uanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xlYWZsZXQubWFya2VyY2x1c3Rlci8wLjQuMC9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXItc3JjLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvbGVhZmxldC5tYXJrZXJjbHVzdGVyLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC8wLjcuMy9sZWFmbGV0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMS4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvTWFya2VyQ2x1c3Rlci5EZWZhdWx0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC5tYXJrZXJjbHVzdGVyLzAuNC4wL01hcmtlckNsdXN0ZXIuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPgoKICAgICAgICAgICAgaHRtbCwgYm9keSB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjbWFwIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOjA7CiAgICAgICAgICAgICAgICBib3R0b206MDsKICAgICAgICAgICAgICAgIHJpZ2h0OjA7CiAgICAgICAgICAgICAgICBsZWZ0OjA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvc3R5bGU+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPiAjbWFwXzQwOWQyYWNiYzE3YjQxMWI4OTEwNmIyMGYxYTMwM2U0IHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uIDogcmVsYXRpdmU7CiAgICAgICAgICAgICAgICB3aWR0aCA6IDEwMC4wJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwLjAlOwogICAgICAgICAgICAgICAgbGVmdDogMC4wJTsKICAgICAgICAgICAgICAgIHRvcDogMC4wJTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L2hlYWQ+CiAgICAgICAgPGJvZHk+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNCIgPjwvZGl2PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvYm9keT4KICAgICAgICA8c2NyaXB0PgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgc291dGhXZXN0ID0gTC5sYXRMbmcoLTkwLCAtMTgwKTsKICAgICAgICAgICAgdmFyIG5vcnRoRWFzdCA9IEwubGF0TG5nKDkwLCAxODApOwogICAgICAgICAgICB2YXIgYm91bmRzID0gTC5sYXRMbmdCb3VuZHMoc291dGhXZXN0LCBub3J0aEVhc3QpOwoKICAgICAgICAgICAgdmFyIG1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNCA9IEwubWFwKCdtYXBfNDA5ZDJhY2JjMTdiNDExYjg5MTA2YjIwZjFhMzAzZTQnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6WzM3Ljc3OTc5MDcxNDMsLTEyMi40NjUyMDY3MTRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnM6IEwuQ1JTLkVQU0czODU3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHRpbGVfbGF5ZXJfYWFhZjE5MmIxYjZmNGZkN2JmMTZlODI5NmMxNDZkOTkgPSBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICdodHRwczovL3N0YW1lbi10aWxlcy17c30uYS5zc2wuZmFzdGx5Lm5ldC93YXRlcmNvbG9yL3t6fS97eH0ve3l9LmpwZycsCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogMTgsCiAgICAgICAgICAgICAgICAgICAgbWluWm9vbTogMSwKICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogJ01hcCB0aWxlcyBieSA8YSBocmVmPSJodHRwOi8vc3RhbWVuLmNvbSI+U3RhbWVuIERlc2lnbjwvYT4sIHVuZGVyIDxhIGhyZWY9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzMuMCI+Q0MgQlkgMy4wPC9hPi4gRGF0YSBieSA8YSBocmVmPSJodHRwOi8vb3BlbnN0cmVldG1hcC5vcmciPk9wZW5TdHJlZXRNYXA8L2E+LCB1bmRlciA8YSBocmVmPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8zLjAiPkNDIEJZIFNBPC9hPi4nLAogICAgICAgICAgICAgICAgICAgIGRldGVjdFJldGluYTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNCk7CgogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfMDU2ZTdmMDQzNmI3NDQzZThiOGI2OWM1ZjJmMzQ4NGYgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NzkxMSwtMTIyLjQ2NDE4OF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzQwOWQyYWNiYzE3YjQxMWI4OTEwNmIyMGYxYTMwM2U0KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2ZhZGJhODhjNmZhNjQ1ZmRiYTRlYTA2NWU5MDU3NzM4ID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibGFjaycsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8wNTZlN2YwNDM2Yjc0NDNlOGI4YjY5YzVmMmYzNDg0Zi5zZXRJY29uKGljb25fZmFkYmE4OGM2ZmE2NDVmZGJhNGVhMDY1ZTkwNTc3MzgpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85ZDllNjdjYTg4MjQ0MDI0OGI5YTY3NzU2MTAyM2RlYiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF9lNDgyMjhjNGM1ZDA0YzAyOGM2NTBjNzMyMDAyNmUwMiA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfZTQ4MjI4YzRjNWQwNGMwMjhjNjUwYzczMjAwMjZlMDIiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIEhvbWU8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfOWQ5ZTY3Y2E4ODI0NDAyNDhiOWE2Nzc1NjEwMjNkZWIuc2V0Q29udGVudChodG1sX2U0ODIyOGM0YzVkMDRjMDI4YzY1MGM3MzIwMDI2ZTAyKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfMDU2ZTdmMDQzNmI3NDQzZThiOGI2OWM1ZjJmMzQ4NGYuYmluZFBvcHVwKHBvcHVwXzlkOWU2N2NhODgyNDQwMjQ4YjlhNjc3NTYxMDIzZGViKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfODdiOWIzNjk0Yzg0NGJjZmJjNzBkMWEwY2JlMzdjMWIgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODExMzIsLTEyMi40Njk5NTVdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNCk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl84M2FiYTQ3ZTZmMjU0NzEyOTU1ZDE1YjIxNDQyYjhkOSA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl84N2I5YjM2OTRjODQ0YmNmYmM3MGQxYTBjYmUzN2MxYi5zZXRJY29uKGljb25fODNhYmE0N2U2ZjI1NDcxMjk1NWQxNWIyMTQ0MmI4ZDkpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9mNmQwM2NlMDg1Y2Q0MThjYTU3NjdhMDAwNWQ0MDZiNCA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yMDg2ODg0NzViYTY0MDY5ODhiYzI2NjE0YzM4ZmUyYSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfMjA4Njg4NDc1YmE2NDA2OTg4YmMyNjYxNGMzOGZlMmEiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDEgLSBMYW1wcyBQbHVzPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2Y2ZDAzY2UwODVjZDQxOGNhNTc2N2EwMDA1ZDQwNmI0LnNldENvbnRlbnQoaHRtbF8yMDg2ODg0NzViYTY0MDY5ODhiYzI2NjE0YzM4ZmUyYSk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzg3YjliMzY5NGM4NDRiY2ZiYzcwZDFhMGNiZTM3YzFiLmJpbmRQb3B1cChwb3B1cF9mNmQwM2NlMDg1Y2Q0MThjYTU3NjdhMDAwNWQ0MDZiNCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzYxNmI1YTU4NjkzOTQwMWJhNDIxNDkwMDY3M2ZhZDU2ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzgzNzA3LC0xMjIuNDgzMDAyXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfNDA5ZDJhY2JjMTdiNDExYjg5MTA2YjIwZjFhMzAzZTQpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fMTgyMzJjOWMyZWZiNDgyYTg0ZTJkMzA0ZjQ4YzUwNDcgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2JsdWUnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfNjE2YjVhNTg2OTM5NDAxYmE0MjE0OTAwNjczZmFkNTYuc2V0SWNvbihpY29uXzE4MjMyYzljMmVmYjQ4MmE4NGUyZDMwNGY0OGM1MDQ3KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfMGVmNzJmMDBmMGJhNGRkZGEwNjg4NTM0ZjgwZmQ3YjEgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfMjQ4NmEwNDQ5YWRkNGE0OGJhMTY2N2EyNTMzZTNjZmIgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzI0ODZhMDQ0OWFkZDRhNDhiYTE2NjdhMjUzM2UzY2ZiIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAyIC0gUGl6emV0dGE8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfMGVmNzJmMDBmMGJhNGRkZGEwNjg4NTM0ZjgwZmQ3YjEuc2V0Q29udGVudChodG1sXzI0ODZhMDQ0OWFkZDRhNDhiYTE2NjdhMjUzM2UzY2ZiKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNjE2YjVhNTg2OTM5NDAxYmE0MjE0OTAwNjczZmFkNTYuYmluZFBvcHVwKHBvcHVwXzBlZjcyZjAwZjBiYTRkZGRhMDY4ODUzNGY4MGZkN2IxKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfNTVhYmE4NzE0MDU1NDM0Yzk1MGI0MGI4ZDc2OTg0MDIgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODI3ODQsLTEyMi40NjM1MDldLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNCk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9iMWRhYzc1OGM3MGE0M2JjYTg2Y2EwNmYyYzYyMWQ5YyA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncmVkJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzU1YWJhODcxNDA1NTQzNGM5NTBiNDBiOGQ3Njk4NDAyLnNldEljb24oaWNvbl9iMWRhYzc1OGM3MGE0M2JjYTg2Y2EwNmYyYzYyMWQ5Yyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2IyMTZmMmI0MjI3YzQ4OGNhYjBiMTc0NDkxMzUwOGIwID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzU5NGRlNzkyY2RhNzRiNDk5N2QwOGU0ZGE4MmI1MDg0ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF81OTRkZTc5MmNkYTc0YjQ5OTdkMDhlNGRhODJiNTA4NCIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgMSAtIFRveSBCb2F0PC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2IyMTZmMmI0MjI3YzQ4OGNhYjBiMTc0NDkxMzUwOGIwLnNldENvbnRlbnQoaHRtbF81OTRkZTc5MmNkYTc0YjQ5OTdkMDhlNGRhODJiNTA4NCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzU1YWJhODcxNDA1NTQzNGM5NTBiNDBiOGQ3Njk4NDAyLmJpbmRQb3B1cChwb3B1cF9iMjE2ZjJiNDIyN2M0ODhjYWIwYjE3NDQ5MTM1MDhiMCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2FiYzAwZjU2YzIyMTRiMDBiMzkyMzU3NDljNTRhNjA2ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzg2MjA1LC0xMjIuNDUxODQzXSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfNDA5ZDJhY2JjMTdiNDExYjg5MTA2YjIwZjFhMzAzZTQpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fNWYxNjllODQ4YWVkNGMwYzgwNTNkNzZjZjQ3ZDI0NDcgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9hYmMwMGY1NmMyMjE0YjAwYjM5MjM1NzQ5YzU0YTYwNi5zZXRJY29uKGljb25fNWYxNjllODQ4YWVkNGMwYzgwNTNkNzZjZjQ3ZDI0NDcpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF82ZDBjNDM4MDE5ODc0NTAwYjE0ODNmZTlmODFmNWNmZiA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF81OWUxMjMxYzc2YmM0ZmNlOTE2NjVhOWNhZDY4YzVlMyA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNTllMTIzMWM3NmJjNGZjZTkxNjY1YTljYWQ2OGM1ZTMiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDIgLSBOb2FoJiMzOTtzIEJhZ2VsczwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF82ZDBjNDM4MDE5ODc0NTAwYjE0ODNmZTlmODFmNWNmZi5zZXRDb250ZW50KGh0bWxfNTllMTIzMWM3NmJjNGZjZTkxNjY1YTljYWQ2OGM1ZTMpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9hYmMwMGY1NmMyMjE0YjAwYjM5MjM1NzQ5YzU0YTYwNi5iaW5kUG9wdXAocG9wdXBfNmQwYzQzODAxOTg3NDUwMGIxNDgzZmU5ZjgxZjVjZmYpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl8zMmM1ZGVlMTA3ZWE0OWQ4YTZmMjQxNzZjZGQxOTE5ZCA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc3NTU4MSwtMTIyLjQ1ODMzNl0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwXzQwOWQyYWNiYzE3YjQxMWI4OTEwNmIyMGYxYTMwM2U0KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2Q2NDk1M2FkMTU5NjQzYjQ5MzY3ZGVhOWNiMTc2MmJkID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfMzJjNWRlZTEwN2VhNDlkOGE2ZjI0MTc2Y2RkMTkxOWQuc2V0SWNvbihpY29uX2Q2NDk1M2FkMTU5NjQzYjQ5MzY3ZGVhOWNiMTc2MmJkKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNTkyNjM2Y2ZjZmYwNGFlYWFiN2MxZTg5MDgwNzIyY2MgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfNjViYzIzODlmNGQ3NDMxZWJlMWQxZmFhOWE5MWI1ZjggPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzY1YmMyMzg5ZjRkNzQzMWViZTFkMWZhYTlhOTFiNWY4IiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAzIC0gQXJndWVsbG8gTWFya2V0PC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzU5MjYzNmNmY2ZmMDRhZWFhYjdjMWU4OTA4MDcyMmNjLnNldENvbnRlbnQoaHRtbF82NWJjMjM4OWY0ZDc0MzFlYmUxZDFmYWE5YTkxYjVmOCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzMyYzVkZWUxMDdlYTQ5ZDhhNmYyNDE3NmNkZDE5MTlkLmJpbmRQb3B1cChwb3B1cF81OTI2MzZjZmNmZjA0YWVhYWI3YzFlODkwODA3MjJjYyk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyXzczY2JiNzI4Yzg5ZTRlYzlhMzEwOTJmNWQyOWZiNDI5ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzcwMDE2LC0xMjIuNDY1NjE0XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfNDA5ZDJhY2JjMTdiNDExYjg5MTA2YjIwZjFhMzAzZTQpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fN2M4ZDM3ZGE5MDE3NGE5N2IyOWYwYmRkMTdiNzQzMTMgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ3JlZCcsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl83M2NiYjcyOGM4OWU0ZWM5YTMxMDkyZjVkMjlmYjQyOS5zZXRJY29uKGljb25fN2M4ZDM3ZGE5MDE3NGE5N2IyOWYwYmRkMTdiNzQzMTMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85YzU1ZWVjZTI3MGE0OTc3ODU1ZjNmNjc4ZDRhMzBlYyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF8yMmNjZTNkMTZhNDI0OTRkYTQyMGM3NDA3YWYzYWM2MiA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfMjJjY2UzZDE2YTQyNDk0ZGE0MjBjNzQwN2FmM2FjNjIiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDQgLSBkZSBZb3VuZyBNdXNldW08L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfOWM1NWVlY2UyNzBhNDk3Nzg1NWYzZjY3OGQ0YTMwZWMuc2V0Q29udGVudChodG1sXzIyY2NlM2QxNmE0MjQ5NGRhNDIwYzc0MDdhZjNhYzYyKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfNzNjYmI3MjhjODllNGVjOWEzMTA5MmY1ZDI5ZmI0MjkuYmluZFBvcHVwKHBvcHVwXzljNTVlZWNlMjcwYTQ5Nzc4NTVmM2Y2NzhkNGEzMGVjKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBwb2x5X2xpbmVfYjlhMjRjMWZjOGU1NGY0YmIwNDU1ZTBmNGYxODRhNGUgPSBMLnBvbHlsaW5lKAogICAgICAgICAgICAgICAgICAgIFtbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF0sIFszNy43NzkwNTYsIC0xMjIuNDY1MjMzXSwgWzM3Ljc3OTAwNiwgLTEyMi40NjYzMDFdLCBbMzcuNzc4OTU3LCAtMTIyLjQ2NzM3N10sIFszNy43Nzg5MDcsIC0xMjIuNDY4NDQ1XSwgWzM3Ljc3ODg2MSwgLTEyMi40Njk1MTNdLCBbMzcuNzgwNzIzLCAtMTIyLjQ2OTY1MV0sIFszNy43ODA4NDUsIC0xMjIuNDY5NjU4XSwgWzM3Ljc4MTE1LCAtMTIyLjQ2OTcwNF0sIFszNy43ODExNSwgLTEyMi40Njk3MDRdLCBbMzcuNzgyMzgyLCAtMTIyLjQ2OTc2NV0sIFszNy43ODI3MDcsIC0xMjIuNDY5Nzg4XSwgWzM3Ljc4MjY2MSwgLTEyMi40NzA4NjRdLCBbMzcuNzgyNjExLCAtMTIyLjQ3MTkzMl0sIFszNy43ODI2MDQsIC0xMjIuNDcyMV0sIFszNy43ODI1OTIsIC0xMjIuNDcyMzk3XSwgWzM3Ljc4MjU4NSwgLTEyMi40NzI1NDJdLCBbMzcuNzgyNTY2LCAtMTIyLjQ3MzAwOF0sIFszNy43ODI1MTIsIC0xMjIuNDc0MTI5XSwgWzM3Ljc4MjQ1OSwgLTEyMi40NzUyNTFdLCBbMzcuNzgyNDA5LCAtMTIyLjQ3NjMxOV0sIFszNy43ODIzNjMsIC0xMjIuNDc3Mzk1XSwgWzM3Ljc4MjMxNCwgLTEyMi40Nzg0NjNdLCBbMzcuNzgyMjY0LCAtMTIyLjQ3OTUzMV0sIFszNy43ODIyMTUsIC0xMjIuNDgwNjA3XSwgWzM3Ljc4MjE2OSwgLTEyMi40ODE2NzVdLCBbMzcuNzgyMTE5LCAtMTIyLjQ4Mjc1XSwgWzM3Ljc4MzcxOCwgLTEyMi40ODI5MDNdLCBbMzcuNzgzNzE4LCAtMTIyLjQ4MjkwM10sIFszNy43ODIxMTksIC0xMjIuNDgyNzVdLCBbMzcuNzgxNzM4LCAtMTIyLjQ4MjcyXSwgWzM3Ljc4MDI1OCwgLTEyMi40ODI2MTNdLCBbMzcuNzgwMTMyLCAtMTIyLjQ4MjYwNV0sIFszNy43NzgyNywgLTEyMi40ODI0NjhdLCBbMzcuNzc4MzIsIC0xMjIuNDgxNF0sIFszNy43NzgzNjksIC0xMjIuNDgwMzMyXSwgWzM3Ljc3ODQxNSwgLTEyMi40NzkyNTZdLCBbMzcuNzc4NDY1LCAtMTIyLjQ3ODE4OF0sIFszNy43Nzg1MTQsIC0xMjIuNDc3MTEyXSwgWzM3Ljc3ODU2NCwgLTEyMi40NzYwNDRdLCBbMzcuNzc4NjEsIC0xMjIuNDc0OTc2XSwgWzM3Ljc3ODY2MywgLTEyMi40NzM4NDddLCBbMzcuNzc4NzEzLCAtMTIyLjQ3MjcyNV0sIFszNy43Nzg3MzYsIC0xMjIuNDcyMjZdLCBbMzcuNzc4NzQzLCAtMTIyLjQ3MjEyM10sIFszNy43Nzg3NTUsIC0xMjIuNDcxODRdLCBbMzcuNzc4NzYyLCAtMTIyLjQ3MTY1N10sIFszNy43Nzg3ODEsIC0xMjIuNDcxMjNdLCBbMzcuNzc4ODEyLCAtMTIyLjQ3MDU4OV0sIFszNy43Nzg4NjEsIC0xMjIuNDY5NTEzXSwgWzM3Ljc3ODkwNywgLTEyMi40Njg0NDVdLCBbMzcuNzc4OTU3LCAtMTIyLjQ2NzM3N10sIFszNy43NzkwMDYsIC0xMjIuNDY2MzAxXSwgWzM3Ljc3OTA1NiwgLTEyMi40NjUyMzNdLCBbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF1dLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNC5hZGRMYXllcihwb2x5X2xpbmVfYjlhMjRjMWZjOGU1NGY0YmIwNDU1ZTBmNGYxODRhNGUpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgcG9seV9saW5lXzJkZjI3NzFmMzcxZDQwNTY4NjE4ZTc3MjQ4M2RlYzg1ID0gTC5wb2x5bGluZSgKICAgICAgICAgICAgICAgICAgICBbWzM3Ljc3OTEwOSwgLTEyMi40NjQyMDNdLCBbMzcuNzc5MTUxLCAtMTIyLjQ2MzA5N10sIFszNy43ODEwMTcsIC0xMjIuNDYzMjI3XSwgWzM3Ljc4MTEzOSwgLTEyMi40NjMyMzRdLCBbMzcuNzgxNTM5LCAtMTIyLjQ2MzI2NV0sIFszNy43ODI3OTEsIC0xMjIuNDYzNDAyXSwgWzM3Ljc4Mjc5MSwgLTEyMi40NjM0MDJdLCBbMzcuNzgzLCAtMTIyLjQ2MzM3Ml0sIFszNy43ODMwNSwgLTEyMi40NjIyOTZdLCBbMzcuNzgzMDk2LCAtMTIyLjQ2MTIyOF0sIFszNy43ODMxNDUsIC0xMjIuNDYwMTUyXSwgWzM3Ljc4MzE5NSwgLTEyMi40NTkwMzFdLCBbMzcuNzgzNjE1LCAtMTIyLjQ1OTA2MV0sIFszNy43ODM4MjQsIC0xMjIuNDU5MDc2XSwgWzM3Ljc4Mzg3OCwgLTEyMi40NTc5NF0sIFszNy43ODM5MjcsIC0xMjIuNDU2ODMzXSwgWzM3Ljc4Mzk3NywgLTEyMi40NTU3MzVdLCBbMzcuNzg0MDMsIC0xMjIuNDU0NjI4XSwgWzM3Ljc4NDAzOCwgLTEyMi40NTQ0MTVdLCBbMzcuNzg0MDQ5LCAtMTIyLjQ1NDIyNF0sIFszNy43ODQwNTMsIC0xMjIuNDU0MDMzXSwgWzM3Ljc4NDA1NywgLTEyMi40NTM4NDNdLCBbMzcuNzg0MDU3LCAtMTIyLjQ1MzY1Ml0sIFszNy43ODQxNjgsIC0xMjIuNDUzNjY3XSwgWzM3Ljc4NDI2NywgLTEyMi40NTM2ODJdLCBbMzcuNzg0Mzc4LCAtMTIyLjQ1MzY5OF0sIFszNy43ODQ0OTYsIC0xMjIuNDUzNzEzXSwgWzM3Ljc4NDYxNCwgLTEyMi40NTM3MjhdLCBbMzcuNzg0NzMyLCAtMTIyLjQ1MzczNl0sIFszNy43ODQ4NTEsIC0xMjIuNDUzNzQzXSwgWzM3Ljc4NDk3NiwgLTEyMi40NTM3NTFdLCBbMzcuNzg1MTA2LCAtMTIyLjQ1Mzc1MV0sIFszNy43ODUyMzYsIC0xMjIuNDUzNzU5XSwgWzM3Ljc4NTM1OCwgLTEyMi40NTM3NTldLCBbMzcuNzg1NDY1LCAtMTIyLjQ1Mzc1OV0sIFszNy43ODU1MTEsIC0xMjIuNDUzNzU5XSwgWzM3Ljc4NTU1NiwgLTEyMi40NTM3NTFdLCBbMzcuNzg1NTk0LCAtMTIyLjQ1MzcyOF0sIFszNy43ODU2MzMsIC0xMjIuNDUzNjk4XSwgWzM3Ljc4NTY1OSwgLTEyMi40NTM2Nl0sIFszNy43ODU2ODIsIC0xMjIuNDUzNjE0XSwgWzM3Ljc4NTY5NCwgLTEyMi40NTM1Nl0sIFszNy43ODU3MDUsIC0xMjIuNDUzNDk5XSwgWzM3Ljc4NTcxMywgLTEyMi40NTM0MzFdLCBbMzcuNzg1NzE3LCAtMTIyLjQ1MzM3N10sIFszNy43ODU3MjQsIC0xMjIuNDUzMjc4XSwgWzM3Ljc4NTc3LCAtMTIyLjQ1MjkyXSwgWzM3Ljc4NTg3NywgLTEyMi40NTIwOF0sIFszNy43ODU5MTEsIC0xMjIuNDUxNzk4XSwgWzM3Ljc4NTkxMSwgLTEyMi40NTE3OThdLCBbMzcuNzg1ODc3LCAtMTIyLjQ1MjA4XSwgWzM3Ljc4NTc3LCAtMTIyLjQ1MjkyXSwgWzM3Ljc4NTcyNCwgLTEyMi40NTMyNzhdLCBbMzcuNzg1NzE3LCAtMTIyLjQ1MzM3N10sIFszNy43ODU3MTMsIC0xMjIuNDUzNDMxXSwgWzM3Ljc4NTcwNSwgLTEyMi40NTM0OTldLCBbMzcuNzg1Njk0LCAtMTIyLjQ1MzU2XSwgWzM3Ljc4NTY4MiwgLTEyMi40NTM2MTRdLCBbMzcuNzg1NjU5LCAtMTIyLjQ1MzY2XSwgWzM3Ljc4NTYzMywgLTEyMi40NTM2OThdLCBbMzcuNzg1NTk0LCAtMTIyLjQ1MzcyOF0sIFszNy43ODU1NTYsIC0xMjIuNDUzNzUxXSwgWzM3Ljc4NTUxMSwgLTEyMi40NTM3NTldLCBbMzcuNzg1NDY1LCAtMTIyLjQ1Mzc1OV0sIFszNy43ODUzNTgsIC0xMjIuNDUzNzU5XSwgWzM3Ljc4NTIzNiwgLTEyMi40NTM3NTldLCBbMzcuNzg1MTA2LCAtMTIyLjQ1Mzc1MV0sIFszNy43ODQ5NzYsIC0xMjIuNDUzNzUxXSwgWzM3Ljc4NDg1MSwgLTEyMi40NTM3NDNdLCBbMzcuNzg0NzMyLCAtMTIyLjQ1MzczNl0sIFszNy43ODQ2MTQsIC0xMjIuNDUzNzI4XSwgWzM3Ljc4NDQ5NiwgLTEyMi40NTM3MTNdLCBbMzcuNzg0Mzc4LCAtMTIyLjQ1MzY5OF0sIFszNy43ODQyNjcsIC0xMjIuNDUzNjgyXSwgWzM3Ljc4NDE2OCwgLTEyMi40NTM2NjddLCBbMzcuNzg0MDU3LCAtMTIyLjQ1MzY1Ml0sIFszNy43ODQwNTcsIC0xMjIuNDUzODQzXSwgWzM3Ljc4NDA1MywgLTEyMi40NTQwMzNdLCBbMzcuNzg0MDQ5LCAtMTIyLjQ1NDIyNF0sIFszNy43ODQwMzgsIC0xMjIuNDU0NDE1XSwgWzM3Ljc4NDAzLCAtMTIyLjQ1NDYyOF0sIFszNy43ODM5NzcsIC0xMjIuNDU1NzM1XSwgWzM3Ljc4MzkyNywgLTEyMi40NTY4MzNdLCBbMzcuNzgzODc4LCAtMTIyLjQ1Nzk0XSwgWzM3Ljc4MzgyNCwgLTEyMi40NTkwNzZdLCBbMzcuNzgzNjE1LCAtMTIyLjQ1OTA2MV0sIFszNy43ODMxOTUsIC0xMjIuNDU5MDMxXSwgWzM3Ljc4Mjc5OCwgLTEyMi40NTkwMDhdLCBbMzcuNzgyNzYsIC0xMjIuNDU5XSwgWzM3Ljc4MTg0OCwgLTEyMi40NTg5MzldLCBbMzcuNzgxMzMzLCAtMTIyLjQ1ODkwMV0sIFszNy43ODEyMTEsIC0xMjIuNDU4ODkzXSwgWzM3Ljc4MDU3NCwgLTEyMi40NTg4NDhdLCBbMzcuNzc5NzMxLCAtMTIyLjQ1ODc4N10sIFszNy43NzkzNTcsIC0xMjIuNDU4NzU2XSwgWzM3Ljc3ODg1OCwgLTEyMi40NTg3MThdLCBbMzcuNzc4Nzc0LCAtMTIyLjQ1ODcxOF0sIFszNy43NzgwMTEsIC0xMjIuNDU4NjU3XSwgWzM3Ljc3NzczNiwgLTEyMi40NTg2NDJdLCBbMzcuNzc3NTk1LCAtMTIyLjQ1ODYzNF0sIFszNy43NzcyODYsIC0xMjIuNDU4NjExXSwgWzM3Ljc3NzEyNiwgLTEyMi40NTg1OTZdLCBbMzcuNzc2ODQ0LCAtMTIyLjQ1ODU3M10sIFszNy43NzYxODcsIC0xMjIuNDU4NTI3XSwgWzM3Ljc3NjExOSwgLTEyMi40NTg1MjddLCBbMzcuNzc1NjE1LCAtMTIyLjQ1ODQ4OV0sIFszNy43NzU1NjksIC0xMjIuNDU4NTA0XSwgWzM3Ljc3NTU2OSwgLTEyMi40NTg1MDRdLCBbMzcuNzc1MjQ1LCAtMTIyLjQ1ODQ1OF0sIFszNy43NzQ5ODIsIC0xMjIuNDU4NDQzXSwgWzM3Ljc3NDcwMywgLTEyMi40NTg0Ml0sIFszNy43NzQ0MSwgLTEyMi40NTg0MDVdLCBbMzcuNzc0Mjk5LCAtMTIyLjQ1ODM5XSwgWzM3Ljc3NDIxNSwgLTEyMi40NTgzODJdLCBbMzcuNzc0MTczLCAtMTIyLjQ1ODM3NV0sIFszNy43NzQxMTYsIC0xMjIuNDU4MzgyXSwgWzM3Ljc3NDA2NiwgLTEyMi40NTgzOV0sIFszNy43NzQwMTcsIC0xMjIuNDU4NDA1XSwgWzM3Ljc3Mzk2MywgLTEyMi40NTg0MjhdLCBbMzcuNzczOTAyLCAtMTIyLjQ1ODQ2Nl0sIFszNy43NzM4NDEsIC0xMjIuNDU4NTEyXSwgWzM3Ljc3Mzc4OCwgLTEyMi40NTg1NThdLCBbMzcuNzczNjQzLCAtMTIyLjQ1ODY5NV0sIFszNy43NzM1MzIsIC0xMjIuNDU4ODAyXSwgWzM3Ljc3MzQ0MSwgLTEyMi40NTg4ODZdLCBbMzcuNzczMzQ5LCAtMTIyLjQ1ODk3N10sIFszNy43NzMyOTYsIC0xMjIuNDU5MDE1XSwgWzM3Ljc3MzI2MiwgLTEyMi40NTkwMzFdLCBbMzcuNzczMjI3LCAtMTIyLjQ1OTAzOF0sIFszNy43NzMyMDgsIC0xMjIuNDU5MTQ1XSwgWzM3Ljc3MzE5MywgLTEyMi40NTkyNjddLCBbMzcuNzczMTQ3LCAtMTIyLjQ1OTYxXSwgWzM3Ljc3MzExNywgLTEyMi40NTk4MjRdLCBbMzcuNzczMDM2LCAtMTIyLjQ2MDM5Nl0sIFszNy43NzMwMTQsIC0xMjIuNDYwNTExXSwgWzM3Ljc3Mjk4NywgLTEyMi40NjA2MThdLCBbMzcuNzcyOTUzLCAtMTIyLjQ2MDcxN10sIFszNy43NzI5MTgsIC0xMjIuNDYwNzkzXSwgWzM3Ljc3Mjg3MiwgLTEyMi40NjA4NzddLCBbMzcuNzcyODE5LCAtMTIyLjQ2MDk0Nl0sIFszNy43NzI3NjYsIC0xMjIuNDYwOTk5XSwgWzM3Ljc3MjcyLCAtMTIyLjQ2MTAzN10sIFszNy43NzI2NTksIC0xMjIuNDYxMDgzXSwgWzM3Ljc3MjU5OCwgLTEyMi40NjExMjFdLCBbMzcuNzcyNTM3LCAtMTIyLjQ2MTE1OV0sIFszNy43NzI0NjQsIC0xMjIuNDYxMjEzXSwgWzM3Ljc3MjQwMywgLTEyMi40NjEyNjZdLCBbMzcuNzcyMzQ2LCAtMTIyLjQ2MTMxOV0sIFszNy43NzIyODUsIC0xMjIuNDYxMzg4XSwgWzM3Ljc3MjIyOCwgLTEyMi40NjE0NzJdLCBbMzcuNzcyMTcxLCAtMTIyLjQ2MTU2NF0sIFszNy43NzIxMjEsIC0xMjIuNDYxNjYzXSwgWzM3Ljc3MjAzNywgLTEyMi40NjE4MzFdLCBbMzcuNzcyMDAzLCAtMTIyLjQ2MTg5Ml0sIFszNy43NzE5NjgsIC0xMjIuNDYxOTM3XSwgWzM3Ljc3MTkxNSwgLTEyMi40NjE5ODNdLCBbMzcuNzcxODczLCAtMTIyLjQ2MjAwNl0sIFszNy43NzE4MzEsIC0xMjIuNDYyMDI5XSwgWzM3Ljc3MTc3OCwgLTEyMi40NjIwNTJdLCBbMzcuNzcxNzU1LCAtMTIyLjQ2MTkyMl0sIFszNy43NzE1NzUsIC0xMjIuNDYwODMxXSwgWzM3Ljc3MTU0NSwgLTEyMi40NjA2MzNdLCBbMzcuNzcxNDQyLCAtMTIyLjQ1OTk1NF0sIFszNy43NzE0MTksIC0xMjIuNDU5ODI0XSwgWzM3Ljc3MTMzOSwgLTEyMi40NTkzNDNdLCBbMzcuNzcxMzE2LCAtMTIyLjQ1OTE3Nl0sIFszNy43NzEyODIsIC0xMjIuNDU5MTgzXSwgWzM3Ljc3MTI1MSwgLTEyMi40NTkxOThdLCBbMzcuNzcxMjI0LCAtMTIyLjQ1OTIwNl0sIFszNy43NzExMjUsIC0xMjIuNDU5MjQ0XSwgWzM3Ljc3MTA0MSwgLTEyMi40NTkyODJdLCBbMzcuNzcwOTY5LCAtMTIyLjQ1OTMyMV0sIFszNy43NzA4OTYsIC0xMjIuNDU5MzU5XSwgWzM3Ljc3MDgyOCwgLTEyMi40NTk0MDRdLCBbMzcuNzcwNzY3LCAtMTIyLjQ1OTQ1XSwgWzM3Ljc3MDcwNiwgLTEyMi40NTk1MTFdLCBbMzcuNzcwNjUyLCAtMTIyLjQ1OTU3Ml0sIFszNy43NzA1OTksIC0xMjIuNDU5NjQxXSwgWzM3Ljc3MDU1MywgLTEyMi40NTk3MV0sIFszNy43NzA1MTEsIC0xMjIuNDU5Nzk0XSwgWzM3Ljc3MDQ3MywgLTEyMi40NTk4ODVdLCBbMzcuNzcwNDM5LCAtMTIyLjQ1OTk4NF0sIFszNy43NzA0MTYsIC0xMjIuNDYwMDc2XSwgWzM3Ljc3MDM5NywgLTEyMi40NjAxOV0sIFszNy43NzAzNzgsIC0xMjIuNDYwMzA1XSwgWzM3Ljc3MDM2MiwgLTEyMi40NjA0NV0sIFszNy43NzAzNTEsIC0xMjIuNDYwNTk1XSwgWzM3Ljc3MDMzOSwgLTEyMi40NjA3NF0sIFszNy43NzAzMzIsIC0xMjIuNDYwODc3XSwgWzM3Ljc3MDMzNiwgLTEyMi40NjEwMTRdLCBbMzcuNzcwMzQzLCAtMTIyLjQ2MTE1Ml0sIFszNy43NzAzNDMsIC0xMjIuNDYxMjg5XSwgWzM3Ljc3MDMzOSwgLTEyMi40NjE0MTldLCBbMzcuNzcwMzI4LCAtMTIyLjQ2MTU0MV0sIFszNy43NzAzMTMsIC0xMjIuNDYxNjc4XSwgWzM3Ljc3MDI5LCAtMTIyLjQ2MThdLCBbMzcuNzcwMjYzLCAtMTIyLjQ2MTkzN10sIFszNy43NzAyMzYsIC0xMjIuNDYyMDUyXSwgWzM3Ljc2OTk5NiwgLTEyMi40NjMwNTldLCBbMzcuNzY5OTc3LCAtMTIyLjQ2MzE0M10sIFszNy43Njk3MTgsIC0xMjIuNDY0MjY0XSwgWzM3Ljc2OTY4LCAtMTIyLjQ2NDQwMl0sIFszNy43Njk2NDEsIC0xMjIuNDY0NTI0XSwgWzM3Ljc2OTU4OCwgLTEyMi40NjQ2NTRdLCBbMzcuNzY5NTMxLCAtMTIyLjQ2NDc3Nl0sIFszNy43Njk0NjIsIC0xMjIuNDY0OTA1XSwgWzM3Ljc2OTM5LCAtMTIyLjQ2NTAyXSwgWzM3Ljc2OTM5LCAtMTIyLjQ2NDk5N10sIFszNy43NjkzOSwgLTEyMi40NjQ5OTddLCBbMzcuNzY5MzksIC0xMjIuNDY1MDJdLCBbMzcuNzY5NDYyLCAtMTIyLjQ2NDkwNV0sIFszNy43Njk1MzEsIC0xMjIuNDY0Nzc2XSwgWzM3Ljc2OTU4OCwgLTEyMi40NjQ2NTRdLCBbMzcuNzY5NjQxLCAtMTIyLjQ2NDUyNF0sIFszNy43Njk2OCwgLTEyMi40NjQ0MDJdLCBbMzcuNzY5NzE4LCAtMTIyLjQ2NDI2NF0sIFszNy43Njk5NzcsIC0xMjIuNDYzMTQzXSwgWzM3Ljc2OTk5NiwgLTEyMi40NjMwNTldLCBbMzcuNzcwMjM2LCAtMTIyLjQ2MjA1Ml0sIFszNy43NzAyNjMsIC0xMjIuNDYxOTM3XSwgWzM3Ljc3MDI5LCAtMTIyLjQ2MThdLCBbMzcuNzcwMzEzLCAtMTIyLjQ2MTY3OF0sIFszNy43NzAzMjgsIC0xMjIuNDYxNTQxXSwgWzM3Ljc3MDMzOSwgLTEyMi40NjE0MTldLCBbMzcuNzcwMzQzLCAtMTIyLjQ2MTI4OV0sIFszNy43NzAzNDMsIC0xMjIuNDYxMTUyXSwgWzM3Ljc3MDMzNiwgLTEyMi40NjEwMTRdLCBbMzcuNzcwMzMyLCAtMTIyLjQ2MDg3N10sIFszNy43NzAzMzksIC0xMjIuNDYwNzRdLCBbMzcuNzcwMzUxLCAtMTIyLjQ2MDU5NV0sIFszNy43NzAzNjIsIC0xMjIuNDYwNDVdLCBbMzcuNzcwMzc4LCAtMTIyLjQ2MDMwNV0sIFszNy43NzAzOTcsIC0xMjIuNDYwMTldLCBbMzcuNzcwNDE2LCAtMTIyLjQ2MDA3Nl0sIFszNy43NzA0MzksIC0xMjIuNDU5OTg0XSwgWzM3Ljc3MDQ3MywgLTEyMi40NTk4ODVdLCBbMzcuNzcwNTExLCAtMTIyLjQ1OTc5NF0sIFszNy43NzA1NTMsIC0xMjIuNDU5NzFdLCBbMzcuNzcwNTk5LCAtMTIyLjQ1OTY0MV0sIFszNy43NzA2NTIsIC0xMjIuNDU5NTcyXSwgWzM3Ljc3MDcwNiwgLTEyMi40NTk1MTFdLCBbMzcuNzcwNzY3LCAtMTIyLjQ1OTQ1XSwgWzM3Ljc3MDgyOCwgLTEyMi40NTk0MDRdLCBbMzcuNzcwODk2LCAtMTIyLjQ1OTM1OV0sIFszNy43NzA5NjksIC0xMjIuNDU5MzIxXSwgWzM3Ljc3MTA0MSwgLTEyMi40NTkyODJdLCBbMzcuNzcxMTI1LCAtMTIyLjQ1OTI0NF0sIFszNy43NzEyMjQsIC0xMjIuNDU5MjA2XSwgWzM3Ljc3MTI1MSwgLTEyMi40NTkxOThdLCBbMzcuNzcxMjgyLCAtMTIyLjQ1OTE4M10sIFszNy43NzEzMTYsIC0xMjIuNDU5MTc2XSwgWzM3Ljc3MTMzOSwgLTEyMi40NTkzNDNdLCBbMzcuNzcxNDE5LCAtMTIyLjQ1OTgyNF0sIFszNy43NzE0NDIsIC0xMjIuNDU5OTU0XSwgWzM3Ljc3MTU0NSwgLTEyMi40NjA2MzNdLCBbMzcuNzcxNTc1LCAtMTIyLjQ2MDgzMV0sIFszNy43NzE3NTUsIC0xMjIuNDYxOTIyXSwgWzM3Ljc3MTc3OCwgLTEyMi40NjIwNTJdLCBbMzcuNzcxODA4LCAtMTIyLjQ2MjE4Ml0sIFszNy43NzE4MzksIC0xMjIuNDYyMzA0XSwgWzM3Ljc3MTk3NiwgLTEyMi40NjI4NTNdLCBbMzcuNzcyMDI5LCAtMTIyLjQ2MzA1MV0sIFszNy43NzIwODMsIC0xMjIuNDYzMjVdLCBbMzcuNzcyMTQ4LCAtMTIyLjQ2MzQ5NF0sIFszNy43NzIyNjYsIC0xMjIuNDYzOTEzXSwgWzM3Ljc3MjMwOCwgLTEyMi40NjQwNzRdLCBbMzcuNzcyMzY1LCAtMTIyLjQ2NDI3Ml0sIFszNy43NzIzOTksIC0xMjIuNDY0NDAyXSwgWzM3Ljc3MjQzLCAtMTIyLjQ2NDUyNF0sIFszNy43NzI0NiwgLTEyMi40NjQ2NTRdLCBbMzcuNzcyNDg3LCAtMTIyLjQ2NDc5MV0sIFszNy43NzI1MSwgLTEyMi40NjQ5MjFdLCBbMzcuNzcyNTMzLCAtMTIyLjQ2NTA1XSwgWzM3Ljc3MjU1NiwgLTEyMi40NjUxOF0sIFszNy43NzI1NzUsIC0xMjIuNDY1MzFdLCBbMzcuNzcyNTksIC0xMjIuNDY1NDI0XSwgWzM3Ljc3MjYwMiwgLTEyMi40NjU1MzldLCBbMzcuNzcyNjA5LCAtMTIyLjQ2NTY1M10sIFszNy43NzI2MTMsIC0xMjIuNDY1NzUyXSwgWzM3Ljc3MjYxMywgLTEyMi40NjU4NDRdLCBbMzcuNzcyNzEyLCAtMTIyLjQ2NTg1MV0sIFszNy43NzI3ODUsIC0xMjIuNDY1ODU5XSwgWzM3Ljc3Mjk1MywgLTEyMi40NjU4NjddLCBbMzcuNzczMTcsIC0xMjIuNDY1ODgyXSwgWzM3Ljc3MzQwMywgLTEyMi40NjU4OTddLCBbMzcuNzc1MjcyLCAtMTIyLjQ2NjAzNF0sIFszNy43NzcxMzcsIC0xMjIuNDY2MTY0XSwgWzM3Ljc3ODkxNSwgLTEyMi40NjYyOTRdLCBbMzcuNzc5MDA2LCAtMTIyLjQ2NjMwMV0sIFszNy43NzkwNTYsIC0xMjIuNDY1MjMzXSwgWzM3Ljc3OTEwNiwgLTEyMi40NjQxNThdXSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAncmVkJywKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcF80MDlkMmFjYmMxN2I0MTFiODkxMDZiMjBmMWEzMDNlNC5hZGRMYXllcihwb2x5X2xpbmVfMmRmMjc3MWYzNzFkNDA1Njg2MThlNzcyNDgzZGVjODUpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L3NjcmlwdD4KICAgICAgICA=" style="position:absolute;width:100%;height:100%;left:0;top:0;"></iframe></div></div>



Now let's say that Celeste and I have a friend who's willing to help us with our errands. I run the optimization function again, now specifying 3 travelers. The results from this indicated that one person should go to Pizzetta, one person should go to Toy Boat and Noah's Bagels, and one person should go to Lamp's Plus, the de Young, and Arguello Market. In this case, the person with the fewest amount of stops has the longest travel time (52 minutes), and the full set of errands will be made 15 minutes faster than it was with only 2 people.


```python
opt_3_people = optimize_stops_mult(home, stops, 3, stop_labels = stop_labels)
```


```python
for i in opt_3_people['order']:
    print i
```

    ['Pizzetta']
    ['Toy Boat', "Noah's Bagels"]
    ['Lamps Plus', 'de Young Museum', 'Arguello Market']
    


```python
opt_3_people['time']
```




    [52, 44, 49]




```python
points = [[opt_3_people['home_point']]] + opt_3_people['points']
labels = [['Home']] + [[' - '.join((str(i), x)) for i, x in enumerate(l, 1)] for l in opt_3_people['order']]

m3 = plot_stops(points, zoom_level = 14, tiles = 'Stamen Watercolor', labels = labels,line_coords = opt_3_people['lines'])
m3
```




<div style="width:100%;"><div style="position:relative;width:100%;height:0;padding-bottom:60%;"><iframe src="data:text/html;base64,CiAgICAgICAgPCFET0NUWVBFIGh0bWw+CiAgICAgICAgPGhlYWQ+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bWV0YSBodHRwLWVxdWl2PSJjb250ZW50LXR5cGUiIGNvbnRlbnQ9InRleHQvaHRtbDsgY2hhcnNldD1VVEYtOCIgLz4KICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0LzAuNy4zL2xlYWZsZXQuanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vYWpheC5nb29nbGVhcGlzLmNvbS9hamF4L2xpYnMvanF1ZXJ5LzEuMTEuMS9qcXVlcnkubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9qcy9ib290c3RyYXAubWluLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9MZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy8yLjAuMi9sZWFmbGV0LmF3ZXNvbWUtbWFya2Vycy5taW4uanMiPjwvc2NyaXB0PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPHNjcmlwdCBzcmM9Imh0dHBzOi8vY2RuanMuY2xvdWRmbGFyZS5jb20vYWpheC9saWJzL2xlYWZsZXQubWFya2VyY2x1c3Rlci8wLjQuMC9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXItc3JjLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxzY3JpcHQgc3JjPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvbGVhZmxldC5tYXJrZXJjbHVzdGVyLmpzIj48L3NjcmlwdD4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC8wLjcuMy9sZWFmbGV0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9tYXhjZG4uYm9vdHN0cmFwY2RuLmNvbS9ib290c3RyYXAvMy4yLjAvY3NzL2Jvb3RzdHJhcC5taW4uY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL21heGNkbi5ib290c3RyYXBjZG4uY29tL2Jvb3RzdHJhcC8zLjIuMC9jc3MvYm9vdHN0cmFwLXRoZW1lLm1pbi5jc3MiIC8+CiAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Imh0dHBzOi8vbWF4Y2RuLmJvb3RzdHJhcGNkbi5jb20vZm9udC1hd2Vzb21lLzQuMS4wL2Nzcy9mb250LWF3ZXNvbWUubWluLmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvTGVhZmxldC5hd2Vzb21lLW1hcmtlcnMvMi4wLjIvbGVhZmxldC5hd2Vzb21lLW1hcmtlcnMuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL2NkbmpzLmNsb3VkZmxhcmUuY29tL2FqYXgvbGlicy9sZWFmbGV0Lm1hcmtlcmNsdXN0ZXIvMC40LjAvTWFya2VyQ2x1c3Rlci5EZWZhdWx0LmNzcyIgLz4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIDxsaW5rIHJlbD0ic3R5bGVzaGVldCIgaHJlZj0iaHR0cHM6Ly9jZG5qcy5jbG91ZGZsYXJlLmNvbS9hamF4L2xpYnMvbGVhZmxldC5tYXJrZXJjbHVzdGVyLzAuNC4wL01hcmtlckNsdXN0ZXIuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgPGxpbmsgcmVsPSJzdHlsZXNoZWV0IiBocmVmPSJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vcHl0aG9uLXZpc3VhbGl6YXRpb24vZm9saXVtL21hc3Rlci9mb2xpdW0vdGVtcGxhdGVzL2xlYWZsZXQuYXdlc29tZS5yb3RhdGUuY3NzIiAvPgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPgoKICAgICAgICAgICAgaHRtbCwgYm9keSB7CiAgICAgICAgICAgICAgICB3aWR0aDogMTAwJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwJTsKICAgICAgICAgICAgICAgIG1hcmdpbjogMDsKICAgICAgICAgICAgICAgIHBhZGRpbmc6IDA7CiAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAjbWFwIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uOmFic29sdXRlOwogICAgICAgICAgICAgICAgdG9wOjA7CiAgICAgICAgICAgICAgICBib3R0b206MDsKICAgICAgICAgICAgICAgIHJpZ2h0OjA7CiAgICAgICAgICAgICAgICBsZWZ0OjA7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIDwvc3R5bGU+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPHN0eWxlPiAjbWFwX2Y4ZjBmNjllODcxMzQ3Njc5NjY5ZDU4NGEzMzBjYzhjIHsKICAgICAgICAgICAgICAgIHBvc2l0aW9uIDogcmVsYXRpdmU7CiAgICAgICAgICAgICAgICB3aWR0aCA6IDEwMC4wJTsKICAgICAgICAgICAgICAgIGhlaWdodDogMTAwLjAlOwogICAgICAgICAgICAgICAgbGVmdDogMC4wJTsKICAgICAgICAgICAgICAgIHRvcDogMC4wJTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgPC9zdHlsZT4KICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICA8L2hlYWQ+CiAgICAgICAgPGJvZHk+CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgPGRpdiBjbGFzcz0iZm9saXVtLW1hcCIgaWQ9Im1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4YyIgPjwvZGl2PgogICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvYm9keT4KICAgICAgICA8c2NyaXB0PgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgc291dGhXZXN0ID0gTC5sYXRMbmcoLTkwLCAtMTgwKTsKICAgICAgICAgICAgdmFyIG5vcnRoRWFzdCA9IEwubGF0TG5nKDkwLCAxODApOwogICAgICAgICAgICB2YXIgYm91bmRzID0gTC5sYXRMbmdCb3VuZHMoc291dGhXZXN0LCBub3J0aEVhc3QpOwoKICAgICAgICAgICAgdmFyIG1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4YyA9IEwubWFwKCdtYXBfZjhmMGY2OWU4NzEzNDc2Nzk2NjlkNTg0YTMzMGNjOGMnLCB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjZW50ZXI6WzM3Ljc3OTc5MDcxNDMsLTEyMi40NjUyMDY3MTRdLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgem9vbTogMTQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXhCb3VuZHM6IGJvdW5kcywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxheWVyczogW10sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjcnM6IEwuQ1JTLkVQU0czODU3CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHRpbGVfbGF5ZXJfOTBlOGUzMDczZDM2NGEwNGEzZTZjODA2MzNkYTcyZjkgPSBMLnRpbGVMYXllcigKICAgICAgICAgICAgICAgICdodHRwczovL3N0YW1lbi10aWxlcy17c30uYS5zc2wuZmFzdGx5Lm5ldC93YXRlcmNvbG9yL3t6fS97eH0ve3l9LmpwZycsCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgbWF4Wm9vbTogMTgsCiAgICAgICAgICAgICAgICAgICAgbWluWm9vbTogMSwKICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGlvbjogJ01hcCB0aWxlcyBieSA8YSBocmVmPSJodHRwOi8vc3RhbWVuLmNvbSI+U3RhbWVuIERlc2lnbjwvYT4sIHVuZGVyIDxhIGhyZWY9Imh0dHA6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LzMuMCI+Q0MgQlkgMy4wPC9hPi4gRGF0YSBieSA8YSBocmVmPSJodHRwOi8vb3BlbnN0cmVldG1hcC5vcmciPk9wZW5TdHJlZXRNYXA8L2E+LCB1bmRlciA8YSBocmVmPSJodHRwOi8vY3JlYXRpdmVjb21tb25zLm9yZy9saWNlbnNlcy9ieS1zYS8zLjAiPkNDIEJZIFNBPC9hPi4nLAogICAgICAgICAgICAgICAgICAgIGRldGVjdFJldGluYTogZmFsc2UKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApLmFkZFRvKG1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4Yyk7CgogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfMWQxNzliM2Y4NGJkNGMxOTk3ZTEyZTExMmFmZjIzYzYgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NzkxMSwtMTIyLjQ2NDE4OF0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwX2Y4ZjBmNjllODcxMzQ3Njc5NjY5ZDU4NGEzMzBjYzhjKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2YzZGFkNjZhNDdiZTRiYjA5MGExNTY1ZDhhNTA1N2JjID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdibGFjaycsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl8xZDE3OWIzZjg0YmQ0YzE5OTdlMTJlMTEyYWZmMjNjNi5zZXRJY29uKGljb25fZjNkYWQ2NmE0N2JlNGJiMDkwYTE1NjVkOGE1MDU3YmMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF9lM2U1MDM5YzE2MzY0MjRhOTUwMmNlZGIzMWVhZTM2YyA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF81MGRlNTQxOTQ0NmU0ZmMyYTk5ZjQ5ZjU4ZmI1NzFhMSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNTBkZTU0MTk0NDZlNGZjMmE5OWY0OWY1OGZiNTcxYTEiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIEhvbWU8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfZTNlNTAzOWMxNjM2NDI0YTk1MDJjZWRiMzFlYWUzNmMuc2V0Q29udGVudChodG1sXzUwZGU1NDE5NDQ2ZTRmYzJhOTlmNDlmNThmYjU3MWExKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfMWQxNzliM2Y4NGJkNGMxOTk3ZTEyZTExMmFmZjIzYzYuYmluZFBvcHVwKHBvcHVwX2UzZTUwMzljMTYzNjQyNGE5NTAyY2VkYjMxZWFlMzZjKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfYjlkZGUyZWI4NjY1NDAzZDg1NWFkNGQwYWY2MDYwY2IgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODM3MDcsLTEyMi40ODMwMDJdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4Yyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl9lN2E4YTJmMGQ4ODU0NDBjYWFlZGM3MjJkOTQxOThhYiA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnYmx1ZScsCiAgICAgICAgICAgICAgICAgICAgcHJlZml4OiAnZ2x5cGhpY29uJywKICAgICAgICAgICAgICAgICAgICBleHRyYUNsYXNzZXM6ICdmYS1yb3RhdGUtMCcKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcmtlcl9iOWRkZTJlYjg2NjU0MDNkODU1YWQ0ZDBhZjYwNjBjYi5zZXRJY29uKGljb25fZTdhOGEyZjBkODg1NDQwY2FhZWRjNzIyZDk0MTk4YWIpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgIHZhciBwb3B1cF85MzU3OGE3YWY0NmM0NDE0YmQyOTFiZTkwMjg2Y2U3OSA9IEwucG9wdXAoe21heFdpZHRoOiAnMzAwJ30pOwoKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgaHRtbF81YTZjNzk2NWY1Y2M0ZTEwODE1MTFhYjJmMTZiMzBmMSA9ICQoJyAgICAgICAgIDxkaXYgaWQ9Imh0bWxfNWE2Yzc5NjVmNWNjNGUxMDgxNTExYWIyZjE2YjMwZjEiICAgICAgICAgICAgICAgICBzdHlsZT0id2lkdGg6IDEwMC4wJTsgaGVpZ2h0OiAxMDAuMCU7Ij4gICAgICAgICAgICAgICAgIDEgLSBQaXp6ZXR0YTwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF85MzU3OGE3YWY0NmM0NDE0YmQyOTFiZTkwMjg2Y2U3OS5zZXRDb250ZW50KGh0bWxfNWE2Yzc5NjVmNWNjNGUxMDgxNTExYWIyZjE2YjMwZjEpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9iOWRkZTJlYjg2NjU0MDNkODU1YWQ0ZDBhZjYwNjBjYi5iaW5kUG9wdXAocG9wdXBfOTM1NzhhN2FmNDZjNDQxNGJkMjkxYmU5MDI4NmNlNzkpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgdmFyIG1hcmtlcl8wYzRlNzczNTc4YjM0YmY4YmQ4OWRkYjJjOGQyNjE5ZSA9IEwubWFya2VyKAogICAgICAgICAgICAgICAgWzM3Ljc4Mjc4NCwtMTIyLjQ2MzUwOV0sCiAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogbmV3IEwuSWNvbi5EZWZhdWx0KCkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICApCiAgICAgICAgICAgICAgICAuYWRkVG8obWFwX2Y4ZjBmNjllODcxMzQ3Njc5NjY5ZDU4NGEzMzBjYzhjKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAoKICAgICAgICAgICAgICAgIHZhciBpY29uX2ZjNDkwNTczNzg3MjQyNjliMjA0YWM2NDcxNjQzOTExID0gTC5Bd2Vzb21lTWFya2Vycy5pY29uKHsKICAgICAgICAgICAgICAgICAgICBpY29uOiAnaW5mby1zaWduJywKICAgICAgICAgICAgICAgICAgICBpY29uQ29sb3I6ICd3aGl0ZScsCiAgICAgICAgICAgICAgICAgICAgbWFya2VyQ29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfMGM0ZTc3MzU3OGIzNGJmOGJkODlkZGIyYzhkMjYxOWUuc2V0SWNvbihpY29uX2ZjNDkwNTczNzg3MjQyNjliMjA0YWM2NDcxNjQzOTExKTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNDNmYzUzMDdhMTlkNDk5YWIxZmYxZGQxNGNiMGFmYTcgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfZmFkMGE1Yzg2YTlmNDczOTkxNmJlM2Q0NWMyMTRlMGEgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sX2ZhZDBhNWM4NmE5ZjQ3Mzk5MTZiZTNkNDVjMjE0ZTBhIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAxIC0gVG95IEJvYXQ8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNDNmYzUzMDdhMTlkNDk5YWIxZmYxZGQxNGNiMGFmYTcuc2V0Q29udGVudChodG1sX2ZhZDBhNWM4NmE5ZjQ3Mzk5MTZiZTNkNDVjMjE0ZTBhKTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfMGM0ZTc3MzU3OGIzNGJmOGJkODlkZGIyYzhkMjYxOWUuYmluZFBvcHVwKHBvcHVwXzQzZmM1MzA3YTE5ZDQ5OWFiMWZmMWRkMTRjYjBhZmE3KTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfNTNlYTAzNzJiMjU4NDdiNGI1NzhkM2M5NWUyZWE0YWYgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43ODYyMDUsLTEyMi40NTE4NDNdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4Yyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl85ZjBhMmIxYjIzYjk0MzAyYTU1ODgzZTE4M2U5MzA1YyA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAncmVkJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyXzUzZWEwMzcyYjI1ODQ3YjRiNTc4ZDNjOTVlMmVhNGFmLnNldEljb24oaWNvbl85ZjBhMmIxYjIzYjk0MzAyYTU1ODgzZTE4M2U5MzA1Yyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwX2JlZjJkZDRiZDZlMjRlOWI5ZGM1MmEyNTRlMzQ2YTkyID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sXzdhY2UxZThiM2U4NjQxODU5YTdhN2QxNjUzMGFiZDY0ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF83YWNlMWU4YjNlODY0MTg1OWE3YTdkMTY1MzBhYmQ2NCIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgMiAtIE5vYWgmIzM5O3MgQmFnZWxzPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwX2JlZjJkZDRiZDZlMjRlOWI5ZGM1MmEyNTRlMzQ2YTkyLnNldENvbnRlbnQoaHRtbF83YWNlMWU4YjNlODY0MTg1OWE3YTdkMTY1MzBhYmQ2NCk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyXzUzZWEwMzcyYjI1ODQ3YjRiNTc4ZDNjOTVlMmVhNGFmLmJpbmRQb3B1cChwb3B1cF9iZWYyZGQ0YmQ2ZTI0ZTliOWRjNTJhMjU0ZTM0NmE5Mik7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2NmNjFlNzgzYmFhYjQ0NTdiNjZkZDBhOGZlNGIxNGE2ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzgxMTMyLC0xMjIuNDY5OTU1XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfZjhmMGY2OWU4NzEzNDc2Nzk2NjlkNTg0YTMzMGNjOGMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fOWNkMmU0YzAzYzhjNDI5Y2EyZWExNjgyNjE5NmQ0NmEgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2dyZWVuJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2NmNjFlNzgzYmFhYjQ0NTdiNjZkZDBhOGZlNGIxNGE2LnNldEljb24oaWNvbl85Y2QyZTRjMDNjOGM0MjljYTJlYTE2ODI2MTk2ZDQ2YSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzZmMGVlYjhmYzU4ZDQzOTI5MmRlZjIzNGJkY2YzYzhhID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2U0NmVkN2Q0NzAyOTRiNTQ4YTE1MDAxMDJhNGJjODU1ID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9lNDZlZDdkNDcwMjk0YjU0OGExNTAwMTAyYTRiYzg1NSIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgMSAtIExhbXBzIFBsdXM8L2Rpdj4gICAgICAgICAgICAgICAgICcpWzBdOwogICAgICAgICAgICAgICAgcG9wdXBfNmYwZWViOGZjNThkNDM5MjkyZGVmMjM0YmRjZjNjOGEuc2V0Q29udGVudChodG1sX2U0NmVkN2Q0NzAyOTRiNTQ4YTE1MDAxMDJhNGJjODU1KTsKICAgICAgICAgICAgCgogICAgICAgICAgICBtYXJrZXJfY2Y2MWU3ODNiYWFiNDQ1N2I2NmRkMGE4ZmU0YjE0YTYuYmluZFBvcHVwKHBvcHVwXzZmMGVlYjhmYzU4ZDQzOTI5MmRlZjIzNGJkY2YzYzhhKTsKCiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgIHZhciBtYXJrZXJfZmYwMWU5MjY2MGZmNDk2Mzg0OGUyOWYxNDY1MTU2MTcgPSBMLm1hcmtlcigKICAgICAgICAgICAgICAgIFszNy43NzAwMTYsLTEyMi40NjU2MTRdLAogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGljb246IG5ldyBMLkljb24uRGVmYXVsdCgpCiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgLmFkZFRvKG1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4Yyk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKCiAgICAgICAgICAgICAgICB2YXIgaWNvbl8wOTIyZjUxNTE2OTg0MThjYjkyM2RjZDFkZDQ4NGQ1OSA9IEwuQXdlc29tZU1hcmtlcnMuaWNvbih7CiAgICAgICAgICAgICAgICAgICAgaWNvbjogJ2luZm8tc2lnbicsCiAgICAgICAgICAgICAgICAgICAgaWNvbkNvbG9yOiAnd2hpdGUnLAogICAgICAgICAgICAgICAgICAgIG1hcmtlckNvbG9yOiAnZ3JlZW4nLAogICAgICAgICAgICAgICAgICAgIHByZWZpeDogJ2dseXBoaWNvbicsCiAgICAgICAgICAgICAgICAgICAgZXh0cmFDbGFzc2VzOiAnZmEtcm90YXRlLTAnCiAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBtYXJrZXJfZmYwMWU5MjY2MGZmNDk2Mzg0OGUyOWYxNDY1MTU2MTcuc2V0SWNvbihpY29uXzA5MjJmNTE1MTY5ODQxOGNiOTIzZGNkMWRkNDg0ZDU5KTsKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICB2YXIgcG9wdXBfNjc3NmIzNGI0NDg5NDM0NDg1ZTcxODFiZGQ4ZDFjZTAgPSBMLnBvcHVwKHttYXhXaWR0aDogJzMwMCd9KTsKCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIGh0bWxfOGExMDZjZjE5ZjZmNDg0Yjg1ZTA2N2U0OGRjZGJiNDMgPSAkKCcgICAgICAgICA8ZGl2IGlkPSJodG1sXzhhMTA2Y2YxOWY2ZjQ4NGI4NWUwNjdlNDhkY2RiYjQzIiAgICAgICAgICAgICAgICAgc3R5bGU9IndpZHRoOiAxMDAuMCU7IGhlaWdodDogMTAwLjAlOyI+ICAgICAgICAgICAgICAgICAyIC0gZGUgWW91bmcgTXVzZXVtPC9kaXY+ICAgICAgICAgICAgICAgICAnKVswXTsKICAgICAgICAgICAgICAgIHBvcHVwXzY3NzZiMzRiNDQ4OTQzNDQ4NWU3MTgxYmRkOGQxY2UwLnNldENvbnRlbnQoaHRtbF84YTEwNmNmMTlmNmY0ODRiODVlMDY3ZTQ4ZGNkYmI0Myk7CiAgICAgICAgICAgIAoKICAgICAgICAgICAgbWFya2VyX2ZmMDFlOTI2NjBmZjQ5NjM4NDhlMjlmMTQ2NTE1NjE3LmJpbmRQb3B1cChwb3B1cF82Nzc2YjM0YjQ0ODk0MzQ0ODVlNzE4MWJkZDhkMWNlMCk7CgogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICB2YXIgbWFya2VyX2UyMzI4YTIyZmFiMDQxYWM5MTExZDI3NjA3N2ZmNzE2ID0gTC5tYXJrZXIoCiAgICAgICAgICAgICAgICBbMzcuNzc1NTgxLC0xMjIuNDU4MzM2XSwKICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICBpY29uOiBuZXcgTC5JY29uLkRlZmF1bHQoKQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgIC5hZGRUbyhtYXBfZjhmMGY2OWU4NzEzNDc2Nzk2NjlkNTg0YTMzMGNjOGMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCgogICAgICAgICAgICAgICAgdmFyIGljb25fZGFjZWJmN2Y4NDExNGY3MWI4N2UwZjRmZjUxMWQzOTkgPSBMLkF3ZXNvbWVNYXJrZXJzLmljb24oewogICAgICAgICAgICAgICAgICAgIGljb246ICdpbmZvLXNpZ24nLAogICAgICAgICAgICAgICAgICAgIGljb25Db2xvcjogJ3doaXRlJywKICAgICAgICAgICAgICAgICAgICBtYXJrZXJDb2xvcjogJ2dyZWVuJywKICAgICAgICAgICAgICAgICAgICBwcmVmaXg6ICdnbHlwaGljb24nLAogICAgICAgICAgICAgICAgICAgIGV4dHJhQ2xhc3NlczogJ2ZhLXJvdGF0ZS0wJwogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFya2VyX2UyMzI4YTIyZmFiMDQxYWM5MTExZDI3NjA3N2ZmNzE2LnNldEljb24oaWNvbl9kYWNlYmY3Zjg0MTE0ZjcxYjg3ZTBmNGZmNTExZDM5OSk7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgdmFyIHBvcHVwXzdkMzYyMTdkMWQ3NDQ0YWE4ZjYwMGJiNmI5ZDA5MWQ1ID0gTC5wb3B1cCh7bWF4V2lkdGg6ICczMDAnfSk7CgogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBodG1sX2Y5YTNlNDM2MjkxZTRmYTliOTA1NGE5NDg2YTVjNjBjID0gJCgnICAgICAgICAgPGRpdiBpZD0iaHRtbF9mOWEzZTQzNjI5MWU0ZmE5YjkwNTRhOTQ4NmE1YzYwYyIgICAgICAgICAgICAgICAgIHN0eWxlPSJ3aWR0aDogMTAwLjAlOyBoZWlnaHQ6IDEwMC4wJTsiPiAgICAgICAgICAgICAgICAgMyAtIEFyZ3VlbGxvIE1hcmtldDwvZGl2PiAgICAgICAgICAgICAgICAgJylbMF07CiAgICAgICAgICAgICAgICBwb3B1cF83ZDM2MjE3ZDFkNzQ0NGFhOGY2MDBiYjZiOWQwOTFkNS5zZXRDb250ZW50KGh0bWxfZjlhM2U0MzYyOTFlNGZhOWI5MDU0YTk0ODZhNWM2MGMpOwogICAgICAgICAgICAKCiAgICAgICAgICAgIG1hcmtlcl9lMjMyOGEyMmZhYjA0MWFjOTExMWQyNzYwNzdmZjcxNi5iaW5kUG9wdXAocG9wdXBfN2QzNjIxN2QxZDc0NDRhYThmNjAwYmI2YjlkMDkxZDUpOwoKICAgICAgICAgICAgCiAgICAgICAgCiAgICAgICAgCiAgICAgICAgICAgIAogICAgICAgICAgICAgICAgdmFyIHBvbHlfbGluZV9lMDhiOTQ4MmQ3NzE0Mjc4YWNlNmVjMWYzM2Q3N2Y2MyA9IEwucG9seWxpbmUoCiAgICAgICAgICAgICAgICAgICAgW1szNy43NzkxMDYsIC0xMjIuNDY0MTU4XSwgWzM3Ljc4MDUyOSwgLTEyMi40NjQyNjRdLCBbMzcuNzgwOTY3LCAtMTIyLjQ2NDI5NV0sIFszNy43ODA5MTgsIC0xMjIuNDY1MzYzXSwgWzM3Ljc4MDkwMiwgLTEyMi40NjU3MTRdLCBbMzcuNzgwODY4LCAtMTIyLjQ2NjQzOV0sIFszNy43ODA4NTMsIC0xMjIuNDY2NzldLCBbMzcuNzgwODIyLCAtMTIyLjQ2NzUwN10sIFszNy43ODA3NzMsIC0xMjIuNDY4NTc1XSwgWzM3Ljc4MDcyMywgLTEyMi40Njk2NTFdLCBbMzcuNzgwNzA4LCAtMTIyLjQ3MDAyNV0sIFszNy43ODA2NzMsIC0xMjIuNDcwNzE5XSwgWzM3Ljc4MDY1OCwgLTEyMi40NzEwOTNdLCBbMzcuNzgwNjI4LCAtMTIyLjQ3MTc5NV0sIFszNy43ODA2MTYsIC0xMjIuNDcxOTg1XSwgWzM3Ljc4MDYwOSwgLTEyMi40NzIxNzZdLCBbMzcuNzgwNjA1LCAtMTIyLjQ3MjI1Ml0sIFszNy43ODA3MjcsIC0xMjIuNDcyMjY4XSwgWzM3Ljc4MDcxOSwgLTEyMi40NzI0MDVdLCBbMzcuNzgwNzE5LCAtMTIyLjQ3MjQ4OV0sIFszNy43ODA3LCAtMTIyLjQ3Mjg3XSwgWzM3Ljc4MDY3LCAtMTIyLjQ3MzUwNF0sIFszNy43ODA2NTEsIC0xMjIuNDczOTkyXSwgWzM3Ljc4MDU5NywgLTEyMi40NzUxMTNdLCBbMzcuNzgwNTUxLCAtMTIyLjQ3NjE4OV0sIFszNy43ODA1MTMsIC0xMjIuNDc2OTM3XSwgWzM3Ljc4MDUwMiwgLTEyMi40NzcyNTddLCBbMzcuNzgwNDY3LCAtMTIyLjQ3Nzk3NF0sIFszNy43ODA0NTIsIC0xMjIuNDc4MzMzXSwgWzM3Ljc4MDQwMywgLTEyMi40Nzk0MDFdLCBbMzcuNzgwMzU3LCAtMTIyLjQ4MDQ3N10sIFszNy43ODAzMjYsIC0xMjIuNDgxMTMzXSwgWzM3Ljc4MDMwNywgLTEyMi40ODE1NDVdLCBbMzcuNzgwMjc3LCAtMTIyLjQ4MjIzOV0sIFszNy43ODAyNTgsIC0xMjIuNDgyNjEzXSwgWzM3Ljc4MTczOCwgLTEyMi40ODI3Ml0sIFszNy43ODIxMTksIC0xMjIuNDgyNzVdLCBbMzcuNzgzNzE4LCAtMTIyLjQ4MjkwM10sIFszNy43ODM3MTgsIC0xMjIuNDgyOTAzXSwgWzM3Ljc4MjExOSwgLTEyMi40ODI3NV0sIFszNy43ODE3MzgsIC0xMjIuNDgyNzJdLCBbMzcuNzgwMjU4LCAtMTIyLjQ4MjYxM10sIFszNy43ODAyNzcsIC0xMjIuNDgyMjM5XSwgWzM3Ljc4MDMwNywgLTEyMi40ODE1NDVdLCBbMzcuNzgwMzI2LCAtMTIyLjQ4MTEzM10sIFszNy43ODAzNTcsIC0xMjIuNDgwNDc3XSwgWzM3Ljc4MDQwMywgLTEyMi40Nzk0MDFdLCBbMzcuNzgwNDUyLCAtMTIyLjQ3ODMzM10sIFszNy43ODA0NjcsIC0xMjIuNDc3OTc0XSwgWzM3Ljc4MDUwMiwgLTEyMi40NzcyNTddLCBbMzcuNzgwNTEzLCAtMTIyLjQ3NjkzN10sIFszNy43ODA1NTEsIC0xMjIuNDc2MTg5XSwgWzM3Ljc4MDU5NywgLTEyMi40NzUxMTNdLCBbMzcuNzgwNjUxLCAtMTIyLjQ3Mzk5Ml0sIFszNy43ODA2NywgLTEyMi40NzM1MDRdLCBbMzcuNzgwNywgLTEyMi40NzI4N10sIFszNy43ODA3MTksIC0xMjIuNDcyNDg5XSwgWzM3Ljc4MDcxOSwgLTEyMi40NzI0MDVdLCBbMzcuNzgwNTk3LCAtMTIyLjQ3MjM5N10sIFszNy43ODA2MDUsIC0xMjIuNDcyMjUyXSwgWzM3Ljc4MDYwOSwgLTEyMi40NzIxNzZdLCBbMzcuNzgwNjE2LCAtMTIyLjQ3MTk4NV0sIFszNy43ODA2MjgsIC0xMjIuNDcxNzk1XSwgWzM3Ljc4MDY1OCwgLTEyMi40NzEwOTNdLCBbMzcuNzgwNjczLCAtMTIyLjQ3MDcxOV0sIFszNy43ODA3MDgsIC0xMjIuNDcwMDI1XSwgWzM3Ljc4MDcyMywgLTEyMi40Njk2NTFdLCBbMzcuNzgwNzczLCAtMTIyLjQ2ODU3NV0sIFszNy43ODA4MjIsIC0xMjIuNDY3NTA3XSwgWzM3Ljc4MDg1MywgLTEyMi40NjY3OV0sIFszNy43ODA4NjgsIC0xMjIuNDY2NDM5XSwgWzM3Ljc4MDkwMiwgLTEyMi40NjU3MTRdLCBbMzcuNzgwOTE4LCAtMTIyLjQ2NTM2M10sIFszNy43ODA5NjcsIC0xMjIuNDY0Mjk1XSwgWzM3Ljc4MDUyOSwgLTEyMi40NjQyNjRdLCBbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF1dLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdibHVlJywKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIG1hcF9mOGYwZjY5ZTg3MTM0NzY3OTY2OWQ1ODRhMzMwY2M4Yy5hZGRMYXllcihwb2x5X2xpbmVfZTA4Yjk0ODJkNzcxNDI3OGFjZTZlYzFmMzNkNzdmNjMpOwogICAgICAgICAgICAKICAgICAgICAKICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB2YXIgcG9seV9saW5lXzBjY2QyY2Q2ZWE2ZDRhM2FiMDAzMGM5Yzk2M2UyZjFiID0gTC5wb2x5bGluZSgKICAgICAgICAgICAgICAgICAgICBbWzM3Ljc3OTEwNiwgLTEyMi40NjQxNThdLCBbMzcuNzgwNTI5LCAtMTIyLjQ2NDI2NF0sIFszNy43ODA5NjcsIC0xMjIuNDY0Mjk1XSwgWzM3Ljc4MTA4OSwgLTEyMi40NjQzMDNdLCBbMzcuNzgxMTM5LCAtMTIyLjQ2MzIzNF0sIFszNy43ODE1MzksIC0xMjIuNDYzMjY1XSwgWzM3Ljc4Mjc5MSwgLTEyMi40NjM0MDJdLCBbMzcuNzgyNzkxLCAtMTIyLjQ2MzQwMl0sIFszNy43ODMsIC0xMjIuNDYzMzcyXSwgWzM3Ljc4NDg2NiwgLTEyMi40NjM1MDFdLCBbMzcuNzg1MTM3LCAtMTIyLjQ2MzUyNF0sIFszNy43ODUyNzQsIC0xMjIuNDYyNDU2XSwgWzM3Ljc4NTQwOCwgLTEyMi40NjEzOTZdLCBbMzcuNzg1NTQ1LCAtMTIyLjQ2MDMyOF0sIFszNy43ODU2ODYsIC0xMjIuNDU5MjE0XSwgWzM3Ljc4NTgzMSwgLTEyMi40NTgwNjldLCBbMzcuNzg1OTcyLCAtMTIyLjQ1Njk3OF0sIFszNy43ODYwMDMsIC0xMjIuNDU2NzExXSwgWzM3Ljc4NjEwOSwgLTEyMi40NTU4ODddLCBbMzcuNzg2MjEyLCAtMTIyLjQ1NTA2M10sIFszNy43ODYyNTEsIC0xMjIuNDU0Nzg5XSwgWzM3Ljc4NjMxMiwgLTEyMi40NTQzXSwgWzM3Ljc4NjM4OCwgLTEyMi40NTM2OThdLCBbMzcuNzg2NDE4LCAtMTIyLjQ1MzQyM10sIFszNy43ODY0MywgLTEyMi40NTMzMjRdLCBbMzcuNzg2NjI0LCAtMTIyLjQ1MTc3NV0sIFszNy43ODY0NzYsIC0xMjIuNDUxNzQ1XSwgWzM3Ljc4NjIzOSwgLTEyMi40NTE2OTldLCBbMzcuNzg2MjM5LCAtMTIyLjQ1MTY5OV0sIFszNy43ODU5MzQsIC0xMjIuNDUxNjNdLCBbMzcuNzg1OTM0LCAtMTIyLjQ1MTYzOF0sIFszNy43ODU4NzcsIC0xMjIuNDUyMDhdLCBbMzcuNzg1NzcsIC0xMjIuNDUyOTJdLCBbMzcuNzg1NzI0LCAtMTIyLjQ1MzI3OF0sIFszNy43ODU3MTcsIC0xMjIuNDUzMzc3XSwgWzM3Ljc4NTcxMywgLTEyMi40NTM0MzFdLCBbMzcuNzg1NzA1LCAtMTIyLjQ1MzQ5OV0sIFszNy43ODU2OTQsIC0xMjIuNDUzNTZdLCBbMzcuNzg1NjgyLCAtMTIyLjQ1MzYxNF0sIFszNy43ODU2NTksIC0xMjIuNDUzNjZdLCBbMzcuNzg1NjMzLCAtMTIyLjQ1MzY5OF0sIFszNy43ODU1OTQsIC0xMjIuNDUzNzI4XSwgWzM3Ljc4NTU1NiwgLTEyMi40NTM3NTFdLCBbMzcuNzg1NTExLCAtMTIyLjQ1Mzc1OV0sIFszNy43ODU0NjUsIC0xMjIuNDUzNzU5XSwgWzM3Ljc4NTM1OCwgLTEyMi40NTM3NTldLCBbMzcuNzg1MjM2LCAtMTIyLjQ1Mzc1OV0sIFszNy43ODUxMDYsIC0xMjIuNDUzNzUxXSwgWzM3Ljc4NDk3NiwgLTEyMi40NTM3NTFdLCBbMzcuNzg0ODUxLCAtMTIyLjQ1Mzc0M10sIFszNy43ODQ3MzIsIC0xMjIuNDUzNzM2XSwgWzM3Ljc4NDYxNCwgLTEyMi40NTM3MjhdLCBbMzcuNzg0NDk2LCAtMTIyLjQ1MzcxM10sIFszNy43ODQzNzgsIC0xMjIuNDUzNjk4XSwgWzM3Ljc4NDI2NywgLTEyMi40NTM2ODJdLCBbMzcuNzg0MTY4LCAtMTIyLjQ1MzY2N10sIFszNy43ODQwNTcsIC0xMjIuNDUzNjUyXSwgWzM3Ljc4Mzk1NCwgLTEyMi40NTM2MzddLCBbMzcuNzgxNzg3LCAtMTIyLjQ1MzIwMl0sIFszNy43ODE2NjksIC0xMjIuNDUzMTc5XSwgWzM3Ljc4MDM2NCwgLTEyMi40NTI5Ml0sIFszNy43ODAyNDIsIC0xMjIuNDUzODk2XSwgWzM3Ljc4MDEyLCAtMTIyLjQ1NDgzNF0sIFszNy43ODAwOTcsIC0xMjIuNDU1MDE4XSwgWzM3Ljc4MDAzNiwgLTEyMi40NTU0OTFdLCBbMzcuNzgwMDI5LCAtMTIyLjQ1NTU1OV0sIFszNy43ODAwMTcsIC0xMjIuNDU1NjJdLCBbMzcuNzgwMDA2LCAtMTIyLjQ1NTY4MV0sIFszNy43Nzk5OTEsIC0xMjIuNDU1NzM1XSwgWzM3Ljc3OTk0NSwgLTEyMi40NTU4NTddLCBbMzcuNzc5ODk5LCAtMTIyLjQ1NTk4N10sIFszNy43Nzk4MDgsIC0xMjIuNDU2MjM4XSwgWzM3Ljc3OTcwOCwgLTEyMi40NTY1MTNdLCBbMzcuNzc5NjcsIC0xMjIuNDU2NjEyXSwgWzM3Ljc3OTY0NCwgLTEyMi40NTY2ODhdLCBbMzcuNzc5NjIxLCAtMTIyLjQ1Njc1N10sIFszNy43Nzk2MDUsIC0xMjIuNDU2ODMzXSwgWzM3Ljc3OTU5NCwgLTEyMi40NTY5MDJdLCBbMzcuNzc5NTc5LCAtMTIyLjQ1NzAwMV0sIFszNy43Nzk0ODMsIC0xMjIuNDU3NzY0XSwgWzM3Ljc3OTQ3MiwgLTEyMi40NTc4NF0sIFszNy43NzkzNzMsIC0xMjIuNDU4NjE5XSwgWzM3Ljc3OTM1NywgLTEyMi40NTg3NTZdLCBbMzcuNzc5MzUsIC0xMjIuNDU4ODI1XSwgWzM3Ljc3OTM0MiwgLTEyMi40NTg4OTNdLCBbMzcuNzc5MywgLTEyMi40NTk4NzhdLCBbMzcuNzc5MjUxLCAtMTIyLjQ2MDk0Nl0sIFszNy43NzkyMDEsIC0xMjIuNDYyMDIxXSwgWzM3Ljc3OTE1MSwgLTEyMi40NjMwOTddLCBbMzcuNzc5MTA5LCAtMTIyLjQ2NDIwM11dLAogICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6ICdyZWQnLAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFwX2Y4ZjBmNjllODcxMzQ3Njc5NjY5ZDU4NGEzMzBjYzhjLmFkZExheWVyKHBvbHlfbGluZV8wY2NkMmNkNmVhNmQ0YTNhYjAwMzBjOWM5NjNlMmYxYik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgICAgICAKICAgICAgICAgICAgICAgIHZhciBwb2x5X2xpbmVfZGRlODBiNzZhNTA1NGVhZGFhMjQ0ZTAwZTdmYzU2MmIgPSBMLnBvbHlsaW5lKAogICAgICAgICAgICAgICAgICAgIFtbMzcuNzc5MTA2LCAtMTIyLjQ2NDE1OF0sIFszNy43ODA1MjksIC0xMjIuNDY0MjY0XSwgWzM3Ljc4MDk2NywgLTEyMi40NjQyOTVdLCBbMzcuNzgwOTE4LCAtMTIyLjQ2NTM2M10sIFszNy43ODA5MDIsIC0xMjIuNDY1NzE0XSwgWzM3Ljc4MDg2OCwgLTEyMi40NjY0MzldLCBbMzcuNzgwODUzLCAtMTIyLjQ2Njc5XSwgWzM3Ljc4MDgyMiwgLTEyMi40Njc1MDddLCBbMzcuNzgwNzczLCAtMTIyLjQ2ODU3NV0sIFszNy43ODA3MjMsIC0xMjIuNDY5NjUxXSwgWzM3Ljc4MDg0NSwgLTEyMi40Njk2NThdLCBbMzcuNzgxMTUsIC0xMjIuNDY5NzA0XSwgWzM3Ljc4MTE1LCAtMTIyLjQ2OTcwNF0sIFszNy43ODA4NDUsIC0xMjIuNDY5NjU4XSwgWzM3Ljc4MDcyMywgLTEyMi40Njk2NTFdLCBbMzcuNzc4ODYxLCAtMTIyLjQ2OTUxM10sIFszNy43NzY5OTIsIC0xMjIuNDY5Mzc2XSwgWzM3Ljc3NTEyNywgLTEyMi40NjkyNDZdLCBbMzcuNzczMjU4LCAtMTIyLjQ2OTEwOV0sIFszNy43NzMzMDMsIC0xMjIuNDY4MDQ5XSwgWzM3Ljc3MzE1OSwgLTEyMi40NjgwMjZdLCBbMzcuNzczMDUyLCAtMTIyLjQ2ODA0OV0sIFszNy43NzI4MDQsIC0xMjIuNDY4MDQ5XSwgWzM3Ljc3MjY0NywgLTEyMi40NjgwNDldLCBbMzcuNzcyNjU1LCAtMTIyLjQ2Nzk4XSwgWzM3Ljc3MjcyNywgLTEyMi40NjY3NTldLCBbMzcuNzcyNjYzLCAtMTIyLjQ2Njc1Ml0sIFszNy43NzI1NjMsIC0xMjIuNDY2NzUyXSwgWzM3Ljc3MjQ4LCAtMTIyLjQ2NjcxM10sIFszNy43NzI0MywgLTEyMi40NjY2Nl0sIFszNy43NzI0NDUsIC0xMjIuNDY2NjE0XSwgWzM3Ljc3MjQ0OSwgLTEyMi40NjY0NzddLCBbMzcuNzcyNDQxLCAtMTIyLjQ2NjIwMl0sIFszNy43NzI0NDEsIC0xMjIuNDY2MTg3XSwgWzM3Ljc3MjMwNCwgLTEyMi40NjYyMThdLCBbMzcuNzcyMDYsIC0xMjIuNDY2MjE4XSwgWzM3Ljc3MTczMiwgLTEyMi40NjYxMzRdLCBbMzcuNzcxNTYsIC0xMjIuNDY2MTAzXSwgWzM3Ljc3MTE3MSwgLTEyMi40NjU5NThdLCBbMzcuNzcxMTY3LCAtMTIyLjQ2NTk1OF0sIFszNy43NzEyNjYsIC0xMjIuNDY1NTYxXSwgWzM3Ljc3MTE3NSwgLTEyMi40NjU1MzFdLCBbMzcuNzcxMTA2LCAtMTIyLjQ2NTVdLCBbMzcuNzcxMDQ1LCAtMTIyLjQ2NTQ1NV0sIFszNy43NzEwMDMsIC0xMjIuNDY1Mzk0XSwgWzM3Ljc3MDk1NywgLTEyMi40NjUyOTRdLCBbMzcuNzcwOTQ2LCAtMTIyLjQ2NTE5NV0sIFszNy43NzA3OTcsIC0xMjIuNDY1MTM0XSwgWzM3Ljc3MDYyNiwgLTEyMi40NjUwNV0sIFszNy43NzA0MjMsIC0xMjIuNDY1MTA0XSwgWzM3Ljc3MDE5OCwgLTEyMi40NjUyMDNdLCBbMzcuNzcwMTk4LCAtMTIyLjQ2NTIwM10sIFszNy43NzAxOTUsIC0xMjIuNDY1MThdLCBbMzcuNzcwNDIzLCAtMTIyLjQ2NTEwNF0sIFszNy43NzA2MjYsIC0xMjIuNDY1MDVdLCBbMzcuNzcwOTMxLCAtMTIyLjQ2NDU3N10sIFszNy43NzEwMTgsIC0xMjIuNDY0MzE4XSwgWzM3Ljc3MTExNCwgLTEyMi40NjQxMjddLCBbMzcuNzcxMTU2LCAtMTIyLjQ2Mzk1OV0sIFszNy43NzExNzEsIC0xMjIuNDYzNzM4XSwgWzM3Ljc3MTE3NSwgLTEyMi40NjM1MDldLCBbMzcuNzcxMjA5LCAtMTIyLjQ2MzI1XSwgWzM3Ljc3MTI4NiwgLTEyMi40NjMxMl0sIFszNy43NzE0MjcsIC0xMjIuNDYzMDc0XSwgWzM3Ljc3MTQ0MiwgLTEyMi40NjI4NTNdLCBbMzcuNzcxNDU3LCAtMTIyLjQ2MjddLCBbMzcuNzcxNDgsIC0xMjIuNDYyNjU1XSwgWzM3Ljc3MTY1MiwgLTEyMi40NjI1NzFdLCBbMzcuNzcxNzM5LCAtMTIyLjQ2MjUxXSwgWzM3Ljc3MTY4NiwgLTEyMi40NjIzNTddLCBbMzcuNzcxNzg1LCAtMTIyLjQ2MjMxOV0sIFszNy43NzE4MzksIC0xMjIuNDYyMzA0XSwgWzM3Ljc3MTg4NCwgLTEyMi40NjIyODFdLCBbMzcuNzcxOTMsIC0xMjIuNDYyMjU4XSwgWzM3Ljc3MTkxNSwgLTEyMi40NjIxODJdLCBbMzcuNzcxOTAzLCAtMTIyLjQ2MjE0M10sIFszNy43NzE5NjUsIC0xMjIuNDYyMDldLCBbMzcuNzcyMDgzLCAtMTIyLjQ2MTkzXSwgWzM3Ljc3MjE3OCwgLTEyMi40NjE3MTZdLCBbMzcuNzcyMjc0LCAtMTIyLjQ2MTUxXSwgWzM3Ljc3MjM5NiwgLTEyMi40NjEzMjddLCBbMzcuNzcyNTQ4LCAtMTIyLjQ2MTIyOF0sIFszNy43NzI1NzksIC0xMjIuNDYxMjEzXSwgWzM3Ljc3MjY1NSwgLTEyMi40NjExNzVdLCBbMzcuNzcyNzA4LCAtMTIyLjQ2MTE0NF0sIFszNy43NzI2NTksIC0xMjIuNDYxMDgzXSwgWzM3Ljc3MjcyLCAtMTIyLjQ2MTAzN10sIFszNy43NzI3NjYsIC0xMjIuNDYwOTk5XSwgWzM3Ljc3MjgxOSwgLTEyMi40NjA5NDZdLCBbMzcuNzcyODcyLCAtMTIyLjQ2MDg3N10sIFszNy43NzI5MTgsIC0xMjIuNDYwNzkzXSwgWzM3Ljc3Mjk1MywgLTEyMi40NjA3MTddLCBbMzcuNzcyOTg3LCAtMTIyLjQ2MDYxOF0sIFszNy43NzMwMTQsIC0xMjIuNDYwNTExXSwgWzM3Ljc3MzAzNiwgLTEyMi40NjAzOTZdLCBbMzcuNzczMTE3LCAtMTIyLjQ1OTgyNF0sIFszNy43NzMxNDcsIC0xMjIuNDU5NjFdLCBbMzcuNzczMTkzLCAtMTIyLjQ1OTI2N10sIFszNy43NzMyMDgsIC0xMjIuNDU5MTQ1XSwgWzM3Ljc3MzI3MywgLTEyMi40NTkxNTNdLCBbMzcuNzczNTcxLCAtMTIyLjQ1ODg5M10sIFszNy43NzM4NDUsIC0xMjIuNDU4NjI2XSwgWzM3Ljc3NDAwMiwgLTEyMi40NTg1MjddLCBbMzcuNzc0MTM5LCAtMTIyLjQ1ODQ5N10sIFszNy43NzQyOTksIC0xMjIuNDU4NTEyXSwgWzM3Ljc3NDI5OSwgLTEyMi40NTg0NThdLCBbMzcuNzc0Mjk5LCAtMTIyLjQ1ODM5XSwgWzM3Ljc3NDQxLCAtMTIyLjQ1ODQwNV0sIFszNy43NzQ3MDMsIC0xMjIuNDU4NDJdLCBbMzcuNzc0OTgyLCAtMTIyLjQ1ODQ0M10sIFszNy43NzUyNDUsIC0xMjIuNDU4NDU4XSwgWzM3Ljc3NTU2OSwgLTEyMi40NTg1MDRdLCBbMzcuNzc1NTY5LCAtMTIyLjQ1ODUwNF0sIFszNy43NzU2MTUsIC0xMjIuNDU4NDg5XSwgWzM3Ljc3NjExOSwgLTEyMi40NTg1MjddLCBbMzcuNzc2MTg3LCAtMTIyLjQ1ODUyN10sIFszNy43NzY4NDQsIC0xMjIuNDU4NTczXSwgWzM3Ljc3NzEyNiwgLTEyMi40NTg1OTZdLCBbMzcuNzc3Mjg2LCAtMTIyLjQ1ODYxMV0sIFszNy43NzczMzYsIC0xMjIuNDU4NzQxXSwgWzM3Ljc3NzQwOCwgLTEyMi40NTg5NDddLCBbMzcuNzc3NDMxLCAtMTIyLjQ1OTAxNV0sIFszNy43Nzc0NDYsIC0xMjIuNDU5MDc2XSwgWzM3Ljc3NzQ1NCwgLTEyMi40NTkxM10sIFszNy43Nzc0NTgsIC0xMjIuNDU5MTgzXSwgWzM3Ljc3NzQzNSwgLTEyMi40NTk2NDldLCBbMzcuNzc3NDI3LCAtMTIyLjQ1OTc0XSwgWzM3Ljc3NzQyMywgLTEyMi40NTk4MzldLCBbMzcuNzc3Mzc4LCAtMTIyLjQ2MDgwOF0sIFszNy43NzczMzIsIC0xMjIuNDYxODg0XSwgWzM3Ljc3NzI4MiwgLTEyMi40NjI5Nl0sIFszNy43NzcyMzMsIC0xMjIuNDY0MDI4XSwgWzM3Ljc3OTEwNiwgLTEyMi40NjQxNThdXSwKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiAnZ3JlZW4nLAogICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgbWFwX2Y4ZjBmNjllODcxMzQ3Njc5NjY5ZDU4NGEzMzBjYzhjLmFkZExheWVyKHBvbHlfbGluZV9kZGU4MGI3NmE1MDU0ZWFkYWEyNDRlMDBlN2ZjNTYyYik7CiAgICAgICAgICAgIAogICAgICAgIAogICAgICAgIAogICAgICAgIDwvc2NyaXB0PgogICAgICAgIA==" style="position:absolute;width:100%;height:100%;left:0;top:0;"></iframe></div></div>




```python
sf_landmarks.save('sutro_transamerica.html')
sf_rand_points.save('sf_random_points.html')
m1.save('optimize_stops_2_people_walk.html')
m2.save('optimize_stops_2_people_bike.html')
m3.save('optimize_stops_3_people_walk.html')

```
